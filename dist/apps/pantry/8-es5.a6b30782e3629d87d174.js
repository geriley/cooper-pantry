function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,s=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw i}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,s=u}finally{try{r||null==o.return||o.return()}finally{if(i)throw s}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _get3(e,t,n){return(_get3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,e)})(e)}function _construct(e,t,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(i,n.prototype),i}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function asyncGeneratorStep(e,t,n,r,i,s,a){try{var o=e[s](a),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function a(e){asyncGeneratorStep(s,r,i,a,o,"next",e)}function o(e){asyncGeneratorStep(s,r,i,a,o,"throw",e)}a(void 0)}))}}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){return function(){var t,n=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"+fds":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(t){_classCallCheck(this,e),this.data=t}return _createClass(e,[{key:"update",value:function(e,t,n,r){return this.data.lastEventId=e,this.data.revision=t,this.data.value=n,this.data.dateUpdated=r,this}},{key:"updateDateExpires",value:function(e){this.data.dateExpires=e}},{key:"uri",get:function(){return this.data.uri}},{key:"revision",get:function(){return this.data.revision}},{key:"lastEventId",get:function(){return this.data.lastEventId}},{key:"dateUpdated",get:function(){return this.data.dateUpdated}},{key:"dateExpires",get:function(){return this.data.dateExpires}},{key:"index",get:function(){return this.data.index}},{key:"value",get:function(){return this.data.value}}]),e}();t.ListItem=r,t.default=r},"+ozH":function(e,t,n){e.exports={default:n("6XsV"),__esModule:!0}},"+t7B":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("r2q8"),i=n("F8DB"),s=n("v9mA"),a=n("qlDM"),o=n("sc67"),u=n("lKIr"),c=n("LYxL"),l=n("lgJq"),d=n("sRV3"),f=n("2E5e"),h=n("LBb3"),p=n("tcGR"),v=n("W27V"),y=n("B3fw"),m=n("1eRg"),g=n("wlIO"),b=n("BxSP"),k=n("upa/"),_=n("4RHC"),w=n("4RHC"),x=n("1rCL").version;function C(e){if(e){if("string"==typeof e)return{id:e,mode:"open_or_create"};u.validateOptionalTtl(e.ttl);var t=e.mode||(e.id?"open_or_create":"create_new");return Object.assign(Object.assign({},e),{mode:t})}return{mode:"create_new"}}var S=function(e){_inherits(D,e);var t,n,r,S,T,R,M,E,I,P,O,N,j,L,U=_createSuper(D);function D(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(_classCallCheck(this,D),t=U.call(this),!e)throw new Error("Sync library needs a valid Twilio token to be passed");n.hasOwnProperty("logLevel")?c.default.setLevel(n.logLevel):c.default.setLevel("silent");var r=n.productId=n.productId||"data_sync",a=n.twilsockClient=n.twilsockClient||new i.Twilsock(e,r,n);a.on("tokenAboutToExpire",(function(e){return t.emit("tokenAboutToExpire",e)})),a.on("tokenExpired",(function(){return t.emit("tokenExpired")})),a.on("connectionError",(function(e){return t.emit("connectionError",e)}));var o=n.notificationsClient=n.notificationsClient||new s.Notifications(e,n),u=new l.Configuration(n),p=new h.NetworkService(new m.ClientInfo(x),u,a),v=new b.SessionStorage(u);t.localStorageId=null,a.connect(),t.services={config:u,twilsock:a,notifications:o,network:p,storage:v,router:null,subscriptions:null};var y=new d.Subscriptions(t.services),k=new f.Router({config:u,subscriptions:y,notifications:o});return t.services.router=k,t.services.subscriptions=y,t.entities=new g.EntitiesCache,o.on("connectionStateChanged",(function(){t.emit("connectionStateChanged",t.services.notifications.connectionState)})),_possibleConstructorReturn(t)}return _createClass(D,[{key:"ensureReady",value:(L=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.services.config.sessionStorageEnabled){e.next=11;break}return e.prev=1,e.next=4,this.services.twilsock.storageId();case 4:t=e.sent,this.services.storage.updateStorageId(t.id),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),c.default.warn("Failed to initialize storage",e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(){return L.apply(this,arguments)})},{key:"storeRootInSessionCache",value:function(e,t,n){if(this.services.config.sessionStorageEnabled&&t){var r=u.deepClone(n);e!==v.SyncList.type&&e!==y.SyncMap.type||(r.last_event_id=null,delete r.items),this.services.storage.store(e,t,r)}}},{key:"readRootFromSessionCache",value:function(e,t){return this.services.config.sessionStorageEnabled&&t?this.services.storage.read(e,t):null}},{key:"_get",value:(j=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>2&&void 0!==s[2]&&s[2],n){e.next=3;break}throw new o.SyncError("Cannot get entity without id",404);case 3:return i=new a.UriBuilder(t).pathSegment(n).queryParam("Include",r?"items":void 0).build(),e.next=6,this.services.network.get(i);case 6:return e.abrupt("return",e.sent.body);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"_createDocument",value:function(e,t,n){var r={unique_name:e,data:t||{}};return"number"==typeof n&&(r.ttl=n),this.services.network.post(this.services.config.documentsUri,r).then((function(e){return e.body.data=r.data,e.body}))}},{key:"_getDocument",value:(N=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(p.SyncDocument.type,t)||this._get(this.services.config.documentsUri,t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"_createList",value:function(e,t,n,r){var i={unique_name:e,purpose:t,context:n};return"number"==typeof r&&(i.ttl=r),this.services.network.post(this.services.config.listsUri,i).then((function(e){return e.body}))}},{key:"_getList",value:(O=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(v.SyncList.type,t)||this._get(this.services.config.listsUri,t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"_createMap",value:function(e,t){var n={unique_name:e};return"number"==typeof t&&(n.ttl=t),this.services.network.post(this.services.config.mapsUri,n).then((function(e){return e.body}))}},{key:"_getMap",value:(P=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]&&r[1],e.abrupt("return",this.readRootFromSessionCache(y.SyncMap.type,t)||this._get(this.services.config.mapsUri,t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return P.apply(this,arguments)})},{key:"_getStream",value:(I=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(k.SyncStream.type,t)||this._get(this.services.config.streamsUri,t,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"_createStream",value:(E=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={unique_name:t},"number"==typeof n&&(r.ttl=n),e.next=4,this.services.network.post(this.services.config.streamsUri,r);case 4:return e.abrupt("return",e.sent.body);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return E.apply(this,arguments)})},{key:"_getLiveQuery",value:function(e){return this.readRootFromSessionCache(_.LiveQuery.type,e)}},{key:"getCached",value:function(e,t){return e&&this.entities.get(e,t)||null}},{key:"removeFromCacheAndSession",value:function(e,t,n){this.entities.remove(t),this.services.config.sessionStorageEnabled&&this.services.storage.remove(e,t,n)}},{key:"document",value:(M=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,s,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(r=C(t)).mode){e.next=9;break}return e.next=6,this._createDocument(r.id,r.value,r.ttl);case 6:n=e.sent,e.next=33;break;case 9:if(!(i=this.getCached(r.id,p.SyncDocument.type))){e.next=12;break}return e.abrupt("return",new p.SyncDocument(i));case 12:return e.prev=12,e.next=15,this._getDocument(r.id);case 15:n=e.sent,e.next=33;break;case 18:if(e.prev=18,e.t0=e.catch(12),404===e.t0.status&&"open_existing"!==r.mode){e.next=22;break}throw e.t0;case 22:return e.prev=22,e.next=25,this._createDocument(r.id,r.value,r.ttl);case 25:n=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t1=e.catch(22),409!==e.t1.status){e.next=32;break}return e.abrupt("return",this.document(t));case 32:throw e.t1;case 33:return this.storeRootInSessionCache(p.SyncDocument.type,r.id,n),s=new p.SyncDocumentImpl(this.services,n,(function(e,t,n){return a.removeFromCacheAndSession(e,t,n)})),e.abrupt("return",(s=this.entities.store(s),new p.SyncDocument(s)));case 36:case"end":return e.stop()}}),e,this,[[12,18],[22,28]])}))),function(e){return M.apply(this,arguments)})},{key:"map",value:(R=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,s,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(r=C(t)).mode){e.next=9;break}return e.next=6,this._createMap(r.id,r.ttl);case 6:n=e.sent,e.next=33;break;case 9:if(!(i=this.getCached(r.id,y.SyncMap.type))){e.next=12;break}return e.abrupt("return",new y.SyncMap(i));case 12:return e.prev=12,e.next=15,this._getMap(r.id,r.includeItems);case 15:n=e.sent,e.next=33;break;case 18:if(e.prev=18,e.t0=e.catch(12),404===e.t0.status&&"open_existing"!==r.mode){e.next=22;break}throw e.t0;case 22:return e.prev=22,e.next=25,this._createMap(r.id,r.ttl);case 25:n=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t1=e.catch(22),409!==e.t1.status){e.next=32;break}return e.abrupt("return",this.map(t));case 32:throw e.t1;case 33:return this.storeRootInSessionCache(y.SyncMap.type,r.id,n),s=new y.SyncMapImpl(this.services,n,(function(e,t,n){return a.removeFromCacheAndSession(e,t,n)})),e.abrupt("return",(s=this.entities.store(s),new y.SyncMap(s)));case 36:case"end":return e.stop()}}),e,this,[[12,18],[22,28]])}))),function(e){return R.apply(this,arguments)})},{key:"list",value:(T=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,s,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(r=C(t)).mode){e.next=9;break}return e.next=6,this._createList(r.id,r.purpose,r.context,r.ttl);case 6:n=e.sent,e.next=33;break;case 9:if(!(i=this.getCached(r.id,v.SyncList.type))){e.next=12;break}return e.abrupt("return",new v.SyncList(i));case 12:return e.prev=12,e.next=15,this._getList(r.id);case 15:n=e.sent,e.next=33;break;case 18:if(e.prev=18,e.t0=e.catch(12),404===e.t0.status&&"open_existing"!==r.mode){e.next=22;break}throw e.t0;case 22:return e.prev=22,e.next=25,this._createList(r.id,r.purpose,r.context,r.ttl);case 25:n=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t1=e.catch(22),409!==e.t1.status){e.next=32;break}return e.abrupt("return",this.list(t));case 32:throw e.t1;case 33:return this.storeRootInSessionCache(v.SyncList.type,r.id,n),s=new v.SyncListImpl(this.services,n,(function(e,t,n){return a.removeFromCacheAndSession(e,t,n)})),e.abrupt("return",(s=this.entities.store(s),new v.SyncList(s)));case 36:case"end":return e.stop()}}),e,this,[[12,18],[22,28]])}))),function(e){return T.apply(this,arguments)})},{key:"stream",value:(S=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,s,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(r=C(t)).mode){e.next=9;break}return e.next=6,this._createStream(r.id,r.ttl);case 6:n=e.sent,e.next=33;break;case 9:if(!(i=this.getCached(r.id,k.SyncStream.type))){e.next=12;break}return e.abrupt("return",new k.SyncStream(i));case 12:return e.prev=12,e.next=15,this._getStream(r.id);case 15:n=e.sent,e.next=33;break;case 18:if(e.prev=18,e.t0=e.catch(12),404===e.t0.status&&"open_existing"!==r.mode){e.next=22;break}throw e.t0;case 22:return e.prev=22,e.next=25,this._createStream(r.id,r.ttl);case 25:n=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t1=e.catch(22),409!==e.t1.status){e.next=32;break}return e.abrupt("return",this.stream(t));case 32:throw e.t1;case 33:return this.storeRootInSessionCache(k.SyncStream.type,r.id,n),s=new k.SyncStreamImpl(this.services,n,(function(e,t,n){return a.removeFromCacheAndSession(e,t,n)})),e.abrupt("return",(s=this.entities.store(s),new k.SyncStream(s)));case 36:case"end":return e.stop()}}),e,this,[[12,18],[22,28]])}))),function(e){return S.apply(this,arguments)})},{key:"shutdown",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.subscriptions.shutdown();case 2:return e.next=4,this.services.twilsock.disconnect();case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"updateToken",value:function(e){return e?this.services.twilsock.updateToken(e):Promise.reject(new Error("A valid Twilio token should be provided"))}},{key:"liveQuery",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if(t&&"string"==typeof t){e.next=4;break}throw new Error("Index name must contain a non-empty string value");case 4:return r=new a.UriBuilder(this.services.config.insightsUri).pathSegment(t).pathSegment("Items").build(),e.next=7,w.queryItems({network:this.services.network,uri:r,queryString:n});case 7:return i=e.sent,(s=this.getCached(i.query_id,_.LiveQuery.type))||((o=this._getLiveQuery(i.query_id))||(o={indexName:t,queryExpression:n,sid:i.query_id,queryUri:r}),s=new _.LiveQueryImpl(o,this.services,(function(e,t,n){return u.removeFromCacheAndSession(e,t,n)}),i.items)),e.abrupt("return",(this.storeRootInSessionCache(_.LiveQuery.type,i.query_id,s.liveQueryDescriptor),s=this.entities.store(s),new _.LiveQuery(s)));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"instantQuery",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:return e.abrupt("return",new _.InstantQuery({indexName:t,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:function(e,t){return n.liveQuery(e,t)}}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"connectionState",get:function(){return this.services.notifications.connectionState}}],[{key:"version",get:function(){return x}}]),D}(r.EventEmitter);t.Client=S,t.SyncClient=S,t.default=S},"/hF+":function(e,t,n){"use strict";var r=f(n("tgXR")),i=f(n("CafK")),s=f(n("IhEH")),a=f(n("XUND")),o=f(n("Rhu4")),u=f(n("4Mt5")),c=f(n("7xyS")),l=f(n("k2Qk")),d=f(n("aq5/"));function f(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var h=n("r2q8"),p=n("CPx3"),v=n("FSt9"),y=n("0tlO");t.User=y.User;var m=n("Isrn"),g=n("ZvXT"),b=n("yDbV"),k=n("MAsh"),_=n("F8DB"),w=n("v9mA"),x=n("p87M"),C=n("vOBy"),S=n("l9m5"),T=n("MuMv"),R=n("LVtF"),M=n("ToDU"),E=n("dSFd"),I=n("UuY1"),P=n("vZMe");t.PushNotification=P.PushNotification;var O=n("RtQP"),N=p.Logger.scope("Client"),j=n("G1hA").version,L="A valid Twilio token should be provided",U=function e(){(0,d.default)(this,e)},D=function(e){function t(e,n){(0,d.default)(this,t);var r=(0,c.default)(this,(t.__proto__||(0,o.default)(t)).call(this));r.connectionState="connecting",r.sessionPromise=null,r.channelsPromise=null,r.version=j,r.parsePushNotification=t.parsePushNotification,r.options=n||{},r.options.disableDeepClone||(r.options=O.deepClone(r.options)),r.options.logLevel=r.options.logLevel||"silent",N.setLevel(r.options.logLevel);var i=r.options.productId="ip_messaging";if(r.options.Sync=r.options.Sync||{},void 0===r.options.Sync.enableSessionStorage&&(r.options.Sync.enableSessionStorage=!0),r.options.region&&(r.options.Sync.region=r.options.region),!e)throw new Error(L);return r.services=new U,r.config=new v.Configuration(r.options),r.options.twilsockClient=r.options.twilsockClient||new _.Twilsock(e,i,r.options),r.options.transport=r.options.transport||r.options.twilsockClient,r.options.notificationsClient=r.options.notificationsClient||new w.Notifications(e,r.options),r.options.syncClient=r.options.syncClient||new x.SyncClient(e,r.options),r.services.syncClient=r.options.syncClient,r.services.transport=r.options.transport,r.services.twilsockClient=r.options.twilsockClient,r.services.notificationClient=r.options.notificationsClient,r.services.session=new S.Session(r.services,r.config),r.sessionPromise=r.services.session.initialize(),r.services.network=new g.Network(r.config,r.services),r.services.users=new R.Users({session:r.services.session,network:r.services.network,syncClient:r.services.syncClient}),r.services.users.on("userSubscribed",r.emit.bind(r,"userSubscribed")),r.services.users.on("userUpdated",(function(e){return r.emit("userUpdated",e)})),r.services.users.on("userUnsubscribed",r.emit.bind(r,"userUnsubscribed")),r.services.twilsockClient.on("tokenAboutToExpire",(function(e){return r.emit("tokenAboutToExpire",e)})),r.services.twilsockClient.on("tokenExpired",(function(){return r.emit("tokenExpired")})),r.services.twilsockClient.on("connectionError",(function(e){return r.emit("connectionError",e)})),r.services.consumptionHorizon=new E.ConsumptionHorizon(r.services),r.services.typingIndicator=new M.TypingIndicator(r.config,{transport:r.services.twilsockClient,notificationClient:r.services.notificationClient},r.getChannelBySid.bind(r)),r.services.syncList=new k.SyncList(r.services),r.channels=new T.Channels(r.services),r.channelsPromise=r.sessionPromise.then((function(){return r.channels.on("channelAdded",r.emit.bind(r,"channelAdded")),r.channels.on("channelRemoved",r.emit.bind(r,"channelRemoved")),r.channels.on("channelInvited",r.emit.bind(r,"channelInvited")),r.channels.on("channelJoined",r.emit.bind(r,"channelJoined")),r.channels.on("channelLeft",r.emit.bind(r,"channelLeft")),r.channels.on("channelUpdated",(function(e){return r.emit("channelUpdated",e)})),r.channels.on("memberJoined",r.emit.bind(r,"memberJoined")),r.channels.on("memberLeft",r.emit.bind(r,"memberLeft")),r.channels.on("memberUpdated",(function(e){return r.emit("memberUpdated",e)})),r.channels.on("messageAdded",r.emit.bind(r,"messageAdded")),r.channels.on("messageUpdated",(function(e){return r.emit("messageUpdated",e)})),r.channels.on("messageRemoved",r.emit.bind(r,"messageRemoved")),r.channels.on("typingStarted",r.emit.bind(r,"typingStarted")),r.channels.on("typingEnded",r.emit.bind(r,"typingEnded")),r.channels.fetchChannels()})).then((function(){return r.channels})),r.services.notificationClient.on("connectionStateChanged",(function(e){var t=null;switch(e){case"connected":t="connected";break;case"denied":t="denied";break;case"disconnecting":t="disconnecting";break;case"disconnected":t="disconnected";break;default:t="connecting"}t!==r.connectionState&&(r.connectionState=t,r.emit("connectionStateChanged",r.connectionState))})),r.fpaToken=e,r}var n,f,h,p,y,D,A,q,F,B,G;return(0,l.default)(t,e),(0,u.default)(t,[{key:"subscribeToPushNotifications",value:function(e){var t=this,n=[];return[b.NotificationTypes.NEW_MESSAGE,b.NotificationTypes.ADDED_TO_CHANNEL,b.NotificationTypes.INVITED_TO_CHANNEL,b.NotificationTypes.REMOVED_FROM_CHANNEL,b.NotificationTypes.TYPING_INDICATOR,b.NotificationTypes.CONSUMPTION_UPDATE].forEach((function(r){n.push(t.services.notificationClient.subscribe(r,e))})),a.default.all(n)}},{key:"unsubscribeFromPushNotifications",value:function(e){var t=this,n=[];return[b.NotificationTypes.NEW_MESSAGE,b.NotificationTypes.ADDED_TO_CHANNEL,b.NotificationTypes.INVITED_TO_CHANNEL,b.NotificationTypes.REMOVED_FROM_CHANNEL,b.NotificationTypes.TYPING_INDICATOR,b.NotificationTypes.CONSUMPTION_UPDATE].forEach((function(r){n.push(t.services.notificationClient.unsubscribe(r,e))})),a.default.all(n)}},{key:"initialize",value:(G=(0,s.default)(r.default.mark((function e(){var n,s,a=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionPromise;case 2:return t.supportedPushChannels.forEach((function(e){return a.subscribeToPushNotifications(e)})),e.next=5,this.services.session.getSessionLinks();case 5:return this.services.publicChannels=new m.PublicChannels(this,this.services,(n=e.sent).publicChannelsUrl),this.services.userChannels=new I.UserChannels(this,this.services,n.myChannelsUrl),(s=(0,i.default)(this.options)).transport=null,this.services.mcsClient=new C.McsClient(this.fpaToken,n.mediaServiceUrl,s),e.next=13,this.services.typingIndicator.initialize();case 13:case"end":return e.stop()}}),e,this)}))),function(){return G.apply(this,arguments)})},{key:"shutdown",value:(B=(0,s.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.twilsockClient.disconnect();case 2:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"updateToken",value:(F=(0,s.default)(r.default.mark((function e(t){var n=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N.info("updateToken"),t){e.next=3;break}throw new Error(L);case 3:if(this.fpaToken!==t){e.next=5;break}return e.abrupt("return",this);case 5:return e.next=7,this.services.twilsockClient.updateToken(t).then((function(){return n.fpaToken=t})).then((function(){return n.services.mcsClient.updateToken(t)})).then((function(){return n.sessionPromise}));case 7:return e.abrupt("return",this);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"getChannelBySid",value:(q=(0,s.default)(r.default.mark((function e(t){var n=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"string"==typeof t){e.next=2;break}throw new Error("Client.getChannelBySid requires a <String>channelSid parameter");case 2:return e.abrupt("return",this.channels.syncListRead.promise.then((function(){return n.channels.getChannel(t).then((function(e){return e||n.services.publicChannels.getChannelBySid(t).then((function(e){return n.channels.pushChannel(e)}))}))})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return q.apply(this,arguments)})},{key:"getChannelByUniqueName",value:(A=(0,s.default)(r.default.mark((function e(t){var n=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"string"==typeof t){e.next=2;break}throw new Error("Client.getChannelByUniqueName requires a <String>uniqueName parameter");case 2:return e.abrupt("return",this.channels.syncListRead.promise.then((function(){return n.services.publicChannels.getChannelByUniqueName(t).then((function(e){return n.channels.pushChannel(e)}))})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"getSubscribedChannels",value:function(e){return this.channelsPromise.then((function(t){return t.getChannels(e)}))}},{key:"getLocalChannels",value:function(e){return this.channelsPromise.then((function(n){var r=[];n.channels.forEach((function(e){r.push(e)}));var i="ascending";if(e&&e.order)if("descending"===e.order)i="descending";else if("ascending"!==e.order)throw new Error("Sorting order should be `ascending` or `descending`");if(e&&e.criteria)if("lastMessage"===e.criteria)r.sort((function(e,n){return t.compareChannelsByLastMessage(e,n,i)}));else if("uniqueName"===e.criteria)r.sort((function(e,n){return t.compareChannelsByStringProperty(e.uniqueName,n.uniqueName,i)}));else{if("friendlyName"!==e.criteria)throw new Error("Sorting criteria should be one of `lastMessage`, `uniqueName` or `friendlyName`");r.sort((function(e,n){return t.compareChannelsByStringProperty(e.friendlyName,n.friendlyName,i)}))}return r}))}},{key:"getPublicChannelDescriptors",value:function(){return this.services.publicChannels.getChannels()}},{key:"getUserChannelDescriptors",value:function(){return this.services.userChannels.getChannels()}},{key:"createChannel",value:function(e){return e=e||{},this.channelsPromise.then((function(t){return t.addChannel(e)}))}},{key:"setPushRegistrationId",value:(D=(0,s.default)(r.default.mark((function e(n,i){var s=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==t.supportedPushChannels.indexOf(n)){e.next=2;break}throw new Error("Invalid or unsupported channelType: "+n);case 2:return e.next=4,this.subscribeToPushNotifications(n).then((function(){return s.services.notificationClient.setPushRegistrationId(i,n)}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return D.apply(this,arguments)})},{key:"unsetPushRegistrationId",value:(y=(0,s.default)(r.default.mark((function e(n){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==t.supportedPushChannels.indexOf(n)){e.next=2;break}throw new Error("Invalid or unsupported channelType: "+n);case 2:return e.next=4,this.unsubscribeFromPushNotifications(n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"handlePushNotification",value:(p=(0,s.default)(r.default.mark((function e(n){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.debug("handlePushNotification, notificationPayload=",n),this.emit("pushNotification",t.parsePushNotification(n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getUser",value:function(e){return this.services.users.getUser(e)}},{key:"getUserDescriptor",value:(h=(0,s.default)(r.default.mark((function e(t){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.users.getUserDescriptor(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"getSubscribedUsers",value:(f=(0,s.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.users.getSubscribedUsers());case 1:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"user",get:function(){return this.services.users.myself}},{key:"reachabilityEnabled",get:function(){return this.services.session.reachabilityEnabled}},{key:"token",get:function(){return this.fpaToken}}],[{key:"create",value:(n=(0,s.default)(r.default.mark((function e(n,i){var s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new t(n,i),e.next=3,s.initialize();case 3:return e.abrupt("return",s);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"compareChannelsByLastMessage",value:function(e,t,n){if(e.lastMessage&&t.lastMessage){if(e.lastMessage.timestamp&&t.lastMessage.timestamp)return e.lastMessage.timestamp.getTime()<t.lastMessage.timestamp.getTime()?"ascending"===n?-1:1:"ascending"===n?1:-1;if(e.lastMessage.timestamp)return-1;if(t.lastMessage.timestamp)return 1}return e.lastMessage?-1:t.lastMessage?1:0}},{key:"compareChannelsByStringProperty",value:function(e,t,n){return e&&t?"ascending"===n?e.localeCompare(t):-1*e.localeCompare(t):e?-1:t?1:0}},{key:"parsePushNotificationChatData",value:function(e){var n={};for(var r in t.supportedPushDataFields)null!=e[r]&&("message_index"===r?null!==O.parseToNumber(e[r])&&(n[t.supportedPushDataFields[r]]=Number(e[r])):n[t.supportedPushDataFields[r]]=e[r]);return n}},{key:"parsePushNotification",value:function(e){if(N.debug("parsePushNotification, notificationPayload=",e),null==e)throw new Error("Push notification payload should be provided");if(void 0!==e.aps){if(!e.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var n=t.parsePushNotificationChatData(e),r=e.aps,i=null,s=null;return"string"==typeof r.alert?i=r.alert||null:(i=r.alert.body||null,s=r.alert.title||null),new P.PushNotification({title:s,body:i,sound:r.sound||null,badge:r.badge||null,action:r.category||null,type:e.twi_message_type,data:n})}if(void 0!==e.data){var a=e.data;if(!a.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var o=t.parsePushNotificationChatData(e.data);return new P.PushNotification({title:a.twi_title||null,body:a.twi_body||null,sound:a.twi_sound||null,badge:null,action:a.twi_action||null,type:a.twi_message_type,data:o})}throw new Error("Provided push notification payload is not Programmable Chat notification")}}]),t}(h.EventEmitter);t.Client=D,D.version=j,D.supportedPushChannels=["fcm","apn","gcm"],D.supportedPushDataFields={channel_sid:"channelSid",message_sid:"messageSid",message_index:"messageIndex"},t.default=D},"/r3m":function(e,t,n){"use strict";var r=n("S7IX")(!0);n("S49y")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},"/zo1":function(e,t,n){var r=n("IFjL");r(r.S,"Object",{setPrototypeOf:n("Eqmn").set})},"0tlO":function(e,t,n){"use strict";var r=f(n("qCKU")),i=f(n("tgXR")),s=f(n("IhEH")),a=f(n("XUND")),o=f(n("Rhu4")),u=f(n("aq5/")),c=f(n("4Mt5")),l=f(n("7xyS")),d=f(n("k2Qk"));function f(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var h=n("r2q8"),p=n("CPx3"),v=n("RtQP"),y=p.Logger.scope("User"),m=function(e){function t(e,n,r){(0,u.default)(this,t);var i=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this));return i.subscribed="initializing",i.setMaxListeners(0),i.services=r,i.state={identity:e,entityName:n,friendlyName:null,attributes:{},online:null,notifiable:null},i}var n,f,h,p;return(0,d.default)(t,e),(0,c.default)(t,[{key:"_update",value:function(e,t){var n=[];switch(y.debug("User for",this.state.identity,"updated:",e,t),e){case"friendlyName":this.state.friendlyName!==t.value&&(n.push("friendlyName"),this.state.friendlyName=t.value);break;case"attributes":var r={};try{r=JSON.parse(t.value)}catch(i){y.warn("Retrieved malformed attributes from the server for user: "+this.state.identity)}v.isDeepEqual(this.state.attributes,r)||(this.state.attributes=r,n.push("attributes"));break;case"reachability":this.state.online!==t.online&&(this.state.online=t.online,n.push("online")),this.state.notifiable!==t.notifiable&&(this.state.notifiable=t.notifiable,n.push("notifiable"));break;default:return}n.length>0&&this.emit("updated",{user:this,updateReasons:n})}},{key:"_updateReachabilityInfo",value:function(e,t){var n=this;return this.services.session.reachabilityEnabled?e.get("reachability").then(t).catch((function(e){y.warn("Failed to get reachability info for ",n.state.identity,e)})):a.default.resolve()}},{key:"_fetch",value:(p=(0,s.default)(i.default.mark((function e(){var t=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.entityName){e.next=2;break}return e.abrupt("return",this);case 2:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then((function(e){return t.entity=e,e.on("itemUpdated",(function(e){return y.debug(t.state.entityName+" ("+t.state.identity+") itemUpdated: "+e.item.key),t._update(e.item.key,e.item.value)})),a.default.all([e.get("friendlyName").then((function(e){return t._update(e.key,e.value)})),e.get("attributes").then((function(e){return t._update(e.key,e.value)})),t._updateReachabilityInfo(e,(function(e){return t._update(e.key,e.value)}))])})).then((function(){return y.debug("Fetched for",t.identity),t.subscribed="subscribed",t.emit("userSubscribed",t),t})).catch((function(e){throw t.promiseToFetch=null,e})),e.abrupt("return",this.promiseToFetch);case 4:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"_ensureFetched",value:function(){return this.promiseToFetch||this._fetch()}},{key:"updateAttributes",value:(h=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=4;break}throw new Error("Attributes is required parameter");case 4:if(null!==t){e.next=8;break}throw new Error("Attributes can't be null");case 8:if(t.constructor===Object){e.next=10;break}throw new Error("Attributes must be a valid JSON object");case 10:if("unsubscribed"!=this.subscribed){e.next=12;break}throw new Error("Can't modify unsubscribed object");case 12:return e.next=14,this.services.session.addCommand("editUserAttributes",{username:this.state.identity,attributes:(0,r.default)(t)});case 14:return e.abrupt("return",this);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"updateFriendlyName",value:(f=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||"string"==typeof t){e.next=2;break}throw new Error("friendlyName must be string or empty");case 2:if("unsubscribed"!=this.subscribed){e.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return e.next=6,this.services.session.addCommand("editUserFriendlyName",{username:this.state.identity,friendlyName:t});case 6:return e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"unsubscribe",value:(n=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.promiseToFetch){e.next=7;break}return e.next=3,this.promiseToFetch;case 3:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"identity",get:function(){return this.state.identity},set:function(e){this.state.identity=e}},{key:"entityName",set:function(e){this.state.entityName=e}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"online",get:function(){return this.state.online}},{key:"notifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return"subscribed"==this.subscribed}}]),t}(h.EventEmitter);t.User=m},"1bLK":function(e,t,n){var r=n("vbc5"),i=n("hR4s").document,s=r(i)&&r(i.createElement);e.exports=function(e){return s?i.createElement(e):{}}},"1eRg":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("CmQt"),i=function e(t){_classCallCheck(this,e),this.sdk="js",this.sdkVer=t,this.os=r.os.family,this.osVer=r.os.version,this.pl=r.name,this.plVer=r.version};t.ClientInfo=i,t.default=i},"1ppQ":function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}},"1rCL":function(e){e.exports=JSON.parse('{"_from":"twilio-sync@^0.11.5","_id":"twilio-sync@0.11.5","_inBundle":false,"_integrity":"sha512-Gsr2Xms4HdnTzOnqayalMiIRD7A8iWUAk2UG83l0KFttH0sEXkU79QClm7j2qla1MD6s4niqrRAekVMYqeo/7Q==","_location":"/twilio-sync","_phantomChildren":{},"_requested":{"type":"range","registry":true,"raw":"twilio-sync@^0.11.5","name":"twilio-sync","escapedName":"twilio-sync","rawSpec":"^0.11.5","saveSpec":null,"fetchSpec":"^0.11.5"},"_requiredBy":["/twilio-chat"],"_resolved":"https://registry.npmjs.org/twilio-sync/-/twilio-sync-0.11.5.tgz","_shasum":"945e06117204fd23eab9022b27aa3d5c6b645ed9","_spec":"twilio-sync@^0.11.5","_where":"D:\\\\Gabrielle2\\\\Development\\\\Web\\\\cooper-pantry\\\\cooper\\\\node_modules\\\\twilio-chat","author":{"name":"Twilio"},"browserify":{"transform":["babelify"]},"bundleDependencies":false,"dependencies":{"loglevel":"^1.6.3","operation-retrier":"^3.0.0","platform":"^1.3.5","twilio-notifications":"^0.5.8","twilsock":"^0.5.11","uuid":"^3.3.2"},"deprecated":false,"description":"Twilio Sync client library","devDependencies":{"@types/chai":"^4.1.7","@types/chai-as-promised":"7.1.0","@types/chai-string":"^1.4.1","@types/mocha":"^5.2.7","@types/node":"^12.0.4","@types/sinon":"^7.0.12","@types/sinon-chai":"^3.2.2","async-test-tools":"^1.0.7","babel-core":"^6.26.0","babel-plugin-transform-builtin-extend":"^1.1.2","babel-plugin-transform-runtime":"^6.23.0","babel-preset-env":"^1.6.1","babel-runtime":"^6.26.0","babelify":"^8.0.0","browserify":"^16.2.3","chai":"^4.2.0","chai-as-promised":"^7.1.1","chai-string":"^1.5.0","cheerio":"^1.0.0-rc.2","cross-env":"^5.2.0","del":"^4.1.1","fancy-log":"^1.3.3","fs":"0.0.2","gulp":"^4.0.2","gulp-babel":"^7.0.1","gulp-derequire":"^2.1.0","gulp-if":"^2.0.2","gulp-insert":"^0.5.0","gulp-rename":"^1.4.0","gulp-sourcemaps":"^2.6.5","gulp-tap":"^1.0.1","gulp-tslint":"^8.1.4","gulp-typescript":"^5.0.1","gulp-uglify-es":"^1.0.4","ink-docstrap":"^1.3.2","jsdoc":"~3.5.5","jsonwebtoken":"^8.5.1","karma":"^4.1.0","karma-browserify":"^6.0.0","karma-browserstack-launcher":"^1.5.1","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","mocha":"^6.1.4","nyc":"^14.1.1","path":"^0.12.7","sinon":"^7.3.2","sinon-chai":"^3.3.0","source-map-explorer":"^1.8.0","ts-node":"^8.2.0","tslint":"^5.17.0","twilio":"^3.31.1","typescript":"^3.5.1","uglify-es":"^3.3.10","uglify-save-license":"^0.4.1","underscore":"^1.9.1","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0","watchify":"^3.11.1"},"engines":{"node":">=8"},"license":"MIT","main":"lib/index.js","name":"twilio-sync","types":"./lib/index.d.ts","version":"0.11.5"}')},"1sfF":function(e,t,n){var r=n("M25K"),i=n("eD9m")("iterator"),s=n("tReM");e.exports=n("rFq9").getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||s[r(e)]}},"1yva":function(e,t,n){var r=n("dWRk"),i=n("aAA+"),s=n("MrWc"),a=n("MPuG"),o=n("Wnek");e.exports=function(e,t){var n=1==e,u=2==e,c=3==e,l=4==e,d=6==e,f=5==e||d,h=t||o;return function(t,o,p){for(var v,y,m=s(t),g=i(m),b=r(o,p,3),k=a(g.length),_=0,w=n?h(t,k):u?h(t,0):void 0;k>_;_++)if((f||_ in g)&&(y=b(v=g[_],_,m),e))if(n)w[_]=y;else if(y)switch(e){case 3:return!0;case 5:return v;case 6:return _;case 2:w.push(v)}else if(l)return!1;return d?-1:c||l?l:w}}},"2CE9":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e,r,i,s,a){var o;return _classCallCheck(this,n),(o=t.call(this,e)).code=r,o.body=i,o.status=s,o.headers=a,o}return n}();t.TransportError=r},"2E5e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("LYxL"),i=function(){function e(t){var n=this;_classCallCheck(this,e),this.config=t.config,this.subscriptions=t.subscriptions,this.notifications=t.notifications,this.notifications.subscribe("twilio.sync.event"),this.notifications.subscribe("com.twilio.rtd.cds.document"),this.notifications.subscribe("com.twilio.rtd.cds.list"),this.notifications.subscribe("com.twilio.rtd.cds.map"),this.notifications.on("message",(function(e,t){return n.onMessage(e,t)})),this.notifications.on("transportReady",(function(e){return n.onConnectionStateChanged(e)}))}return _createClass(e,[{key:"onMessage",value:function(e,t){switch(r.default.trace("Notification type:",e,"content:",t),e){case"com.twilio.rtd.cds.document":case"com.twilio.rtd.cds.list":case"com.twilio.rtd.cds.map":this.subscriptions.acceptMessage(t,!1);break;case"twilio.sync.event":this.subscriptions.acceptMessage(t,!0)}}},{key:"subscribe",value:function(e,t){this.subscriptions.add(e,t)}},{key:"unsubscribe",value:function(e){this.subscriptions.remove(e)}},{key:"onConnectionStateChanged",value:function(e){this.subscriptions.onConnectionStateChanged(e)}}]),e}();t.Router=i,t.default=i},"2NA7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("F8DB"),i=function(){function e(t){_classCallCheck(this,e),this.id=t}return _createClass(e,null,[{key:"create",value:function(t){if(t instanceof Object&&"storage_id"in t)return new e(t.storage_id);throw new r.TwilsockError('Field "storage_id" is missing')}}]),e}();t.OfflineProductStorage=i},"2YE3":function(e,t,n){var r=n("rFq9"),i=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},"2qJG":function(e,t,n){var r=n("IFjL"),i=n("rFq9"),s=n("7S/a");e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*s((function(){n(1)})),"Object",a)}},"2tcU":function(e,t,n){"use strict";t.__esModule=!0;var r=a(n("+ozH")),i=a(n("TQPF")),s="function"==typeof i.default&&"symbol"==typeof r.default?function(e){return typeof e}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":typeof e};function a(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof i.default&&"symbol"===s(r.default)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":void 0===e?"undefined":s(e)}},3555:function(e,t,n){var r=n("UwCj"),i=n("8fQz"),s=n("ApsS");e.exports=n("ObEa")?Object.defineProperties:function(e,t){i(e);for(var n,a=s(t),o=a.length,u=0;o>u;)r.f(e,n=a[u++],t[n]);return e}},"3UoP":function(e,t,n){var r,i,s=n("hoXw"),a=n("5YqI"),o=0,u=0;e.exports=function(e,t,n){var c=t&&n||0,l=t||[],d=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==f){var h=s();null==d&&(d=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==f&&(f=i=16383&(h[6]<<8|h[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:u+1,y=p-o+(v-u)/1e4;if(y<0&&void 0===e.clockseq&&(f=f+1&16383),(y<0||p>o)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=p,u=v,i=f;var m=(1e4*(268435455&(p+=122192928e5))+v)%4294967296;l[c++]=m>>>24&255,l[c++]=m>>>16&255,l[c++]=m>>>8&255,l[c++]=255&m;var g=p/4294967296*1e4&268435455;l[c++]=g>>>8&255,l[c++]=255&g,l[c++]=g>>>24&15|16,l[c++]=g>>>16&255,l[c++]=f>>>8|128,l[c++]=255&f;for(var b=0;b<6;++b)l[c+b]=d[b];return t||a(l)}},"3eIt":function(e,t,n){"use strict";var r,i=(r=n("aq5/"))&&r.__esModule?r:{default:r};Object.defineProperty(t,"__esModule",{value:!0});var s=function e(){(0,i.default)(this,e)};t.ResponseCodes=s,s.HTTP_200_OK=200,s.HTTP_400_BAD_REQUEST=400,s.HTTP_404_NOT_FOUND=404,s.ACCESS_FORBIDDEN_FOR_IDENTITY=54007,s.LIST_NOT_FOUND=54150},4:function(e,t){},"4Mt5":function(e,t,n){"use strict";t.__esModule=!0;var r,i=(r=n("e5bQ"))&&r.__esModule?r:{default:r};t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},"4RHC":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("qlDM"),i=n("sc67"),s=n("LYxL"),a=n("r2q8"),o=n("yURk"),u=n("e/PS");t.InsightsItem=function(){return function e(){_classCallCheck(this,e)}}();var c=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,s){var a;return _classCallCheck(this,n),(a=t.call(this,r,i)).descriptor=e,a.items=f(s),a}return _createClass(n,[{key:"onRemoved",value:function(){}},{key:"getItems",value:function(){var e=this,t={};return this.items&&Object.keys(this.items).map((function(n,r){t[n]=e.items[n].value})),t}},{key:"_update",value:function(e){var t=e.item_key,n=e.item_revision;switch(e.type){case"live_query_item_updated":var r=this.items[t];if(!r||n>r.revision){var i={key:t,revision:n,value:e.item_data};this.items[t]=i,this.broadcastEventToListeners("itemUpdated",i)}break;case"live_query_item_removed":delete this.items[t],this.broadcastEventToListeners("itemRemoved",{key:t})}}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return null}},{key:"type",get:function(){return n.type}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){return this.descriptor.indexName}},{key:"queryString",get:function(){return this.descriptor.queryExpression}},{key:"queryUri",get:function(){return this.descriptor.queryUri}},{key:"liveQueryDescriptor",get:function(){return this.descriptor}},{key:"network",get:function(){return this.services.network}}],[{key:"type",get:function(){return"live_query"}}]),n}(o.SyncEntity);function l(e){return d.apply(this,arguments)}function d(){return(d=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.network,r=t.queryString,s=t.uri,null!=r){e.next=3;break}throw new i.SyncError("Invalid query",400,54507);case 3:return a={query_string:r},e.next=6,n.post(s,a,void 0,!0);case 6:return e.abrupt("return",e.sent.body);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){if(e)return e.reduce((function(e,t){return e[t.key]={key:t.key,value:t.data,revision:t.revision},e}),{})}t.LiveQueryImpl=c,t.queryItems=l;var h=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).liveQueryImpl=e,r.liveQueryImpl.attach(_assertThisInitialized(r)),r}return _createClass(n,[{key:"close",value:function(){_get3(_getPrototypeOf(n.prototype),"close",this).call(this),this.liveQueryImpl.detach(this.listenerUuid)}},{key:"getItems",value:function(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}},{key:"type",get:function(){return c.type}},{key:"sid",get:function(){return this.liveQueryImpl.sid}}],[{key:"type",get:function(){return c.type}}]),n}(u.default);t.LiveQuery=h;var p=function(e){_inherits(o,e);var t,n,a=_createSuper(o);function o(e){var t;return _classCallCheck(this,o),(t=a.call(this)).queryExpression=null,Object.assign(_assertThisInitialized(t),e),t.updateIndexName(e.indexName),t}return _createClass(o,[{key:"search",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l({network:this.network,uri:this.queryUri,queryString:t}).then((function(e){n.queryExpression=t,n.items=f(e.items),n.emit("searchResult",n.getItems())})).catch((function(e){throw s.default.error("Error '".concat(e.message,"' while executing query '").concat(t,"'")),n.queryExpression=null,n.items=null,e})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"subscribe",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null==this.queryExpression?Promise.reject(new i.SyncError("Invalid query",400,54507)):this.liveQueryCreator(this.indexName,this.queryExpression));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getItems",value:function(){var e=this,t={};return this.items&&Object.keys(this.items).map((function(n,r){t[n]=e.items[n].value})),t}},{key:"updateIndexName",value:function(e){if(!e||"string"!=typeof e)throw new Error("Index name must contain a non-empty string value");this.indexName=e,this.queryUri=this.generateQueryUri(this.indexName)}},{key:"generateQueryUri",value:function(e){return new r.UriBuilder(this.insightsUri).pathSegment(e).pathSegment("Items").build()}},{key:"type",get:function(){return o.type}}],[{key:"type",get:function(){return"instant_query"}}]),o}(a.EventEmitter);t.InstantQuery=p,t.default=h},"4iaB":function(e,t,n){n("nX7j");var r=n("rFq9").Object;e.exports=function(e,t){return r.create(e,t)}},5:function(e,t){},"5JVr":function(e,t,n){e.exports={default:n("MRQX"),__esModule:!0}},"5YqI":function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}},"5ZaL":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XdyU");function i(e,t){return["".concat((new Date).toISOString()," Notifications ").concat(e,":")].concat(Array.from(t))}var s=function(){function e(){_classCallCheck(this,e),this.prefix=""}return _createClass(e,[{key:"setLevel",value:function(e){r.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.debug.apply(null,i("T"+this.prefix,t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.debug.apply(null,i("D"+this.prefix,t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.info.apply(null,i("I"+this.prefix,t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.warn.apply(null,i("W"+this.prefix,t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.error.apply(null,i("E"+this.prefix,t))}}],[{key:"scope",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new e}}]),e}();t.Logger=s;var a=s.scope();t.log=a},"6UZt":function(e,t,n){var r=n("Jo0e"),i=Math.max,s=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):s(e,t)}},"6XaB":function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},"6XsV":function(e,t,n){n("/r3m"),n("Fk9O"),e.exports=n("dWcX").f("iterator")},"6YAS":function(e,t,n){var r=n("hR4s"),i=n("CmYO").set,s=r.MutationObserver||r.WebKitMutationObserver,a=r.process,o=r.Promise,u="process"==n("e7fL")(a);e.exports=function(){var e,t,n,c=function(){var r,i;for(u&&(r=a.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(s){throw e?n():t=void 0,s}}t=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(c)};else if(!s||r.navigator&&r.navigator.standalone)if(o&&o.resolve){var l=o.resolve(void 0);n=function(){l.then(c)}}else n=function(){i.call(r,c)};else{var d=!0,f=document.createTextNode("");new s(c).observe(f,{characterData:!0}),n=function(){f.data=d=!d}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},"70ul":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("BHqR");t.Init=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var s,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return _classCallCheck(this,n),(s=t.call(this)).method="init",s.token=e,s.continuation_token=r,s.metadata=i,s.registrations=a,s.tweaks=o,s.capabilities=["client_update","offline_storage"],s}return n}(r.AbstractMessage)},"7S/a":function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},"7ae9":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["weeks","years","months","days","hours","minutes","seconds"],i=t.pattern=new RegExp("P(?:(\\d+(?:[\\.,]\\d+)?W)|(\\d+(?:[\\.,]\\d+)?Y)?(\\d+(?:[\\.,]\\d+)?M)?(\\d+(?:[\\.,]\\d+)?D)?(?:T(\\d+(?:[\\.,]\\d+)?H)?(\\d+(?:[\\.,]\\d+)?M)?(\\d+(?:[\\.,]\\d+)?S)?)?)"),s=t.parse=function(e){return e.match(i).slice(1).reduce((function(e,t,n){return e[r[n]]=parseFloat(t)||0,e}),{})},a=t.end=function(e,t){var n=t?t.getTime():Date.now(),r=new Date(n);return r.setFullYear(r.getFullYear()+e.years),r.setMonth(r.getMonth()+e.months),r.setDate(r.getDate()+e.days),r.setHours(r.getHours()+e.hours),r.setMinutes(r.getMinutes()+e.minutes),r.setMilliseconds(r.getMilliseconds()+1e3*e.seconds),r.setDate(r.getDate()+7*e.weeks),r},o=t.toSeconds=function(e,t){var n=t?t.getTime():Date.now(),r=new Date(n);return(a(e,r).getTime()-r.getTime())/1e3};t.default={end:a,toSeconds:o,pattern:i,parse:s}},"7xyS":function(e,t,n){"use strict";t.__esModule=!0;var r,i=(r=n("2tcU"))&&r.__esModule?r:{default:r};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,i.default)(t))&&"function"!=typeof t?e:t}},"8HAW":function(e,t,n){e.exports={default:n("VAi2"),__esModule:!0}},"8fQz":function(e,t,n){var r=n("vbc5");e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},"8lcS":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("r2q8"),i=n("F8DB"),s=n("grU3"),a=n("V/GX"),o=n("5ZaL");t.Client=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e){var t,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(_classCallCheck(this,r),t=n.call(this),!e||0===e.length)throw new Error("Token is required for Notifications client");u.logLevel=u.logLevel||"error",o.log.setLevel(u.logLevel);var c=u.productId||"notifications";return u.twilsockClient=u.twilsockClient||new i.TwilsockClient(e,c,u),u.transport=u.transport||u.twilsockClient,t.services={twilsock:u.twilsockClient,transport:u.transport,config:new s.Configuration(null,u)},t.registrar=new a.Registrar(c,t.services.transport,t.services.twilsock,t.services.config),t.reliableTransportState={overall:!1,transport:!1,registration:!1,lastEmitted:null},t._onTransportStateChange(t.services.twilsock.isConnected),t.registrar.on("transportReady",(function(e){t._onRegistrationStateChange(e?"registered":"")})),t.registrar.on("stateChanged",(function(e){t._onRegistrationStateChange(e)})),t.registrar.on("needReliableTransport",t._onNeedReliableTransport.bind(_assertThisInitialized(t))),t.services.twilsock.on("message",(function(e,n){return t._routeMessage(e,n)})),t.services.twilsock.on("connected",(function(e){t._onTransportStateChange(!0),t.registrar.setNotificationId("twilsock",e)})),t.services.twilsock.on("disconnected",(function(){t._onTransportStateChange(!1)})),t.services.config.updateToken(e),t.registrar.updateToken(e),_possibleConstructorReturn(t)}return _createClass(r,[{key:"_routeMessage",value:function(e,t){o.log.trace("Message arrived: ",e,t),this.emit("message",e,t)}},{key:"_onNeedReliableTransport",value:function(e){e?this.services.twilsock.connect():this.services.twilsock.disconnect()}},{key:"_onRegistrationStateChange",value:function(e){this.reliableTransportState.registration="registered"===e,this._updateTransportState()}},{key:"_onTransportStateChange",value:function(e){this.reliableTransportState.transport=e,this._updateTransportState()}},{key:"_updateTransportState",value:function(){var e=this.reliableTransportState.transport&&this.reliableTransportState.registration;this.reliableTransportState.overall!==e&&(this.reliableTransportState.overall=e,o.log.info("Transport ready:",e),this.emit("transportReady",e)),this.reliableTransportState.lastEmitted!==this.connectionState&&(this.reliableTransportState.lastEmitted=this.connectionState,this.emit("connectionStateChanged",this.connectionState))}},{key:"subscribe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"twilsock";return o.log.trace("Add subscriptions for message type: ",e,t),this.registrar.subscribe(e,t)}},{key:"unsubscribe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"twilsock";return o.log.trace("Remove subscriptions for message type: ",e,t),this.registrar.unsubscribe(e,t)}},{key:"handlePushNotification",value:function(e){return{messageType:e.twi_message_type,payload:e.payload}}},{key:"setPushRegistrationId",value:function(e,t){o.log.trace("Set push registration id",e,t),this.registrar.setNotificationId(t,e)}},{key:"updateToken",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.log.info("authTokenUpdated"),e.t0=this.services.config.token!==t,!e.t0){e.next=7;break}return e.next=5,this.services.twilsock.updateToken(t);case 5:this.services.config.updateToken(t),this.registrar.updateToken(t);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"connectionState",get:function(){return"disconnected"===this.services.twilsock.state?"disconnected":"disconnecting"===this.services.twilsock.state?"disconnecting":"connected"===this.services.twilsock.state&&this.reliableTransportState.registration?"connected":"rejected"===this.services.twilsock.state?"denied":"connecting"}}]),r}(r.EventEmitter)},"9F0I":function(e,t,n){"use strict";var r=a(n("XUND")),i=a(n("aq5/")),s=a(n("4Mt5"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){var t=this;(0,i.default)(this,e),this._promise=new r.default((function(e,n){t._resolve=e,t._reject=n}))}return(0,s.default)(e,[{key:"update",value:function(e){this._resolve(e)}},{key:"set",value:function(e){this.current=e,this._resolve(e)}},{key:"fail",value:function(e){this._reject(e)}},{key:"promise",get:function(){return this._promise}}]),e}();t.Deferred=o},"9YHp":function(e,t,n){var r=n("hR4s"),i=n("rFq9"),s=n("UtsQ"),a=n("dWcX"),o=n("UwCj").f;e.exports=function(e){var t=i.Symbol||(i.Symbol=s?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||o(t,e,{value:a.f(e)})}},"9bSt":function(e,t,n){"use strict";var r=n("UwCj"),i=n("jHgz");e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},"9v8s":function(e,t,n){var r=n("dWRk"),i=n("9vFK"),s=n("fawX"),a=n("8fQz"),o=n("MPuG"),u=n("1sfF"),c={},l={};(t=e.exports=function(e,t,n,d,f){var h,p,v,y,m=f?function(){return e}:u(e),g=r(n,d,t?2:1),b=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(s(m)){for(h=o(e.length);h>b;b++)if((y=t?g(a(p=e[b])[0],p[1]):g(e[b]))===c||y===l)return y}else for(v=m.call(e);!(p=v.next()).done;)if((y=i(v,g,p.value,t))===c||y===l)return y}).BREAK=c,t.RETURN=l},"9vFK":function(e,t,n){var r=n("8fQz");e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(a){var s=e.return;throw void 0!==s&&r(s.call(e)),a}}},AKzx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).minDelay=e.min,r.maxDelay=e.max,r.initialDelay=e.initial||0,r.maxAttemptsCount=e.maxAttemptsCount||0,r.maxAttemptsTime=e.maxAttemptsTime||0,r.randomness=e.randomness||0,r.inProgress=!1,r.attemptNum=0,r.prevDelay=0,r.currDelay=0,r}return _createClass(n,[{key:"attempt",value:function(){clearTimeout(this.timeout),this.attemptNum++,this.timeout=null,this.emit("attempt",this)}},{key:"nextDelay",value:function(e){if("number"==typeof e)return this.prevDelay=0,this.currDelay=e,e;if(0==this.attemptNum)return this.initialDelay;if(1==this.attemptNum)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;var t=this.currDelay+this.prevDelay;return this.maxDelay&&t>this.maxDelay&&(this.currDelay=this.maxDelay,t=this.maxDelay),this.currDelay=t,t}},{key:"randomize",value:function(e){var t=e*this.randomness,n=Math.round(Math.random()*t*2-t);return Math.max(0,e+n)}},{key:"scheduleAttempt",value:function(e){var t=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount)return this.cleanup(),this.emit("failed",new Error("Maximum attempt count limit reached")),void this.reject(new Error("Maximum attempt count reached"));var n=this.nextDelay(e);if(n=this.randomize(n),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+n)return this.cleanup(),this.emit("failed",new Error("Maximum attempt time limit reached")),void this.reject(new Error("Maximum attempt time limit reached"));this.timeout=setTimeout((function(){return t.attempt()}),n)}},{key:"cleanup",value:function(){clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}},{key:"start",value:function(){var e=this;if(this.inProgress)throw new Error("Retrier is already in progress");return this.inProgress=!0,new Promise((function(t,n){e.resolve=t,e.reject=n,e.startTimestamp=Date.now(),e.scheduleAttempt(e.initialDelay)}))}},{key:"cancel",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"),this.reject(new Error("Cancelled")))}},{key:"succeeded",value:function(e){this.emit("succeeded",e),this.resolve(e)}},{key:"failed",value:function(e,t){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(t)}},{key:"run",value:function(e){var t=this;return this.on("attempt",(function(){e().then((function(e){return t.succeeded(e)})).catch((function(e){return t.failed(e)}))})),this.start()}}]),n}(n("r2q8").EventEmitter);t.Retrier=r,t.default=r},ApsS:function(e,t,n){var r=n("J0XI"),i=n("guEv");e.exports=Object.keys||function(e){return r(e,i)}},AwPv:function(e,t,n){var r=n("IFjL");r(r.P+r.R,"Map",{toJSON:n("KIy9")("Map")})},B3Ab:function(e,t,n){"use strict";t.__esModule=!0;var r=s(n("8HAW")),i=s(n("QDM+"));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if(Array.isArray(e))return e;if((0,r.default)(Object(e)))return function(e,t){var n=[],r=!0,s=!1,a=void 0;try{for(var o,u=(0,i.default)(e);!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(c){s=!0,a=c}finally{try{!r&&u.return&&u.return()}finally{if(s)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}},B3fw:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("lKIr"),i=n("qlDM"),s=n("sc67"),a=n("LYxL"),o=n("yURk"),u=n("tTO9"),c=n("L760"),l=n("QvZc"),d=n("wiho"),f=n("e/PS"),h=function(e){_inherits(C,e);var t,n,o,f,h,p,v,y,m,g,b,k,_,w,x=_createSuper(C);function C(e,t,n){var r;return _classCallCheck(this,C),(r=x.call(this,e,n)).updateMergingQueue=new d.NamespacedMergingQueue((function(e,t){return"number"==typeof t.ttl?{ttl:t.ttl}:e})),r.cache=new l.Cache,r.descriptor=t,r.descriptor.date_updated=new Date(r.descriptor.date_updated),t.items&&t.items.forEach((function(e){e.date_updated=new Date(e.date_updated),r.cache.store(e.key,new u.MapItem(e),e.last_event_id)})),r}return _createClass(C,[{key:"set",value:(w=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,i){var s,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i||{},e.abrupt("return",(r.validateOptionalTtl(s.ttl),this.updateMergingQueue.squashAndAdd(t,s,(function(e){return a._putItemUnconditionally(t,n,e.ttl)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return w.apply(this,arguments)})},{key:"get",value:(_=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.cache.has(t)?this.cache.get(t):this._getItemFromServer(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"_getItemFromServer",value:(k=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryItems({key:t});case 2:if(!((n=e.sent).items.length<1)){e.next=5;break}throw new s.SyncError("No item with key ".concat(t," found"),404,54201);case 5:return e.abrupt("return",n.items[0]);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"mutate",value:(b=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,i){var s,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i||{},e.abrupt("return",(r.validateOptionalTtl(s.ttl),this.updateMergingQueue.add(t,s,(function(e){return a._putItemWithIfMatch(t,n,e.ttl)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return b.apply(this,arguments)})},{key:"update",value:(g=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mutate(t,(function(e){return Object.assign(e,n)}),r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return g.apply(this,arguments)})},{key:"_putItemUnconditionally",value:(m=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._putItemToServer(t,n,void 0,r);case 2:return i=e.sent,s=i.item,e.abrupt("return",(this._handleItemMutated(s.key,s.url,s.last_event_id,s.revision,s.data,s.date_updated,s.date_expires,i.added,!1),this.cache.get(s.key)));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return m.apply(this,arguments)})},{key:"_putItemWithIfMatch",value:(y=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,i){var s,a,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t).catch((function(e){if(404===e.status)return new u.MapItem({key:t,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw e}));case 2:if(s=e.sent,a=n(r.deepClone(s.value))){e.next=6;break}return e.abrupt("return",s);case 6:return o=s.revision,e.prev=7,e.next=10,this._putItemToServer(t,a,o,i);case 10:return c=e.sent,l=c.item,e.abrupt("return",(this._handleItemMutated(l.key,l.url,l.last_event_id,l.revision,l.data,l.date_updated,l.date_expires,c.added,!1),this.cache.get(l.key)));case 15:if(e.prev=15,e.t0=e.catch(7),412!==e.t0.status){e.next=21;break}return e.next=20,this._getItemFromServer(t);case 20:return e.abrupt("return",this._putItemWithIfMatch(t,n,i));case 21:throw e.t0;case 22:case"end":return e.stop()}}),e,this,[[7,15]])}))),function(e,t,n){return y.apply(this,arguments)})},{key:"_putItemToServer",value:(v=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,s){var a,o,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new i.UriBuilder(this.links.items).pathSegment(t).build(),o={data:n},"number"==typeof s&&(o.ttl=s),e.prev=2,e.next=5,this.services.network.put(a,o,r);case 5:return u=e.sent,c=u.body,e.abrupt("return",(c.data=n,c.date_updated=new Date(c.date_updated),{added:201===u.status.code,item:c}));case 10:throw e.prev=10,e.t0=e.catch(2),404===e.t0.status&&this.onRemoved(!1),e.t0;case 13:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(e,t,n,r){return v.apply(this,arguments)})},{key:"remove",value:(p=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}throw new Error("Key argument is invalid");case 2:return e.next=4,this.get(t);case 4:return n=e.sent,e.next=7,this.services.network.delete(n.uri);case 7:r=e.sent,this._handleItemRemoved(t,r.body.last_event_id,void 0,new Date(r.body.date_updated),!1);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"queryItems",value:(h=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,s,a,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},n=new i.UriBuilder(this.links.items).queryParam("From",t.from).queryParam("PageSize",t.limit).queryParam("Key",t.key).queryParam("PageToken",t.pageToken).queryParam("Order",t.order).build(),e.next=4,this.services.network.get(n);case 4:return r=e.sent,s=r.body.items.map((function(e){return e.date_updated=new Date(e.date_updated),o.cache.get(e.key)?o._handleItemMutated(e.key,e.url,e.last_event_id,e.revision,e.data,e.date_updated,e.date_expires,!1,!0):o.cache.store(e.key,new u.MapItem(e),e.last_event_id),o.cache.get(e.key)})),a=r.body.meta,e.abrupt("return",new c.Paginator(s,(function(e){return o.queryItems({pageToken:e})}),a.previous_token,a.next_token));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"getItems",value:(f=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(r.validatePageSize((t=t||{}).pageSize),t.limit=t.pageSize||t.limit||50,t.order=t.order||"asc",this.queryItems(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"shouldIgnoreEvent",value:function(e,t){return this.cache.isKnown(e,t)}},{key:"_update",value:function(e,t){switch(e.date_created=new Date(e.date_created),e.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(e.item_key,e.item_url,e.id,e.item_revision,e.item_data,e.date_created,void 0,"map_item_added"===e.type,!0);break;case"map_item_removed":this._handleItemRemoved(e.item_key,e.id,e.item_data,e.date_created,!0);break;case"map_removed":this.onRemoved(!1)}t&&this._advanceLastEventId(e.id,e.map_revision)}},{key:"_advanceLastEventId",value:function(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e,t&&(this.descriptor.revision=t))}},{key:"_updateRootDateUpdated",value:function(e){(!this.descriptor.date_updated||e.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=e,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:e}))}},{key:"_handleItemMutated",value:function(e,t,n,r,i,s,o,c,l){if(this.shouldIgnoreEvent(e,n))a.default.trace("Item ",e," update skipped, current:",this.lastEventId,", remote:",n);else{this._updateRootDateUpdated(s);var d=this.cache.get(e);d?(d.update(n,r,i,s),this.cache.store(e,d,n),void 0!==o&&d.updateDateExpires(o),this.emitItemMutationEvent(d,l,!1)):(d=new u.MapItem({key:e,url:t,last_event_id:n,revision:r,data:i,date_updated:s,date_expires:o}),this.cache.store(e,d,n),this.emitItemMutationEvent(d,l,c))}}},{key:"emitItemMutationEvent",value:function(e,t,n){this.broadcastEventToListeners(n?"itemAdded":"itemUpdated",{item:e,isLocal:!t})}},{key:"_handleItemRemoved",value:function(e,t,n,r,i){this._updateRootDateUpdated(r),this.cache.delete(e,t),this.broadcastEventToListeners("itemRemoved",{key:e,isLocal:!i,value:n})}},{key:"onRemoved",value:function(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}},{key:"setTtl",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.validateMandatoryTtl(t),e.prev=1,n={ttl:t},e.next=5,this.services.network.post(this.uri,n);case 5:i=e.sent,this.descriptor.date_expires=i.body.date_expires,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(1),404===e.t0.status&&this.onRemoved(!1),e.t0;case 12:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return o.apply(this,arguments)})},{key:"setItemTtl",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var i,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.validateMandatoryTtl(n),e.next=3,this.get(t);case 3:return i=e.sent,s={ttl:n},e.next=7,this.services.network.post(i.uri,s);case 7:a=e.sent,i.updateDateExpires(a.body.date_expires);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeMap",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"map"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}}],[{key:"type",get:function(){return"map"}}]),C}(o.SyncEntity);t.SyncMapImpl=h;var p=function(e){_inherits(d,e);var t,n,r,i,s,a,o,u,c,l=_createSuper(d);function d(e){var t;return _classCallCheck(this,d),(t=l.call(this)).syncMapImpl=e,t.syncMapImpl.attach(_assertThisInitialized(t)),t}return _createClass(d,[{key:"set",value:(c=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncMapImpl.set(t,n,r)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"get",value:(u=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncMapImpl.get(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"mutate",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncMapImpl.mutate(t,n,r)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"update",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncMapImpl.update(t,n,r)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return a.apply(this,arguments)})},{key:"remove",value:(s=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncMapImpl.remove(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getItems",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncMapImpl.getItems(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setTtl",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncMapImpl.setTtl(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setItemTtl",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncMapImpl.setItemTtl(t,n)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeMap",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.next=3,this.syncMapImpl.removeMap();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){_get3(_getPrototypeOf(d.prototype),"close",this).call(this),this.syncMapImpl.detach(this.listenerUuid)}},{key:"uri",get:function(){return this.syncMapImpl.uri}},{key:"links",get:function(){return this.syncMapImpl.links}},{key:"revision",get:function(){return this.syncMapImpl.revision}},{key:"lastEventId",get:function(){return this.syncMapImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncMapImpl.dateExpires}},{key:"type",get:function(){return h.type}},{key:"sid",get:function(){return this.syncMapImpl.sid}},{key:"uniqueName",get:function(){return this.syncMapImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncMapImpl.dateUpdated}}],[{key:"type",get:function(){return h.type}}]),d}(f.Closeable);t.SyncMap=p,t.default=p},BHqR:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("TkJz");t.AbstractMessage=function(){return function e(t){_classCallCheck(this,e),this.id=t||"TM".concat(r.v4())}}()},Bkdt:function(e,t,n){var r=n("8fQz"),i=n("1sfF");e.exports=n("rFq9").getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},BxSP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStorage=function(){function e(t,n){_classCallCheck(this,e),this.config=t,this.storageId=null;try{this.storage=n||sessionStorage}catch(r){}}return _createClass(e,[{key:"storageKey",value:function(e,t){return"".concat(this.storageId,"::").concat(e,"::").concat(t)}},{key:"updateStorageId",value:function(e){this.storageId=e}},{key:"store",value:function(e,t,n){return this.isReady?this._store(this.storageKey(e,t),n):null}},{key:"read",value:function(e,t){return this.isReady?this._read(this.storageKey(e,t)):null}},{key:"remove",value:function(e,t,n){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(e,t)),n&&this.storage.removeItem(this.storageKey(e,n))}catch(r){}}},{key:"update",value:function(e,t,n,r){if(!this.isReady)return null;this._apply(this.storageKey(e,t),r),n&&this._apply(this.storageKey(e,n),r)}},{key:"_store",value:function(e,t){try{this.storage.setItem(e,JSON.stringify(t))}catch(n){}}},{key:"_read",value:function(e){try{var t=this.storage.getItem(e);if(t)return JSON.parse(t)}catch(n){}return null}},{key:"_apply",value:function(e,t){var n=this._read(e);if(!n)return!1;this._store(e,Object.assign(n,t))}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}}]),e}()},CHRr:function(e,t,n){n("HWod");var r=n("rFq9").Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},CPx3:function(e,t,n){"use strict";var r=a(n("aq5/")),i=a(n("4Mt5")),s=a(n("oPEB"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("XdyU");function u(e,t){return[(new Date).toISOString()+" Chat "+e+":"].concat((0,s.default)(t))}var c=function(){function e(t){(0,r.default)(this,e),this.prefix="",this.prefix=null!=t&&t.length>0?t+" ":""}return(0,i.default)(e,[{key:"setLevel",value:function(e){o.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.trace.apply(null,u(this.prefix+"T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.debug.apply(null,u(this.prefix+"D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.info.apply(null,u(this.prefix+"I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.warn.apply(null,u(this.prefix+"W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.error.apply(null,u(this.prefix+"E",t))}}],[{key:"scope",value:function(t){return new e(t)}},{key:"setLevel",value:function(e){o.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.trace.apply(null,u("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.debug.apply(null,u("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.info.apply(null,u("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.warn.apply(null,u("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.error.apply(null,u("E",t))}}]),e}();t.Logger=c},CafK:function(e,t,n){e.exports={default:n("TjkB"),__esModule:!0}},Cf4i:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,e),this.activeGrant=n,this._token=t,this.url=(r.twilsock||r.Twilsock||{}).uri||"wss://tsock.".concat(r.region||"us1",".twilio.com/v3/wsconnect"),this._continuationToken=r.continuationToken?r.continuationToken:null,this.logLevel=r.logLevel?r.logLevel:"error",this.retryPolicy=r.retryPolicy?r.retryPolicy:{min:1e3,max:12e4,randomness:.2},this.clientMetadata=r.clientMetadata?r.clientMetadata:{},this.clientMetadata.ver="0.5.11",this.initRegistrations=r.initRegistrations?r.initRegistrations:null,this.tweaks=r.tweaks?r.tweaks:null}return _createClass(e,[{key:"updateToken",value:function(e){this._token=e}},{key:"updateContinuationToken",value:function(e){this._continuationToken=e}},{key:"token",get:function(){return this._token}},{key:"continuationToken",get:function(){return this._continuationToken}}]),e}()},CmQt:function(e,t,n){(function(e){var r;(function(){"use strict";var i={function:!0,object:!0},s=i[typeof window]&&window||this,a=i[typeof t]&&t&&i[typeof e]&&e&&!e.nodeType&&e&&"object"==typeof global&&global;!a||a.global!==a&&a.window!==a&&a.self!==a||(s=a);var o=Math.pow(2,53)-1,u=/\bOpera/,c=Object.prototype,l=c.hasOwnProperty,d=c.toString;function f(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function h(e){return e=g(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:f(e)}function p(e,t){for(var n in e)l.call(e,n)&&t(e[n],n,e)}function v(e){return null==e?f(e):d.call(e).slice(8,-1)}function y(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function m(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=o)for(;++n<r;)t(e[n],n);else p(e,t)}(e,(function(r,i){n=t(n,r,i,e)})),n}function g(e){return String(e).replace(/^ +| +$/g,"")}var b=function e(t){var n=s,r=t&&"object"==typeof t&&"String"!=v(t);r&&(n=t,t=null);var i=n.navigator||{},a=i.userAgent||"";t||(t=a);var o,c,l,f,b=r?!!i.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(d.toString()),k=r?"Object":"ScriptBridgingProxyObject",_=r?"Object":"Environment",w=r&&n.java?"JavaPackage":v(n.java),x=r?"Object":"RuntimeObject",C=/\bJava/.test(w)&&n.java,S=C&&v(n.environment)==_,T=C?"a":"\u03b1",R=C?"b":"\u03b2",M=n.document||{},E=n.operamini||n.opera,I=u.test(I=r&&E?E["[[Class]]"]:v(E))?I:E=null,P=t,O=[],N=null,j=t==a,L=j&&E&&"function"==typeof E.version&&E.version(),U=m([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||y(n))+"\\b","i").exec(t)&&(n.label||n)})),D=m(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],(function(e,n){return e||RegExp("\\b"+(n.pattern||y(n))+"\\b","i").exec(t)&&(n.label||n)})),A=B([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),q=m({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}},(function(e,n,r){return e||(n[A]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(A)]||RegExp("\\b"+y(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r})),F=m(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],(function(e,n){var r=n.pattern||y(n);return!e&&(e=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(r=r[/[\d.]+$/.exec(e)])&&(e="Windows "+r),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),h(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,r,n.label||n)),e}));function B(e){return m(e,(function(e,n){var r=n.pattern||y(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=h(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}if(U&&(U=[U]),q&&!A&&(A=B([q])),(o=/\bGoogle TV\b/.exec(A))&&(A=o[0]),/\bSimulator\b/i.test(t)&&(A=(A?A+" ":"")+"Simulator"),"Opera Mini"==D&&/\bOPiOS\b/.test(t)&&O.push("running in Turbo/Uncompressed mode"),"IE"==D&&/\blike iPhone OS\b/.test(t)?(q=(o=e(t.replace(/like iPhone OS/,""))).manufacturer,A=o.product):/^iP/.test(A)?(D||(D="Safari"),F="iOS"+((o=/ OS ([\d_]+)/i.exec(t))?" "+o[1].replace(/_/g,"."):"")):"Konqueror"!=D||/buntu/i.test(F)?q&&"Google"!=q&&(/Chrome/.test(D)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(A))||/\bAndroid\b/.test(F)&&/^Chrome/.test(D)&&/\bVersion\//i.test(t)?(D="Android Browser",F=/\bAndroid\b/.test(F)?F:"Android"):"Silk"==D?(/\bMobi/i.test(t)||(F="Android",O.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&O.unshift("accelerated")):"PaleMoon"==D&&(o=/\bFirefox\/([\d.]+)\b/.exec(t))?O.push("identifying as Firefox "+o[1]):"Firefox"==D&&(o=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(F||(F="Firefox OS"),A||(A=o[1])):!D||(o=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(D))?(D&&!A&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(o+"/")+8))&&(D=null),(o=A||q||F)&&(A||q||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(F))&&(D=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(F)?F:o)+" Browser")):"Electron"==D&&(o=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&O.push("Chromium "+o):F="Kubuntu",L||(L=m(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",y(D),"(?:Firefox|Minefield|NetFront)"],(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))),(o=("iCab"==U&&parseFloat(L)>3?"WebKit":/\bOpera\b/.test(D)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(U)&&"WebKit"||!U&&/\bMSIE\b/i.test(t)&&("Mac OS"==F?"Tasman":"Trident")||"WebKit"==U&&/\bPlayStation\b(?! Vita\b)/i.test(D)&&"NetFront")&&(U=[o]),"IE"==D&&(o=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(D+=" Mobile",F="Windows Phone "+(/\+$/.test(o)?o:o+".x"),O.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(D="IE Mobile",F="Windows Phone 8.x",O.unshift("desktop mode"),L||(L=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=D&&"Trident"==U&&(o=/\brv:([\d.]+)/.exec(t))&&(D&&O.push("identifying as "+D+(L?" "+L:"")),D="IE",L=o[1]),j){if(/^(?:boolean|number|string|undefined)$/.test(f=null!=(l=n)?typeof l.global:"number")||"object"==f&&!l.global)v(o=n.runtime)==k?(D="Adobe AIR",F=o.flash.system.Capabilities.os):v(o=n.phantom)==x?(D="PhantomJS",L=(o=o.version||null)&&o.major+"."+o.minor+"."+o.patch):"number"==typeof M.documentMode&&(o=/\bTrident\/(\d+)/i.exec(t))?((o=+o[1]+4)!=(L=[L,M.documentMode])[1]&&(O.push("IE "+L[1]+" mode"),U&&(U[1]=""),L[1]=o),L="IE"==D?String(L[1].toFixed(1)):L[0]):"number"==typeof M.documentMode&&/^(?:Chrome|Firefox)\b/.test(D)&&(O.push("masking as "+D+" "+L),D="IE",L="11.0",U=["Trident"],F="Windows");else if(C&&(P=(o=C.lang.System).getProperty("os.arch"),F=F||o.getProperty("os.name")+" "+o.getProperty("os.version")),S){try{L=n.require("ringo/engine").version.join("."),D="RingoJS"}catch(W){(o=n.system)&&o.global.system==n.system&&(D="Narwhal",F||(F=o[0].os||null))}D||(D="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(o=n.process)&&("object"==typeof o.versions&&("string"==typeof o.versions.electron?(O.push("Node "+o.versions.node),D="Electron",L=o.versions.electron):"string"==typeof o.versions.nw&&(O.push("Chromium "+L,"Node "+o.versions.node),D="NW.js",L=o.versions.nw)),D||(D="Node.js",P=o.arch,F=o.platform,L=(L=/[\d.]+/.exec(o.version))?L[0]:null));F=F&&h(F)}if(L&&(o=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(L)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(j&&i.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(N=/b/i.test(o)?"beta":"alpha",L=L.replace(RegExp(o+"\\+?$"),"")+("beta"==N?R:T)+(/\d+\+?/.exec(o)||"")),"Fennec"==D||"Firefox"==D&&/\b(?:Android|Firefox OS)\b/.test(F))D="Firefox Mobile";else if("Maxthon"==D&&L)L=L.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(A))"Xbox 360"==A&&(F=null),"Xbox 360"==A&&/\bIEMobile\b/.test(t)&&O.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(D)&&(!D||A||/Browser|Mobi/.test(D))||"Windows CE"!=F&&!/Mobi/i.test(t))if("IE"==D&&j)try{null===n.external&&O.unshift("platform preview")}catch(W){O.unshift("embedded")}else(/\bBlackBerry\b/.test(A)||/\bBB10\b/.test(t))&&(o=(RegExp(A.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||L)?(F=((o=[o,/BB10/.test(t)])[1]?(A=null,q="BlackBerry"):"Device Software")+" "+o[0],L=null):this!=p&&"Wii"!=A&&(j&&E||/Opera/.test(D)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==D&&/\bOS X (?:\d+\.){2,}/.test(F)||"IE"==D&&(F&&!/^Win/.test(F)&&L>5.5||/\bWindows XP\b/.test(F)&&L>8||8==L&&!/\bTrident\b/.test(t)))&&!u.test(o=e.call(p,t.replace(u,"")+";"))&&o.name&&(o="ing as "+o.name+((o=o.version)?" "+o:""),u.test(D)?(/\bIE\b/.test(o)&&"Mac OS"==F&&(F=null),o="identify"+o):(o="mask"+o,D=I?h(I.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(o)&&(F=null),j||(L=null)),U=["Presto"],O.push(o));else D+=" Mobile";(o=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(o=[parseFloat(o.replace(/\.(\d)$/,".0$1")),o],"Safari"==D&&"+"==o[1].slice(-1)?(D="WebKit Nightly",N="alpha",L=o[1].slice(0,-1)):L!=o[1]&&L!=(o[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(L=null),o[1]=(/\bChrome\/([\d.]+)/i.exec(t)||0)[1],537.36==o[0]&&537.36==o[2]&&parseFloat(o[1])>=28&&"WebKit"==U&&(U=["Blink"]),j&&(b||o[1])?(U&&(U[1]="like Chrome"),o=o[1]||((o=o[0])<530?1:o<532?2:o<532.05?3:o<533?4:o<534.03?5:o<534.07?6:o<534.1?7:o<534.13?8:o<534.16?9:o<534.24?10:o<534.3?11:o<535.01?12:o<535.02?"13+":o<535.07?15:o<535.11?16:o<535.19?17:o<536.05?18:o<536.1?19:o<537.01?20:o<537.11?"21+":o<537.13?23:o<537.18?24:o<537.24?25:o<537.36?26:"Blink"!=U?"27":"28")):(U&&(U[1]="like Safari"),o=(o=o[0])<400?1:o<500?2:o<526?3:o<533?4:o<534?"4+":o<535?5:o<537?6:o<538?7:o<601?8:"8"),U&&(U[1]+=" "+(o+="number"==typeof o?".x":/[.+]/.test(o)?"":"+")),"Safari"==D&&(!L||parseInt(L)>45)&&(L=o)),"Opera"==D&&(o=/\bzbov|zvav$/.exec(F))?(D+=" ",O.unshift("desktop mode"),"zvav"==o?(D+="Mini",L=null):D+="Mobile",F=F.replace(RegExp(" *"+o+"$"),"")):"Safari"==D&&/\bChrome\b/.exec(U&&U[1])&&(O.unshift("desktop mode"),D="Chrome Mobile",L=null,/\bOS X\b/.test(F)?(q="Apple",F="iOS 4.3+"):F=null),L&&0==L.indexOf(o=/[\d.]+$/.exec(F))&&t.indexOf("/"+o+"-")>-1&&(F=g(F.replace(o,""))),U&&!/\b(?:Avant|Nook)\b/.test(D)&&(/Browser|Lunascape|Maxthon/.test(D)||"Safari"!=D&&/^iOS/.test(F)&&/\bSafari\b/.test(U[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(D)&&U[1])&&(o=U[U.length-1])&&O.push(o),O.length&&(O=["("+O.join("; ")+")"]),q&&A&&A.indexOf(q)<0&&O.push("on "+q),A&&O.push((/^on /.test(O[O.length-1])?"":"on ")+A),F&&(o=/ ([\d.+]+)$/.exec(F),c=o&&"/"==F.charAt(F.length-o[0].length-1),F={architecture:32,family:o&&!c?F.replace(o[0],""):F,version:o?o[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(o=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(P))&&!/\bi686\b/i.test(P)?(F&&(F.architecture=64,F.family=F.family.replace(RegExp(" *"+o),"")),D&&(/\bWOW64\b/i.test(t)||j&&/\w(?:86|32)$/.test(i.cpuClass||i.platform)&&!/\bWin64; x64\b/i.test(t))&&O.unshift("32-bit")):F&&/^OS X/.test(F.family)&&"Chrome"==D&&parseFloat(L)>=39&&(F.architecture=64),t||(t=null);var G={};return G.description=t,G.layout=U&&U[0],G.manufacturer=q,G.name=D,G.prerelease=N,G.product=A,G.ua=t,G.version=D&&L,G.os=F||{architecture:null,family:null,version:null,toString:function(){return"null"}},G.parse=e,G.toString=function(){return this.description||""},G.version&&O.unshift(L),G.name&&O.unshift(D),F&&D&&(F!=String(F).split(" ")[0]||F!=D.split(" ")[0]&&!A)&&O.push(A?"("+F+")":"on "+F),O.length&&(G.description=O.join(" ")),G}();s.platform=b,void 0===(r=(function(){return b}).call(t,n,t,e))||(e.exports=r)}).call(this)}).call(this,n("aYSr")(e))},CmYO:function(e,t,n){var r,i,s,a=n("dWRk"),o=n("IAQa"),u=n("wHU4"),c=n("1bLK"),l=n("hR4s"),d=l.process,f=l.setImmediate,h=l.clearImmediate,p=l.MessageChannel,v=l.Dispatch,y=0,m={},g=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},b=function(e){g.call(e.data)};f&&h||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return m[++y]=function(){o("function"==typeof e?e:Function(e),t)},r(y),y},h=function(e){delete m[e]},"process"==n("e7fL")(d)?r=function(e){d.nextTick(a(g,e,1))}:v&&v.now?r=function(e){v.now(a(g,e,1))}:p?(s=(i=new p).port2,i.port1.onmessage=b,r=a(s.postMessage,s,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):r="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),g.call(e)}}:function(e){setTimeout(a(g,e,1),0)}),e.exports={set:f,clear:h}},CrJZ:function(e,t,n){"use strict";var r=n("hR4s"),i=n("YVtA"),s=n("ObEa"),a=n("IFjL"),o=n("Eolq"),u=n("aRFn").KEY,c=n("7S/a"),l=n("kz3d"),d=n("KnMe"),f=n("b1KM"),h=n("eD9m"),p=n("dWcX"),v=n("9YHp"),y=n("Hjik"),m=n("gNE/"),g=n("8fQz"),b=n("vbc5"),k=n("MrWc"),_=n("Hs7Z"),w=n("Kc1g"),x=n("jHgz"),C=n("yew7"),S=n("QdMa"),T=n("VeTy"),R=n("dptC"),M=n("UwCj"),E=n("ApsS"),I=T.f,P=M.f,O=S.f,N=r.Symbol,j=r.JSON,L=j&&j.stringify,U=h("_hidden"),D=h("toPrimitive"),A={}.propertyIsEnumerable,q=l("symbol-registry"),F=l("symbols"),B=l("op-symbols"),G=Object.prototype,W="function"==typeof N&&!!R.f,z=r.QObject,H=!z||!z.prototype||!z.prototype.findChild,Q=s&&c((function(){return 7!=C(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=I(G,t);r&&delete G[t],P(e,t,n),r&&e!==G&&P(G,t,r)}:P,X=function(e){var t=F[e]=C(N.prototype);return t._k=e,t},J=W&&"symbol"==typeof N.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof N},K=function e(t,n,r){return t===G&&e(B,n,r),g(t),n=w(n,!0),g(r),i(F,n)?(r.enumerable?(i(t,U)&&t[U][n]&&(t[U][n]=!1),r=C(r,{enumerable:x(0,!1)})):(i(t,U)||P(t,U,x(1,{})),t[U][n]=!0),Q(t,n,r)):P(t,n,r)},V=function(e,t){g(e);for(var n,r=y(t=_(t)),i=0,s=r.length;s>i;)K(e,n=r[i++],t[n]);return e},Y=function(e){var t=A.call(this,e=w(e,!0));return!(this===G&&i(F,e)&&!i(B,e))&&(!(t||!i(this,e)||!i(F,e)||i(this,U)&&this[U][e])||t)},Z=function(e,t){if(e=_(e),t=w(t,!0),e!==G||!i(F,t)||i(B,t)){var n=I(e,t);return!n||!i(F,t)||i(e,U)&&e[U][t]||(n.enumerable=!0),n}},$=function(e){for(var t,n=O(_(e)),r=[],s=0;n.length>s;)i(F,t=n[s++])||t==U||t==u||r.push(t);return r},ee=function(e){for(var t,n=e===G,r=O(n?B:_(e)),s=[],a=0;r.length>a;)!i(F,t=r[a++])||n&&!i(G,t)||s.push(F[t]);return s};W||(o((N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function t(n){this===G&&t.call(B,n),i(this,U)&&i(this[U],e)&&(this[U][e]=!1),Q(this,e,x(1,n))};return s&&H&&Q(G,e,{configurable:!0,set:t}),X(e)}).prototype,"toString",(function(){return this._k})),T.f=Z,M.f=K,n("z7HR").f=S.f=$,n("DIWJ").f=Y,R.f=ee,s&&!n("UtsQ")&&o(G,"propertyIsEnumerable",Y,!0),p.f=function(e){return X(h(e))}),a(a.G+a.W+a.F*!W,{Symbol:N});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)h(te[ne++]);for(var re=E(h.store),ie=0;re.length>ie;)v(re[ie++]);a(a.S+a.F*!W,"Symbol",{for:function(e){return i(q,e+="")?q[e]:q[e]=N(e)},keyFor:function(e){if(!J(e))throw TypeError(e+" is not a symbol!");for(var t in q)if(q[t]===e)return t},useSetter:function(){H=!0},useSimple:function(){H=!1}}),a(a.S+a.F*!W,"Object",{create:function(e,t){return void 0===t?C(e):V(C(e),t)},defineProperty:K,defineProperties:V,getOwnPropertyDescriptor:Z,getOwnPropertyNames:$,getOwnPropertySymbols:ee});var se=c((function(){R.f(1)}));a(a.S+a.F*se,"Object",{getOwnPropertySymbols:function(e){return R.f(k(e))}}),j&&a(a.S+a.F*(!W||c((function(){var e=N();return"[null]"!=L([e])||"{}"!=L({a:e})||"{}"!=L(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(b(t)||void 0!==e)&&!J(e))return m(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!J(t))return t}),r[1]=t,L.apply(j,r)}}),N.prototype[D]||n("b95h")(N.prototype,D,N.prototype.valueOf),d(N,"Symbol"),d(Math,"Math",!0),d(r.JSON,"JSON",!0)},DIWJ:function(e,t){t.f={}.propertyIsEnumerable},E9sr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("m+l7"),i=Object.prototype.hasOwnProperty;function s(e,t){var n={};for(var r in e)i.call(e,r)&&void 0!==e[r]&&(n[r]=1);for(var s in t)i.call(t,s)&&void 0!==t[s]&&delete n[s];return Object.keys(n)}function a(e){for(var t=e.length,n={},r=0;r<t;r++){var s=e[r];for(var a in s)i.call(s,a)&&void 0!==s[a]&&(n[a]=(n[a]||0)+1)}for(var a in n)n[a]<t&&delete n[a];return Object.keys(n)}function o(e,t){return{operations:e.operations.concat(t),cost:e.cost+1}}function u(e,t,n,i){void 0===i&&(i=d);var s={"0,0":{operations:[],cost:0}},a=isNaN(e.length)||e.length<=0?0:e.length,u=isNaN(t.length)||t.length<=0?0:t.length;return function n(i,a){var u=i+","+a,c=s[u];if(void 0===c){if(i>0&&a>0&&r.compare(e[i-1],t[a-1]))c=n(i-1,a-1);else{var l=[];if(i>0){var d=n(i-1,a);l.push(o(d,{op:"remove",index:i-1}))}if(a>0){var f=n(i,a-1);l.push(o(f,{op:"add",index:i-1,value:t[a-1]}))}if(i>0&&a>0){var h=n(i-1,a-1);l.push(o(h,{op:"replace",index:i-1,original:e[i-1],value:t[a-1]}))}c=l.sort((function(e,t){return e.cost-t.cost}))[0]}s[u]=c}return c}(a,u).operations.reduce((function(e,t){var r=e[0],s=e[1];if(function(e){return"add"===e.op}(t)){var o=t.index+1+s,u=o<a+s?String(o):"-",c={op:t.op,path:n.add(u).toString(),value:t.value};return[r.concat(c),s+1]}if(function(e){return"remove"===e.op}(t))return c={op:t.op,path:n.add(String(t.index+s)).toString()},[r.concat(c),s-1];var l=n.add(String(t.index+s)),d=i(t.original,t.value,l);return[r.concat.apply(r,d),s]}),[[],0])[0]}function c(e,t,n,r){void 0===r&&(r=d);var i=[];return s(e,t).forEach((function(e){i.push({op:"remove",path:n.add(e).toString()})})),s(t,e).forEach((function(e){i.push({op:"add",path:n.add(e).toString(),value:t[e]})})),a([e,t]).forEach((function(s){i.push.apply(i,r(e[s],t[s],n.add(s)))})),i}function l(e,t,n){return r.compare(e,t)?[]:[{op:"replace",path:n.toString(),value:t}]}function d(e,t,n,i){void 0===i&&(i=d);var s=r.objectType(e),a=r.objectType(t);return"array"==s&&"array"==a?u(e,t,n,i):"object"==s&&"object"==a?c(e,t,n,i):l(e,t,n)}t.isDestructive=function(e){var t=e.op;return"remove"===t||"replace"===t||"copy"===t||"move"===t},t.subtract=s,t.intersection=a,t.diffArrays=u,t.diffObjects=c,t.diffValues=l,t.diffAny=d},EWHn:function(e,t,n){var r=n("eD9m")("iterator"),i=!1;try{var s=[7][r]();s.return=function(){i=!0},Array.from(s,(function(){throw 2}))}catch(a){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var s=[7],o=s[r]();o.next=function(){return{done:n=!0}},s[r]=function(){return o},e(s)}catch(a){}return n}},EfDG:function(e,t,n){"use strict";var r=n("zCrM"),i=n("S5Zg");e.exports=n("HKkr")("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=r.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},Eolq:function(e,t,n){e.exports=n("b95h")},Eqmn:function(e,t,n){var r=n("vbc5"),i=n("8fQz"),s=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n("dWRk")(Function.call,n("VeTy").f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(i){t=!0}return function(e,n){return s(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:s}},EtEV:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("r2q8"),i=n("5ZaL"),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;_classCallCheck(this,e),this.token=t,this.notificationId=n,this.messageTypes=r}return _createClass(e,[{key:"clone",value:function(){return new e(this.token,this.notificationId,new Set(this.messageTypes))}}]),e}();t.RegistrationState=s,t.Connector=function(e){_inherits(o,e);var t,n,r,a=_createSuper(o);function o(e){var t;return _classCallCheck(this,o),(t=a.call(this)).config=e,t.desiredState=new s,t.currentState=new s,t.hasActiveAttempt=!1,t}return _createClass(o,[{key:"subscribe",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.desiredState.messageTypes.has(t)){e.next=4;break}i.log.debug("message type already registered ",t),e.next=7;break;case 4:return this.desiredState.messageTypes.add(t),e.next=7,this.persistRegistration();case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"unsubscribe",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.desiredState.messageTypes.has(t),!e.t0){e.next=5;break}return this.desiredState.messageTypes.delete(t),e.next=5,this.persistRegistration();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateToken",value:function(e){this.desiredState.token=e,this.persistRegistration()}},{key:"persistRegistration",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,s,a,o,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.token&&0!==this.config.token.length){e.next=2;break}return e.abrupt("return",void i.log.trace("Can't persist registration: token is not set"));case 2:if(!this.hasActiveAttempt){e.next=4;break}return e.abrupt("return",void i.log.trace("One registration attempt is already in progress"));case 4:if(t=function(e,t){var n=new Set;return e.notificationId!==t.notificationId&&n.add("notificationId"),e.token!==t.token&&n.add("token"),function(e,t){return[].concat(_toConsumableArray(_toConsumableArray(e).filter((function(e){return!t.has(e)}))),_toConsumableArray(_toConsumableArray(t).filter((function(t){return!e.has(t)}))))}(e.messageTypes,t.messageTypes).length>0&&n.add("messageType"),[n.size>0,n]}(this.desiredState,this.currentState),n=_slicedToArray(t,2),r=n[0],s=n[1],!r){e.next=26;break}if(this.currentState.notificationId||s.delete("notificationId"),i.log.trace("Persisting registration",s,this.desiredState),e.prev=7,this.hasActiveAttempt=!0,!((a=this.desiredState.clone()).messageTypes.size>0)){e.next=17;break}return e.next=13,this.updateRegistration(a,s);case 13:o=e.sent,this.currentState.token=o.token,this.currentState.notificationId=o.notificationId,this.currentState.messageTypes=o.messageTypes,this.emit("stateChanged","registered"),e.next=23;break;case 17:return e.next=19,this.removeRegistration();case 19:this.currentState.token=a.token,this.currentState.notificationId=a.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged","unregistered");case 23:return e.prev=23,this.hasActiveAttempt=!1,setTimeout((function(){return u.persistRegistration()}),0),e.finish(23);case 26:case"end":return e.stop()}}),e,this,[[7,,23,26]])}))),function(){return t.apply(this,arguments)})},{key:"setNotificationId",value:function(e){this.desiredState.notificationId=e,this.persistRegistration()}}]),o}(r.EventEmitter)},"F//K":function(e,t,n){n("dUHx"),n("/r3m"),n("Fk9O"),n("EfDG"),n("AwPv"),n("SZul"),n("Lwwr"),e.exports=n("rFq9").Map},F8DB:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("tqb5");t.TwilsockClient=r.TwilsockClient,t.Twilsock=r.TwilsockClient;var i=n("SbVi");t.TwilsockError=i.TwilsockError;var s=n("c/HT");t.TransportUnavailableError=s.TransportUnavailableError},FSt9:function(e,t,n){"use strict";var r=s(n("aq5/")),i=s(n("4Mt5"));function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){(0,r.default)(this,e);var n=(t=t||{}).Chat||t.IPMessaging||t||{};this.region=n.region||t.region,this.baseUrl=n.apiUri||n.typingUri||(this.region&&"us1"!==this.region?"https://aim."+this.region+".twilio.com":"https://aim.twilio.com"),this.typingIndicatorUri=this.baseUrl+"/v1/typing",this.typingIndicatorTimeoutOverride=n.typingIndicatorTimeoutOverride,this.httpCacheIntervalOverride=n.httpCacheIntervalOverride,this.consumptionReportIntervalOverride=n.consumptionReportIntervalOverride,this.userInfosToSubscribeOverride=n.userInfosToSubscribeOverride,this.retryWhenThrottledOverride=n.retryWhenThrottledOverride,this.backoffConfigOverride=n.backoffConfigOverride}return(0,i.default)(e,[{key:"typingIndicatorTimeoutDefault",get:function(){return 5e3}},{key:"httpCacheIntervalDefault",get:function(){return"PT5S"}},{key:"consumptionReportIntervalDefault",get:function(){return"PT5S"}},{key:"userInfosToSubscribeDefault",get:function(){return 100}},{key:"retryWhenThrottledDefault",get:function(){return!0}},{key:"backoffConfigDefault",get:function(){return{min:1e3,max:4e3,maxAttemptsCount:3}}}]),e}();t.Configuration=a},Ff16:function(e,t,n){n("zjhQ")("Set")},Fk9O:function(e,t,n){n("j/aJ");for(var r=n("hR4s"),i=n("b95h"),s=n("tReM"),a=n("eD9m")("toStringTag"),o="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<o.length;u++){var c=o[u],l=r[c],d=l&&l.prototype;d&&!d[a]&&i(d,a,c),s[c]=s.Array}},FukD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("70ul");t.Init=r.Init;var i=n("vsn+");t.InitReply=i.InitReply;var s=n("kcEc");t.Update=s.Update;var a=n("hsRX");t.Message=a.Message;var o=n("ViZE");t.Reply=o.Reply;var u=n("pagH");t.Close=u.Close},"G+rG":function(e,t,n){var r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,s=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n("mFO2"),i)r.regeneratorRuntime=s;else try{delete r.regeneratorRuntime}catch(a){r.regeneratorRuntime=void 0}},G1hA:function(e){e.exports=JSON.parse('{"_from":"twilio-chat","_id":"twilio-chat@3.3.4","_inBundle":false,"_integrity":"sha512-HZ68AWlsqVNjKum4dPHJ3gFkDPmrhzld4rHiQHbOlSPXO05Tyw8z4dwRki7SdTntLpqVL3lZeF7lSXz73pHs3A==","_location":"/twilio-chat","_phantomChildren":{},"_requested":{"type":"tag","registry":true,"raw":"twilio-chat","name":"twilio-chat","escapedName":"twilio-chat","rawSpec":"","saveSpec":null,"fetchSpec":"latest"},"_requiredBy":["#USER","/"],"_resolved":"https://registry.npmjs.org/twilio-chat/-/twilio-chat-3.3.4.tgz","_shasum":"0211c85424b59ebdc8e68ab1000c82e6345b69a4","_spec":"twilio-chat","_where":"D:\\\\Gabrielle2\\\\Development\\\\Web\\\\cooper-pantry\\\\cooper","author":{"name":"Twilio"},"browser":"browser/index.js","browserslist":["IE 11","last 3 Chrome versions","last 3 Firefox versions","last 3 Safari versions","last 3 Edge versions","last 2 iOS version","last 2 ChromeAndroid version","last 2 FirefoxAndroid version","last 2 Samsung versions","last 2 UCAndroid versions"],"bundleDependencies":false,"dependencies":{"iso8601-duration":"^1.2.0","loglevel":"^1.6.6","operation-retrier":"^3.0.0","platform":"^1.3.5","rfc6902":"^3.0.2","twilio-mcs-client":"^0.3.3","twilio-notifications":"^0.5.8","twilio-sync":"^0.11.5","twilsock":"^0.5.11","uuid":"^3.3.2"},"deprecated":false,"description":"Twilio Chat service client library","devDependencies":{"@types/chai":"^4.2.5","@types/chai-as-promised":"^7.1.2","@types/chai-string":"^1.4.1","@types/core-js":"^2.5.0","@types/mocha":"^5.2.7","@types/node":"^12.12.12","@types/sinon":"^7.5.1","@types/sinon-chai":"^3.2.2","async":"^3.0.1","async-test-tools":"^1.0.7","babel-core":"^6.26.0","babel-plugin-transform-builtin-extend":"^1.1.2","babel-plugin-transform-runtime":"^6.23.0","babel-preset-env":"^1.6.1","babel-runtime":"^6.26.0","babelify":"^8.0.0","backoff":"^2.5.0","browserify":"^16.2.3","browserify-replace":"^1.0.0","browserslist":"^4.7.3","chai":"^4.2.0","chai-as-promised":"^7.1.1","chai-string":"^1.5.0","cheerio":"^1.0.0-rc.2","cross-env":"^5.2.0","del":"^5.1.0","fancy-log":"^1.3.3","fs":"0.0.2","gulp":"^4.0.2","gulp-babel":"^7.0.1","gulp-derequire":"^2.1.0","gulp-if":"^2.0.2","gulp-insert":"^0.5.0","gulp-rename":"^1.4.0","gulp-sourcemaps":"^2.6.5","gulp-tap":"^1.0.1","gulp-tslint":"^8.1.4","gulp-typescript":"^5.0.1","gulp-uglify-es":"^1.0.4","ink-docstrap":"^1.3.2","isomorphic-form-data":"^2.0.0","jsdoc":"~3.5.5","jsdoc-strip-async-await":"^0.1.0","mocha":"^6.2.2","mocha.parallel":"^0.15.6","nyc":"^14.1.1","path":"^0.12.7","sinon":"^7.5.0","sinon-chai":"^3.3.0","source-map-explorer":"^2.1.1","ts-node":"^8.5.2","tslint":"^5.20.1","twilio":"^3.37.1","typescript":"^3.7.2","uglify-save-license":"^0.4.1","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},"engines":{"node":">=6"},"license":"MIT","main":"lib/index.js","name":"twilio-chat","types":"./lib/client.d.ts","version":"3.3.4"}')},HKkr:function(e,t,n){"use strict";var r=n("hR4s"),i=n("IFjL"),s=n("aRFn"),a=n("7S/a"),o=n("b95h"),u=n("qa3O"),c=n("9v8s"),l=n("s0lH"),d=n("vbc5"),f=n("KnMe"),h=n("UwCj").f,p=n("1yva")(0),v=n("ObEa");e.exports=function(e,t,n,y,m,g){var b=r[e],k=b,_=m?"set":"add",w=k&&k.prototype,x={};return v&&"function"==typeof k&&(g||w.forEach&&!a((function(){(new k).entries().next()})))?(k=t((function(t,n){l(t,k,e,"_c"),t._c=new b,null!=n&&c(n,m,t[_],t)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var t="add"==e||"set"==e;!(e in w)||g&&"clear"==e||o(k.prototype,e,(function(n,r){if(l(this,k,e),!t&&g&&!d(n))return"get"==e&&void 0;var i=this._c[e](0===n?0:n,r);return t?this:i}))})),g||h(k.prototype,"size",{get:function(){return this._c.size}})):(k=y.getConstructor(t,e,m,_),u(k.prototype,n),s.NEED=!0),f(k,e),x[e]=k,i(i.G+i.W+i.F,x),g||y.setStrong(k,e,m),k}},HWod:function(e,t,n){var r=n("IFjL");r(r.S+r.F*!n("ObEa"),"Object",{defineProperty:n("UwCj").f})},Hjik:function(e,t,n){var r=n("ApsS"),i=n("dptC"),s=n("DIWJ");e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,o=n(e),u=s.f,c=0;o.length>c;)u.call(e,a=o[c++])&&t.push(a);return t}},HoF5:function(e,t,n){n("dUHx"),n("/r3m"),n("Fk9O"),n("Y+Rv"),n("aSQu"),n("YR+c"),e.exports=n("rFq9").Promise},Hs7Z:function(e,t,n){var r=n("aAA+"),i=n("rU52");e.exports=function(e){return r(i(e))}},IAQa:function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},IFjL:function(e,t,n){var r=n("hR4s"),i=n("rFq9"),s=n("dWRk"),a=n("b95h"),o=n("YVtA"),u=function e(t,n,u){var c,l,d,f=t&e.F,h=t&e.G,p=t&e.S,v=t&e.P,y=t&e.B,m=t&e.W,g=h?i:i[n]||(i[n]={}),b=g.prototype,k=h?r:p?r[n]:(r[n]||{}).prototype;for(c in h&&(u=n),u)(l=!f&&k&&void 0!==k[c])&&o(g,c)||(d=l?k[c]:u[c],g[c]=h&&"function"!=typeof k[c]?u[c]:y&&l?s(d,r):m&&k[c]==d?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(d):v&&"function"==typeof d?s(Function.call,d):d,v&&((g.virtual||(g.virtual={}))[c]=d,t&e.R&&b&&!b[c]&&a(b,c,d)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},IgrD:function(e,t,n){var r=n("IFjL");r(r.S+r.F,"Object",{assign:n("XWhX")})},IhEH:function(e,t,n){"use strict";t.__esModule=!0;var r,i=(r=n("XUND"))&&r.__esModule?r:{default:r};t.default=function(e){return function(){var t=e.apply(this,arguments);return new i.default((function(e,n){return function r(s,a){try{var o=t[s](a),u=o.value}catch(c){return void n(c)}if(!o.done)return i.default.resolve(u).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(u)}("next")}))}}},IkCb:function(e,t,n){n("CrJZ"),n("dUHx"),n("PkSp"),n("zZTv"),e.exports=n("rFq9").Symbol},Isrn:function(e,t,n){"use strict";var r=o(n("tgXR")),i=o(n("IhEH")),s=o(n("aq5/")),a=o(n("4Mt5"));function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n("RtQP"),c=n("ZYEu"),l=n("Xfc8"),d=function(){function e(t,n,r){(0,s.default)(this,e),this.client=t,this.services=n,this.url=r}var t,n,o;return(0,a.default)(e,[{key:"getChannels",value:(o=(0,i.default)(r.default.mark((function e(){var t,n,i=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new u.UriBuilder(this.url).arg("PageToken",s.pageToken).build(),e.next=3,this.services.network.get(t);case 3:return e.abrupt("return",new c.RestPaginator((n=e.sent).body.channels.map((function(e){return new l.ChannelDescriptor(i.client,e)})),(function(e){return i.getChannels({pageToken:e})}),n.body.meta.previous_token,n.body.meta.next_token));case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getChannelBySid",value:(n=(0,i.default)(r.default.mark((function e(t){var n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new u.UriBuilder(this.url).path(t).build(),e.next=3,this.services.network.get(n);case 3:return e.abrupt("return",new l.ChannelDescriptor(this.client,e.sent.body));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getChannelByUniqueName",value:(t=(0,i.default)(r.default.mark((function e(t){var n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new u.UriBuilder(this.url).path(t).build(),e.next=3,this.services.network.get(n);case 3:return e.abrupt("return",new l.ChannelDescriptor(this.client,e.sent.body));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.PublicChannels=d},J0XI:function(e,t,n){var r=n("YVtA"),i=n("Hs7Z"),s=n("J1Io")(!1),a=n("ubhL")("IE_PROTO");e.exports=function(e,t){var n,o=i(e),u=0,c=[];for(n in o)n!=a&&r(o,n)&&c.push(n);for(;t.length>u;)r(o,n=t[u++])&&(~s(c,n)||c.push(n));return c}},J1Io:function(e,t,n){var r=n("Hs7Z"),i=n("MPuG"),s=n("6UZt");e.exports=function(e){return function(t,n,a){var o,u=r(t),c=i(u.length),l=s(a,c);if(e&&n!=n){for(;c>l;)if((o=u[l++])!=o)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}}},JA1H:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomerModule",(function(){return C}));var r,i=n("2kYt"),s=n("3KNA"),a=n("sEIs"),o=n("EM62"),u=n("D57K"),c=n("CW98"),l=n("y51I"),d=n("ZTXN"),f=n("SrNW"),h=n("kuMc"),p=((r=function(){function e(t,n){_classCallCheck(this,e),this.httpService=t,this.user=n,this.currentId="4",this.send=new d.a,this.newMsg=new d.a,this.destroyed=new d.a,this.messages=this.newMsg.pipe(Object(f.a)((function(e,t){return[].concat(_toConsumableArray(e),[t])}),[]))}return _createClass(e,[{key:"connect",value:function(){return Object(u.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,s,a,o,u,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.user.getById(this.currentId).toPromise();case 2:return t=e.sent,e.next=5,this.httpService.getChatToken({identity:this.currentId}).toPromise();case 5:return n=e.sent,e.next=8,l.Client.create(n);case 8:return r=e.sent,e.next=11,r.getSubscribedChannels();case 11:i=e.sent,s=_createForOfIteratorHelper(i.items),e.prev=13,s.s();case 15:if((a=s.n()).done){e.next=26;break}if((o=a.value).createdBy!==t.id){e.next=22;break}return e.next=20,o.delete();case 20:e.next=24;break;case 22:return e.next=24,o.leave();case 24:e.next=15;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(13),s.e(e.t0);case 31:return e.prev=31,s.f(),e.finish(31);case 34:return e.next=36,r.createChannel();case 36:return u=e.sent,e.next=39,u.join();case 39:u.on("messageAdded",(function(e){var n=e.author===t.id;c.newMsg.next({text:e.body,date:e.dateUpdated,reply:n,user:{name:n?"You":"Cooper Bot",avatar:n?void 0:"https://s3.amazonaws.com/pix.iemoji.com/images/emoji/apple/ios-12/256/robot-face.png"}})})),this.send.pipe(Object(h.a)(this.destroyed)).subscribe((function(e){u.sendMessage(e)})),this.httpService.addChatBot({channelSid:u.sid}).toPromise();case 42:case"end":return e.stop()}}),e,this,[[13,28,31,34]])})))}},{key:"sendMessage",value:function(e){this.send.next(e.message)}},{key:"ngOnDestroy",value:function(){this.destroyed.next()}}]),e}()).\u0275fac=function(e){return new(e||r)(o.cc(c.b),o.cc(c.c))},r.\u0275prov=o.Ob({token:r,factory:r.\u0275fac}),r),v=n("UnYO");function y(e,t){if(1&e&&o.Tb(0,"nb-chat-message",3),2&e){var n=t.$implicit;o.oc("message",n.text)("reply",n.reply)("sender",n.user.name)("date",n.date)("avatar",n.user.avatar)}}var m,g,b,k,_=((m=function(){function e(t){_classCallCheck(this,e),this.service=t,this.messages=this.service.messages,this.service.connect()}return _createClass(e,[{key:"sendMessage",value:function(e){this.service.sendMessage(e)}}]),e}()).\u0275fac=function(e){return new(e||m)(o.Sb(p))},m.\u0275cmp=o.Mb({type:m,selectors:[["cooper-bot-chat"]],features:[o.Db([p])],decls:4,vars:3,consts:[["title","Cooper"],[3,"message","reply","sender","date","avatar",4,"ngFor","ngForOf"],[3,"send"],[3,"message","reply","sender","date","avatar"]],template:function(e,t){1&e&&(o.Yb(0,"nb-chat",0),o.Bc(1,y,1,5,"nb-chat-message",1),o.jc(2,"async"),o.Yb(3,"nb-chat-form",2),o.gc("send",(function(e){return t.sendMessage(e)})),o.Xb(),o.Xb()),2&e&&(o.Eb(1),o.oc("ngForOf",o.kc(2,1,t.messages)))},directives:[v.a,i.l,v.b,v.c],pipes:[i.b],encapsulation:2,changeDetection:0}),m),w=[{path:"",redirectTo:"bot",pathMatch:"full"},{path:"bot",component:(g=function e(){_classCallCheck(this,e)},g.\u0275fac=function(e){return new(e||g)},g.\u0275cmp=o.Mb({type:g,selectors:[["cooper-bot"]],decls:1,vars:0,template:function(e,t){1&e&&o.Tb(0,"cooper-bot-chat")},directives:[_],styles:["nb-layout{height:100%!important;width:100%!important}  .layout{min-height:0!important;background-color:inherit!important}  nb-layout-column{padding:0!important}  .columns,   .content,   .layout,   .scrollable-container,   nb-layout-column{height:inherit!important;width:inherit!important}"]}),g)}],x=((k=function e(){_classCallCheck(this,e)}).\u0275mod=o.Qb({type:k}),k.\u0275inj=o.Pb({factory:function(e){return new(e||k)},imports:[[a.h.forChild(w)],a.h]}),k),C=((b=function e(){_classCallCheck(this,e)}).\u0275mod=o.Qb({type:b}),b.\u0275inj=o.Pb({factory:function(e){return new(e||b)},imports:[[i.c,s.a,x]]}),b)},JId3:function(e,t,n){var r,i,s=n("gm/K"),a=n("1ppQ"),o=0,u=0;e.exports=function(e,t,n){var c=t&&n||0,l=t||[],d=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==f){var h=s();null==d&&(d=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==f&&(f=i=16383&(h[6]<<8|h[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:u+1,y=p-o+(v-u)/1e4;if(y<0&&void 0===e.clockseq&&(f=f+1&16383),(y<0||p>o)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=p,u=v,i=f;var m=(1e4*(268435455&(p+=122192928e5))+v)%4294967296;l[c++]=m>>>24&255,l[c++]=m>>>16&255,l[c++]=m>>>8&255,l[c++]=255&m;var g=p/4294967296*1e4&268435455;l[c++]=g>>>8&255,l[c++]=255&g,l[c++]=g>>>24&15|16,l[c++]=g>>>16&255,l[c++]=f>>>8|128,l[c++]=255&f;for(var b=0;b<6;++b)l[c+b]=d[b];return t||a(l)}},Jn7W:function(e,t,n){"use strict";var r=n("hR4s"),i=n("rFq9"),s=n("UwCj"),a=n("ObEa"),o=n("eD9m")("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:r[e];a&&t&&!t[o]&&s.f(t,o,{configurable:!0,get:function(){return this}})}},Jo0e:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},KBpo:function(e,t,n){var r=n("6XaB"),i=n("NkxH");e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[s+o]=a[o];return t||i(a)}},KIy9:function(e,t,n){var r=n("M25K"),i=n("qiY+");e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},KQtV:function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}},Kc1g:function(e,t,n){var r=n("vbc5");e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},KnMe:function(e,t,n){var r=n("UwCj").f,i=n("YVtA"),s=n("eD9m")("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,s)&&r(e,s,{configurable:!0,value:t})}},L760:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Paginator=function(){function e(t,n,r,i){_classCallCheck(this,e),this.prevToken=r,this.nextToken=i,this.items=t,this.source=n}var t,n;return _createClass(e,[{key:"nextPage",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasNextPage){e.next=2;break}throw new Error("No next page");case 2:return e.abrupt("return",this.source(this.nextToken));case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"prevPage",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasPrevPage){e.next=2;break}throw new Error("No previous page");case 2:return e.abrupt("return",this.source(this.prevToken));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}}]),e}()},LBb3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Sqfg"),i=n("sc67"),s=n("LYxL"),a=n("qXWz"),o=n("F8DB");function u(e){if(e.body&&e.body.message)return e.body.message;switch(e.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function c(e){return e.body?e.body.code:0}function l(e){return 409===e.status?new i.SyncNetworkError(u(e),e.status,c(e),e.body):e.status?new i.SyncError(u(e),e.status,c(e)):e instanceof o.TransportUnavailableError?e:new i.SyncError(e.message,0,0)}t.NetworkService=function(){function e(t,n,r){_classCallCheck(this,e),this.clientInfo=t,this.config=n,this.transport=r}return _createClass(e,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+r.v4().replace(/-/g,"")}}},{key:"backoffConfig",value:function(){return Object.assign({min:4e3,max:6e4,maxAttemptsTime:9e4,randomness:.2},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(r,i){var s=[502,503,504];n&&s.push(429);var o=new a.Retrier(t.backoffConfig());o.on("attempt",(function(){e().then((function(e){return o.succeeded(e)})).catch((function(e){if(s.includes(e.status)){var t=parseInt(e.headers?e.headers["Retry-After"]:null);o.failed(l(e),isNaN(t)?null:1e3*t)}else"Twilsock disconnected"===e.message?o.failed(l(e)):(o.removeAllListeners(),o.cancel(),i(l(e)))}))})),o.on("succeeded",(function(e){r(e)})),o.on("cancelled",(function(e){return i(l(e))})),o.on("failed",(function(e){return i(l(e))})),o.start()}))}},{key:"get",value:function(e){var t=this,n=this.createHeaders();return s.default.debug("GET",e,"ID:",n["Twilio-Request-Id"]),this.executeWithRetry((function(){return t.transport.get(e,n)}),!0)}},{key:"post",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.createHeaders();return null!=n&&(a["If-Match"]=n),s.default.debug("POST",e,"ID:",a["Twilio-Request-Id"]),this.executeWithRetry((function(){return r.transport.post(e,a,t)}),i)}},{key:"put",value:function(e,t,n){var r=this,i=this.createHeaders();return null!=n&&(i["If-Match"]=n),s.default.debug("PUT",e,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry((function(){return r.transport.put(e,i,t)}),!1)}},{key:"delete",value:function(e){var t=this,n=this.createHeaders();return s.default.debug("DELETE",e,"ID:",n["Twilio-Request-Id"]),this.executeWithRetry((function(){return t.transport.delete(e,n)}),!1)}}]),e}()},LMaB:function(e,t,n){e.exports=!n("ObEa")&&!n("7S/a")((function(){return 7!=Object.defineProperty(n("1bLK")("div"),"a",{get:function(){return 7}}).a}))},LQEr:function(e,t,n){var r=n("IFjL");r(r.S,"Number",{isInteger:n("mrFV")})},LVtF:function(e,t,n){"use strict";var r=d(n("tgXR")),i=d(n("IhEH")),s=d(n("u2rs")),a=d(n("Rhu4")),o=d(n("aq5/")),u=d(n("4Mt5")),c=d(n("7xyS")),l=d(n("k2Qk"));function d(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var f=n("r2q8"),h=n("0tlO"),p=n("MHYR"),v=function(e){function t(e){(0,o.default)(this,t);var n=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return n.services=e,n.fifoStack=[],n.fifoStackMaxLength=100,n.myself=new h.User(null,null,n.services),n.myself.on("updated",(function(e){return n.emit("userUpdated",e)})),n.myself.on("userSubscribed",(function(){return n.emit("userSubscribed",n.myself)})),n.myself.on("userUnsubscribed",(function(){n.emit("userUnsubscribed",n.myself),n.myself._ensureFetched()})),n.services=e,n.subscribedUsers=new s.default,n.userDescriptorsPromise=n.services.session.getSessionLinks().then((function(e){return n.userDescriptors=new p.UserDescriptors({users:n,network:n.services.network},e.usersUrl),n.userDescriptors})),n.services.session.getMaxUserInfosToSubscribe().then((function(e){n.fifoStackMaxLength=e})),n.services.session.getUsersData().then((function(e){return n.myself.identity=e.identity,n.myself.entityName=e.user,n.myself._ensureFetched()})),n}var n,d,f,v;return(0,l.default)(t,e),(0,u.default)(t,[{key:"handleUnsubscribeUser",value:function(e){this.subscribedUsers.has(e.identity)&&this.subscribedUsers.delete(e.identity);var t=-1;this.fifoStack.find((function(n,r){return n==e.identity&&(t=r,!0)}))&&this.fifoStack.splice(t,1),this.emit("userUnsubscribed",e)}},{key:"handleSubscribeUser",value:function(e){this.subscribedUsers.has(e.identity)||(this.fifoStack.length>=this.fifoStackMaxLength&&this.subscribedUsers.get(this.fifoStack.shift()).unsubscribe(),this.fifoStack.push(e.identity),this.subscribedUsers.set(e.identity,e),this.emit("userSubscribed",e))}},{key:"getUser",value:(v=(0,i.default)(r.default.mark((function e(t){var n,i=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.getUsersData();case 2:return e.next=4,this.myself._ensureFetched();case 4:if(t!=this.myself.identity){e.next=6;break}return e.abrupt("return",this.myself);case 6:if(n=this.subscribedUsers.get(t)){e.next=19;break}if(s){e.next=13;break}return e.next=11,this.getUserDescriptor(t);case 11:s=e.sent._getDescriptor().sync_unique_name;case 13:return(n=new h.User(t,s,this.services)).on("updated",(function(e){return i.emit("userUpdated",e)})),n.on("userSubscribed",(function(){return i.handleSubscribeUser(n)})),n.on("userUnsubscribed",(function(){return i.handleUnsubscribeUser(n)})),e.next=19,n._ensureFetched();case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"getUserDescriptor",value:(f=(0,i.default)(r.default.mark((function e(t){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.userDescriptorsPromise;case 2:return e.abrupt("return",this.userDescriptors.getUserDescriptor(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"getChannelUserDescriptors",value:(d=(0,i.default)(r.default.mark((function e(t){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.userDescriptorsPromise;case 2:return e.abrupt("return",this.userDescriptors.getChannelUserDescriptors(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getSubscribedUsers",value:(n=(0,i.default)(r.default.mark((function e(){var t;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.getUsersData();case 2:return e.next=4,this.myself._ensureFetched();case 4:return t=[this.myself],this.subscribedUsers.forEach((function(e){return t.push(e)})),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}]),t}(f.EventEmitter);t.Users=v},LYxL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XdyU");function i(e,t){return["".concat((new Date).toISOString()," Sync ").concat(e,":")].concat(Array.from(t))}t.default={setLevel:function(e){r.setLevel(e)},trace:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.trace.apply(null,i("T",t))},debug:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.debug.apply(null,i("D",t))},info:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.info.apply(null,i("I",t))},warn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.warn.apply(null,i("W",t))},error:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.error.apply(null,i("E",t))}}},Lwwr:function(e,t,n){n("zjhQ")("Map")},M25K:function(e,t,n){var r=n("e7fL"),i=n("eD9m")("toStringTag"),s="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=Object(e),i))?n:s?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},MAsh:function(e,t,n){"use strict";var r=o(n("tgXR")),i=o(n("IhEH")),s=o(n("aq5/")),a=o(n("4Mt5"));function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n("RtQP"),c=n("ZYEu"),l=n("XXPQ"),d=function(){function e(t){(0,s.default)(this,e),this.services=t}var t;return(0,a.default)(e,[{key:"getPage",value:(t=(0,i.default)(r.default.mark((function e(t){var n,i,s=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},e.next=3,this.services.session.getSessionLinks();case 3:return n=new u.UriBuilder(e.sent.syncListUrl).arg("PageToken",t.pageToken).build(),e.next=7,this.services.network.get(n);case 7:return e.abrupt("return",new c.RestPaginator((i=e.sent).body.channels.map((function(e){return new l.SyncListDescriptor(e)})),(function(e){return s.getPage({pageToken:e})}),i.body.meta.previous_token,i.body.meta.next_token));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.SyncList=d},MC8q:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("r2q8"),i=n("bDMy"),s=n("N8HJ"),a=n("FukD"),o=n("MmGm"),u=n("gSK9"),c=n("yWtm");t.Response=function(){return function e(){_classCallCheck(this,e)}}();var l=function(e){_inherits(l,e);var t,n,r=_createSuper(l);function l(e,t,n){var a;return _classCallCheck(this,l),(a=r.call(this)).terminalStates=["disconnected","rejected"],a.lastEmittedState=void 0,a.tokenExpiredSasCode=20104,a.websocket=e,a.websocket.on("connected",(function(){return a.fsm.socketConnected()})),a.websocket.on("disconnected",(function(e){return a.fsm.socketClosed()})),a.websocket.on("message",(function(e){return a.onIncomingMessage(e)})),a.websocket.on("socketError",(function(e){return a.emit("connectionError",{terminal:!1,message:e.message,httpStatusCode:null,errorCode:null})})),a.transport=t,a.config=n,a.retrier=new c.BackoffRetrier(n.retryPolicy),a.retrier.on("attempt",(function(){return a.retry()})),a.retrier.on("failed",(function(e){s.log.warn("Retrying failed: ".concat(e.message)),a.disconnect()})),"undefined"!=typeof window&&void 0!==window.addEventListener&&(window.addEventListener("online",(function(){s.log.debug("Browser reported connectivity state: online"),a.fsm.systemOnline()})),window.addEventListener("offline",(function(){s.log.debug("Browser reported connectivity state: offline"),a.websocket.close(),a.fsm.socketClosed()}))),a.fsm=new i({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:function(){a.setupSocket(),a.emit("connecting")},onEnterInitialising:function(){a.sendInit()},onLeaveInitialising:function(){a.cancelInit()},onEnterUpdating:function(){a.sendUpdate()},onLeaveUpdating:function(){a.cancelUpdate()},onEnterRetrying:function(){a.initRetry(),a.emit("connecting")},onEnterConnected:function(){a.resetBackoff(),a.onConnected()},onUserUpdateToken:function(){a.resetBackoff()},onTokenRejected:function(){a.resetBackoff(),a.closeSocket(!0),a.finalizeSocket()},onUserDisconnect:function(){a.closeSocket(!0)},onEnterDisconnecting:function(){a.startDisconnectTimer()},onLeaveDisconnecting:function(){a.cancelDisconnectTimer()},onEnterWaitSocketClosed:function(){a.startDisconnectTimer()},onLeaveWaitSocketClosed:function(){a.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:function(){a.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:function(){a.cancelDisconnectTimer()},onDisconnected:function(){a.resetBackoff(),a.finalizeSocket()},onReceiveClose:function(e,t){a.onCloseReceived(t)},onReceiveOffload:function(e,t){s.log.debug("onreceiveoffload: ",t),a.modifyBackoff(t.body),a.onCloseReceived(t.status)},onUnsupported:function(){a.closeSocket(!0),a.finalizeSocket()},onError:function(e,t){a.closeSocket(t),a.finalizeSocket()},onEnterState:function(e){"none"!==e.from&&a.changeState(e)},onInvalidTransition:function(e,t,n){s.log.warn("FSM: unexpected transition",t,n)}}}),a}return _createClass(l,[{key:"changeState",value:function(e){s.log.debug("FSM: ".concat(e.transition,": ").concat(e.from," --\x3e ").concat(e.to)),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}},{key:"resetBackoff",value:function(){s.log.trace("resetBackoff"),this.retrier.stop()}},{key:"modifyBackoff",value:function(e){s.log.trace("modifyBackoff",e);var t=e?e.backoff_policy:null;t&&"number"==typeof t.reconnect_min_ms&&this.retrier.modifyBackoff(t.reconnect_min_ms)}},{key:"startDisconnectTimer",value:function(){var e=this;s.log.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout((function(){s.log.debug("disconnecting is timed out"),e.closeSocket(!0)}),3e3)}},{key:"cancelDisconnectTimer",value:function(){s.log.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}},{key:"initRetry",value:function(){s.log.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}},{key:"retry",value:function(){"connecting"!=this.fsm.state?(s.log.trace("retry"),this.websocket.close(),this.fsm.userRetry()):s.log.trace("can\t retry as already connecting")}},{key:"onConnected",value:function(){this.emit("connected")}},{key:"finalizeSocket",value:function(){s.log.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}},{key:"setupSocket",value:function(){s.log.trace("setupSocket:",this.config.token),this.websocket.connect()}},{key:"onIncomingMessage",value:function(e){var t=o.Parser.parse(e),n=t.method,r=t.header,i=t.payload;if("reply"!==n&&this.confirmReceiving(r),"notification"===n)this.emit("message",r.message_type,i);else if("reply"===r.method)this.transport.processReply({id:r.id,status:r.status,header:r,body:i});else if("client_update"===r.method)"token_about_to_expire"===r.client_update_type&&this.emit("tokenAboutToExpire");else if("close"===r.method)if(308===r.status.code)s.log.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:r.status.status,body:i});else if(406===r.status.code){var a="Server closed connection because can't parse protocol: ".concat(JSON.stringify(r.status));this.emitReplyConnectionError(a,r,!0),s.log.error(a),this.fsm.receiveFatalClose()}else 417===r.status.code?(s.log.error("Server closed connection because can't parse client reply: ".concat(JSON.stringify(r.status))),this.fsm.receiveFatalClose(r.status.status)):410===r.status.code?(s.log.warn("Server closed connection: ".concat(JSON.stringify(r.status))),this.fsm.receiveClose(r.status.status),this.emit("tokenExpired")):401===r.status.code?(s.log.error("Server closed connection: ".concat(JSON.stringify(r.status))),this.fsm.receiveClose(r.status.status)):(s.log.warn("unexpected message: ",r.status),this.fsm.receiveOffload({status:r.status.status,body:null}))}},{key:"sendInit",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.log.trace("sendInit"),e.prev=1,e.next=4,this.transport.sendInit();case 4:t=e.sent,this.config.updateContinuationToken(t.continuationToken),this.fsm.initSuccess(t),this.emit("initialized",t),this.emit("tokenUpdated"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),e.t0 instanceof u.TwilsockReplyError?(n=!1,s.log.warn("Init rejected by server: ".concat(JSON.stringify(e.t0.reply.status))),401===e.t0.reply.status.code||403===e.t0.reply.status.code?(n=!0,this.fsm.tokenRejected(e.t0.reply.status),e.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):429===e.t0.reply.status.code?(this.modifyBackoff(e.t0.reply.body),this.fsm.initError(!0)):this.fsm.initError(500!==e.t0.reply.status.code),this.emitReplyConnectionError(e.t0.message,e.t0.reply,n)):(this.emit("connectionError",{terminal:!0,message:e.t0.message,httpStatusCode:null,errorCode:null}),this.fsm.initError(!0)),this.emit("tokenUpdated",e.t0);case 12:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(){return n.apply(this,arguments)})},{key:"sendUpdate",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.log.trace("sendUpdate"),t=new a.Update(this.config.token),e.prev=2,e.next=5,this.transport.sendWithReply(t);case 5:n=e.sent,this.fsm.updateSuccess(n.body),this.emit("tokenUpdated"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),e.t0 instanceof u.TwilsockReplyError?(r=!1,s.log.warn("Token update rejected by server: ".concat(JSON.stringify(e.t0.reply.status))),401===e.t0.reply.status.code||403===e.t0.reply.status.code?(r=!0,this.fsm.tokenRejected(e.t0.reply.status),e.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):429===e.t0.reply.status.code?(this.modifyBackoff(e.t0.reply.body),this.fsm.updateError(e.t0.reply.status)):this.fsm.updateError(e.t0.reply.status),this.emitReplyConnectionError(e.t0.message,e.t0.reply,r)):(this.emit("error",!1,e.t0.message,null,null),this.fsm.updateError(e.t0)),this.emit("tokenUpdated",e.t0);case 13:case"end":return e.stop()}}),e,this,[[2,9]])}))),function(){return t.apply(this,arguments)})},{key:"emitReplyConnectionError",value:function(e,t,n){this.emit("connectionError",{terminal:n,message:t.status&&t.status.description?t.status.description:e,httpStatusCode:t.status.code,errorCode:t.status&&t.status.errorCode?t.status.errorCode:null})}},{key:"cancelInit",value:function(){s.log.trace("cancelInit")}},{key:"cancelUpdate",value:function(){s.log.trace("cancelUpdate")}},{key:"confirmReceiving",value:function(e){s.log.trace("confirmReceiving");try{this.transport.send(new a.Reply(e.id))}catch(t){s.log.debug("failed to confirm packet receiving",t)}}},{key:"closeSocket",value:function(e){var t=this;s.log.trace("closeSocket (graceful: ".concat(e,")")),e&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),setTimeout((function(){return t.fsm.socketClosed()}),0)}},{key:"connect",value:function(){s.log.trace("connect"),this.fsm.userConnect()}},{key:"disconnect",value:function(){var e=this;return s.log.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise((function(t){e.disconnectedPromiseResolve=t,e.fsm.userDisconnect()}))}},{key:"updateToken",value:function(e){var t=this;return s.log.trace("updateToken:",e),new Promise((function(e,n){t.once("tokenUpdated",(function(t){t?n(t):e()})),t.fsm.userUpdateToken()}))}},{key:"onCloseReceived",value:function(e){this.websocket.close()}},{key:"isConnected",get:function(){return"connected"===this.state&&this.websocket.isConnected}},{key:"state",get:function(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"rejected";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}},{key:"isTerminalState",get:function(){return-1!==this.terminalStates.indexOf(this.fsm.state)}}]),l}(r.EventEmitter);t.TwilsockChannel=l,t.TwilsockImpl=l},MHYR:function(e,t,n){"use strict";var r=o(n("tgXR")),i=o(n("IhEH")),s=o(n("aq5/")),a=o(n("4Mt5"));function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n("RtQP"),c=n("ZYEu"),l=n("Yquk"),d=function(){function e(t,n){(0,s.default)(this,e),this.services=t,this.url=n}var t,n;return(0,a.default)(e,[{key:"getUserDescriptor",value:(n=(0,i.default)(r.default.mark((function e(t){var n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new u.UriBuilder(this.url).path(t).build(),e.next=3,this.services.network.get(n);case 3:return e.abrupt("return",new l.UserDescriptor(this.services,e.sent.body));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getChannelUserDescriptors",value:(t=(0,i.default)(r.default.mark((function e(t){var n,i,s=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new u.UriBuilder(this.url).arg("ChannelSid",t).arg("PageToken",a.pageToken).build(),e.next=3,this.services.network.get(n);case 3:return e.abrupt("return",new c.RestPaginator((i=e.sent).body.users.map((function(e){return new l.UserDescriptor(s.services,e)})),(function(e){return s.getChannelUserDescriptors(t,{pageToken:e})}),i.body.meta.prev_token,i.body.meta.next_token));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.UserDescriptors=d},MIMp:function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},"MNq/":function(e,t,n){n("iaOj")("Set")},MPuG:function(e,t,n){var r=n("Jo0e"),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},MRQX:function(e,t,n){n("nNrO"),e.exports=n("rFq9").Reflect.construct},MmGm:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("N8HJ");function i(e){return encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})).length}function s(e){var t=Array.prototype.map.call(e,(function(e){return String.fromCharCode(e)})).join("").replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}));return decodeURIComponent(t)}function a(e){return JSON.parse(s(e))}t.Parser=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"parse",value:function(e){var t=new Uint8Array(e),n=function(e){for(var t="",n=0;n<e.length;++n){var r=String.fromCharCode(e[n]);if(t+=r,"\r"===r){n+=2;break}}var i=t.split(" ");return{size:n,protocol:i[0],version:i[1],headerSize:Number(i[2])}}(t);if("TWILSOCK"===n.protocol&&"V3.0"===n.version){var i=null;try{i=a(t.subarray(n.size,n.size+n.headerSize))}catch(l){return void r.log.error("failed to parse message header",l,e)}r.log.debug("message received: ",i.method),r.log.trace("message received: ",i);var o=null;if(i.payload_size>0){var u=2+n.size+n.headerSize,c=i.payload_size;if(i.hasOwnProperty("payload_type")&&0!==i.payload_type.indexOf("application/json"))0===i.payload_type.indexOf("text/plain")&&(o=s(t.subarray(u,u+c)));else try{o=a(t.subarray(u,u+c))}catch(l){return void r.log.error("failed to parse message body",l,e)}}return{method:i.method,header:i,payload:o}}r.log.error("unsupported protocol: ".concat(n.protocol," ver ").concat(n.version))}},{key:"createPacket",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.payload_size=i(t);var n,s,a,o=JSON.stringify(e)+"\r\n",u="TWILSOCK V3.0 "+(i(o)-2)+"\r\n";return r.log.debug("send request:",u+o+t),(n=u+o+t,s=encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})),a=new Uint8Array(s.length),Array.prototype.forEach.call(s,(function(e,t){a[t]=e.charCodeAt(0)})),a).buffer}}]),e}()},MrWc:function(e,t,n){var r=n("rU52");e.exports=function(e){return Object(r(e))}},MuMv:function(e,t,n){"use strict";var r=p(n("XUND")),i=p(n("tgXR")),s=p(n("qCKU")),a=p(n("IhEH")),o=p(n("kGNy")),u=p(n("u2rs")),c=p(n("Rhu4")),l=p(n("aq5/")),d=p(n("4Mt5")),f=p(n("7xyS")),h=p(n("k2Qk"));function p(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var v=n("r2q8"),y=n("CPx3"),m=n("cDQD");t.Channel=m.Channel;var g=n("9F0I"),b=n("RtQP"),k=y.Logger.scope("Channels"),_=function(e){function t(e){(0,l.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,c.default)(t)).call(this));return n.services=e,n.channels=new u.default,n.thumbstones=new o.default,n.syncListFetched=!1,n.syncListRead=new g.Deferred,n}var n;return(0,h.default)(t,e),(0,d.default)(t,[{key:"getMap",value:function(){var e=this;return this.services.session.getMyChannelsId().then((function(t){return e.services.syncClient.map({id:t,mode:"open_existing"})}))}},{key:"addChannel",value:(n=(0,a.default)(i.default.mark((function e(t){var n,r,a,o,u,c;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=void 0,null!==(n=void 0===t.attributes?{}:t.attributes)){e.next=4;break}throw new Error("Attributes can't be null");case 4:if(n.constructor===Object){e.next=6;break}throw new Error("Attributes must be a valid JSON object");case 6:return e.next=8,this.services.session.addCommand("createChannel",{friendlyName:t.friendlyName,uniqueName:t.uniqueName,type:t.isPrivate?"private":"public",attributes:(0,s.default)(n)});case 8:if(o="channel"in(r=e.sent)?r.channel:null,!(u=this.channels.get(a="channelSid"in r?r.channelSid:null))){e.next=16;break}return e.next=15,u._subscribe();case 15:return e.abrupt("return",u);case 16:return c=new m.Channel(this.services,{channel:o,entityName:null,uniqueName:null,attributes:null,createdBy:null,friendlyName:null,lastConsumedMessageIndex:null,type:t.isPrivate?"private":"public",dateCreated:null,dateUpdated:null},a),this.channels.set(c.sid,c),this.registerForEvents(c),e.next=21,c._subscribe();case 21:return this.emit("channelAdded",c),e.abrupt("return",c);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"fetchChannels",value:function(){var e,t=this;this.getMap().then((e=(0,a.default)(i.default.mark((function e(n){var s,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.on("itemAdded",(function(e){k.debug("itemAdded: "+e.item.key),t.upsertChannel("sync",e.item.key,e.item.value)})),n.on("itemRemoved",(function(e){k.debug("itemRemoved: "+e.key);var n=e.key;t.syncListFetched||t.thumbstones.add(n);var r=t.channels.get(n);r&&("joined"!==r.status&&"invited"!==r.status||(r._setStatus("known","sync"),t.emit("channelLeft",r)),r.isPrivate&&(t.channels.delete(n),t.emit("channelRemoved",r),r.emit("removed",r)))})),n.on("itemUpdated",(function(e){k.debug("itemUpdated: "+e.item.key),t.upsertChannel("sync",e.item.key,e.item.value)})),s=[],e.next=6,t.services.syncList.getPage();case 6:(a=e.sent).items.forEach((function(e){s.push(t.upsertChannel("synclist",e.channel_sid,e))}));case 9:if(!a.hasNextPage){e.next=16;break}return e.next=12,a.nextPage();case 12:(a=e.sent).items.forEach((function(e){s.push(t.upsertChannel("synclist",e.channel_sid,e))})),e.next=9;break;case 16:return t.syncListRead.set(!0),e.abrupt("return",r.default.all(s));case 18:case"end":return e.stop()}}),e,t)}))),function(t){return e.apply(this,arguments)})).then((function(){t.syncListFetched=!0,t.thumbstones.clear(),k.debug("Channels list fetched")})).then((function(){return t})).catch((function(e){throw"disconnected"!=t.services.syncClient.connectionState&&k.error("Failed to get channels list",e),k.debug("ERROR: Failed to get channels list",e),e}))}},{key:"_wrapPaginator",value:function(e,t){var n=this;return t(e.items).then((function(r){return{items:r,hasNextPage:e.hasNextPage,hasPrevPage:e.hasPrevPage,nextPage:function(){return e.nextPage().then((function(e){return n._wrapPaginator(e,t)}))},prevPage:function(){return e.prevPage().then((function(e){return n._wrapPaginator(e,t)}))}}}))}},{key:"getChannels",value:function(e){var t=this;return this.getMap().then((function(t){return t.getItems(e)})).then((function(e){return t._wrapPaginator(e,(function(e){return r.default.all(e.map((function(e){return t.upsertChannel("sync",e.key,e.value)})))}))}))}},{key:"getChannel",value:function(e){var t=this;return this.getMap().then((function(t){return t.getItems({key:e})})).then((function(e){return e.items.map((function(e){return t.upsertChannel("sync",e.key,e.value)}))})).then((function(e){return e.length>0?e[0]:null}))}},{key:"pushChannel",value:function(e){var t=e.sid;return this.upsertChannel("chat",t,{entityName:null,lastConsumedMessageIndex:e.lastConsumedMessageIndex,type:e.type,status:e.status,friendlyName:e.friendlyName,dateUpdated:e.dateUpdated,dateCreated:e.dateCreated,uniqueName:e.uniqueName,createdBy:e.createdBy,attributes:e.attributes,channel:e.channel,notificationLevel:e.notificationLevel,sid:t})}},{key:"upsertChannel",value:function(e,t,n){var r=this;k.trace("upsertChannel(sid="+t+", data=",n);var i=this.channels.get(t);if(i){if(k.trace("upsertChannel: channel "+t+" is known and it's status is known from source "+i._statusSource()+" and update came from source "+e,i),void 0===i._statusSource()||e===i._statusSource()||"synclist"===e&&"sync"!==i._statusSource()||"sync"===e)if("joined"===n.status&&"joined"!==i.status){i._setStatus("joined",e);var s={};void 0!==n.notificationLevel&&(s.notificationLevel=n.notificationLevel),void 0!==n.lastConsumedMessageIndex&&(s.lastConsumedMessageIndex=n.lastConsumedMessageIndex),b.isDeepEqual(s,{})||i._update(s),i._subscribe().then((function(){r.emit("channelJoined",i)}))}else if("invited"===n.status&&"invited"!==i.status){i._setStatus("invited",e);var a={};void 0!==n.notificationLevel&&(a.notificationLevel=n.notificationLevel),void 0!==n.lastConsumedMessageIndex&&(a.lastConsumedMessageIndex=n.lastConsumedMessageIndex),b.isDeepEqual(a,{})||i._update(a),i._subscribe().then((function(){r.emit("channelInvited",i)}))}else"known"!==n.status||"invited"!==i.status&&"joined"!==i.status?"notParticipating"!==n.status&&"known"!==n.status||"private"!==n.type?i._update(n):i._subscribe():(i._setStatus("known",e),i._update(n),i._subscribe().then((function(){r.emit("channelLeft",i)})));else k.trace("upsertChannel: channel is known from sync and came from chat, ignoring",{sid:t,data:n.status,channel:i.status});return i._subscribe().then((function(){return i}))}if("chat"!==e&&"synclist"!==e||!this.thumbstones.has(t))return k.trace("upsertChannel: creating local channel object with sid "+t,n),i=new m.Channel(this.services,n,t),this.channels.set(t,i),i._subscribe().then((function(){return r.registerForEvents(i),r.emit("channelAdded",i),"joined"===n.status?(i._setStatus("joined",e),r.emit("channelJoined",i)):"invited"===n.status&&(i._setStatus("invited",e),r.emit("channelInvited",i)),i}));k.trace("upsertChannel: channel is deleted and came again from chat, ignoring",t)}},{key:"onChannelRemoved",value:function(e){var t=this.channels.get(e);t&&(this.channels.delete(e),this.emit("channelRemoved",t))}},{key:"registerForEvents",value:function(e){var t=this;e.on("removed",(function(){return t.onChannelRemoved(e.sid)})),e.on("updated",(function(e){return t.emit("channelUpdated",e)})),e.on("memberJoined",this.emit.bind(this,"memberJoined")),e.on("memberLeft",this.emit.bind(this,"memberLeft")),e.on("memberUpdated",(function(e){return t.emit("memberUpdated",e)})),e.on("messageAdded",this.emit.bind(this,"messageAdded")),e.on("messageUpdated",(function(e){return t.emit("messageUpdated",e)})),e.on("messageRemoved",this.emit.bind(this,"messageRemoved")),e.on("typingStarted",this.emit.bind(this,"typingStarted")),e.on("typingEnded",this.emit.bind(this,"typingEnded"))}}]),t}(v.EventEmitter);t.Channels=_},N8HJ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XdyU");function i(e,t){return["".concat((new Date).toISOString()," Twilsock ").concat(e,":")].concat(Array.from(t))}var s=function(){function e(t){_classCallCheck(this,e),this.prefix="",this.prefix=null!=t&&t.length>0?" "+t+":":""}return _createClass(e,[{key:"setLevel",value:function(e){r.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.debug.apply(null,i("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.debug.apply(null,i("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.info.apply(null,i("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.warn.apply(null,i("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.error.apply(null,i("E",t))}}],[{key:"setLevel",value:function(e){r.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.trace.apply(null,i("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.debug.apply(null,i("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.info.apply(null,i("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.warn.apply(null,i("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.error.apply(null,i("E",t))}}]),e}();t.Logger=s;var a=new s("");t.log=a},NkxH:function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}},O3kU:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("N8HJ"),i=n("SbVi"),s=n("oi0w"),a=n("FukD"),o=n("F8DB");function u(e,t){var n=function(e){var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(t){var n={protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7],params:null};if(n.search.length>0){var r=n.search.substring(1);n.params=r.split("&").map((function(e){return e.split("=")})).reduce((function(e,t){return e.hasOwnProperty(t[0])?Array.isArray(e[t[0]])?e[t[0]].push(t[1]):e[t[0]]=[e[t[0]],t[1]]:e[t[0]]=t[1],e}),{})}return n}throw new i.TwilsockError("Incorrect URI: "+e)}(t),r={method:e,host:n.host,path:n.pathname};return n.params&&(r.params=n.params),r}t.Upstream=function(){function e(t,n,r){_classCallCheck(this,e),this.config=r,this.transport=t,this.pendingMessages=[],this.twilsock=n}var t;return _createClass(e,[{key:"saveMessage",value:function(e){var t=this;return new Promise((function(n,s){var a={message:e,resolve:n,reject:s,alreadyRejected:!1,timeout:setTimeout((function(){r.log.debug("request is timed out"),s(new i.TwilsockError("Twilsock: request timeout")),a.alreadyRejected=!0}),2e4)};t.pendingMessages.push(a)}))}},{key:"sendPendingMessages",value:function(){for(var e=this,t=function(){var t=e.pendingMessages[0];if(!t.alreadyRejected)try{e.actualSend(t.message).then((function(e){return t.resolve(e)})).catch((function(e){return t.reject(e)})),clearTimeout(t.timeout)}catch(n){return r.log.debug("Failed to send pending message",n),"break"}e.pendingMessages.splice(0,1)};this.pendingMessages.length;){if("break"===t())break}}},{key:"rejectPendingMessages",value:function(){this.pendingMessages.forEach((function(e){e.reject(new o.TransportUnavailableError("Can't connect to twilsock")),clearTimeout(e.timeout)})),this.pendingMessages.splice(0,this.pendingMessages.length)}},{key:"actualSend",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,o,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.to,r=t.headers,i=t.body,o=new a.Message(this.config.activeGrant,r["Content-Type"]||"application/json",{host:n.host,path:n.path,method:n.method,params:n.params,headers:r}),e.next=6,this.transport.sendWithReply(o,i);case 6:if(u=e.sent,!((l=u)&&l.header&&l.header.http_status)||(c=u.header.http_status.code)>=200&&c<300){e.next=9;break}throw new s.TwilsockUpstreamError(u.header.http_status.code,u.header.http_status.status,u.body);case 9:return e.abrupt("return",{status:u.header.http_status,headers:u.header.http_headers,body:u.body});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(this.twilsock.isTerminalState)return Promise.reject(new o.TransportUnavailableError("Can't connect to twilsock"));var i=function(e,t,n,r){return{to:u(e,t),headers:n,body:r}}(e,t,n,r);return this.twilsock.isConnected?this.actualSend(i):this.saveMessage(i)}}]),e}()},O95A:function(e,t,n){"use strict";var r=n("zCrM"),i=n("S5Zg");e.exports=n("HKkr")("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},ObEa:function(e,t,n){e.exports=!n("7S/a")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},OoA2:function(e,t,n){n("/zo1"),e.exports=n("rFq9").Object.setPrototypeOf},P0Gn:function(e,t,n){n("LQEr"),e.exports=n("rFq9").Number.isInteger},PfNy:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("ihyG"),i=n("sqYj"),s=n("E9sr");function a(e,t){var n=r.Pointer.fromJSON(t).evaluate(e);if(void 0!==n)return{op:"test",path:t,value:n.value}}t.applyPatch=function(e,t){return t.map((function(t){return i.apply(e,t)}))},t.createPatch=function(e,t,n){var i=new r.Pointer;return(n?function(e){return function t(n,r,i){var a=e(n,r,i);return Array.isArray(a)?a:s.diffAny(n,r,i,t)}}(n):s.diffAny)(e,t,i)},t.createTests=function(e,t){var n=new Array;return t.filter(s.isDestructive).forEach((function(t){var r=a(e,t.path);if(r&&n.push(r),"from"in t){var i=a(e,t.from);i&&n.push(i)}})),n}},PkSp:function(e,t,n){n("9YHp")("asyncIterator")},"QDM+":function(e,t,n){e.exports={default:n("xLJM"),__esModule:!0}},QdMa:function(e,t,n){var r=n("Hs7Z"),i=n("z7HR").f,s={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==s.call(e)?function(e){try{return i(e)}catch(t){return a.slice()}}(e):i(r(e))}},QvZc:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("llpV"),i=function(){function e(t,n){_classCallCheck(this,e),this.value=t,this.revision=n||0}return _createClass(e,[{key:"isValid",get:function(){return!0}}]),e}(),s=function(){function e(t){_classCallCheck(this,e),this.revision=t}return _createClass(e,[{key:"isValid",get:function(){return!1}}]),e}(),a=function(){function e(){_classCallCheck(this,e),this.items=new r.TreeMap}return _createClass(e,[{key:"store",value:function(e,t,n){var r=this.items.get(e);return r&&r.revision>n?r.isValid?r.value:null:(this.items.set(e,new i(t,n)),t)}},{key:"delete",value:function(e,t){var n=this.items.get(e);(!n||n.revision<t)&&this.items.set(e,new s(t))}},{key:"isKnown",value:function(e,t){var n=this.items.get(e);return n&&n.revision>=t}},{key:"get",value:function(e){var t=this.items.get(e);return t&&t.isValid?t.value:null}},{key:"has",value:function(e){var t=this.items.get(e);return t&&t.isValid}}]),e}();t.Cache=a,t.default=a},QwS4:function(e,t,n){var r=n("hR4s").navigator;e.exports=r&&r.userAgent||""},QyXE:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("qXWz"),i=n("s23o"),s=n("zaPo"),a=i.Logger.scope("Network");t.Network=function(){function e(t,n){_classCallCheck(this,e),this.config=t,this.transport=n}var t,n;return _createClass(e,[{key:"backoffConfig",value:function(){return Object.assign(s.Configuration.backoffConfigDefault,this.config.backoffConfigOverride)}},{key:"retryWhenThrottled",value:function(){return void 0!==this.config.retryWhenThrottledOverride?this.config.retryWhenThrottledOverride:void 0!==s.Configuration.retryWhenThrottledDefault&&s.Configuration.retryWhenThrottledDefault}},{key:"executeWithRetry",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(i,s){var a=[502,503,504];n&&a.push(429);var o=new r.Retrier(t.backoffConfig());o.on("attempt",(function(){e().then((function(e){return o.succeeded(e)})).catch((function(e){a.indexOf(e.status)>-1||"Twilsock disconnected"===e.message?o.failed(e):(o.removeAllListeners(),o.cancel(),s(e))}))})),o.on("succeeded",(function(e){i(e)})),o.on("cancelled",(function(e){return s(e)})),o.on("failed",(function(e){return s(e)})),o.start()}))}},{key:"get",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={"X-Twilio-Token":this.config.token},a.trace("sending GET request to ",t," headers ",n),e.next=4,this.executeWithRetry((function(){return i.transport.get(t,n)}),this.retryWhenThrottled());case 4:return r=e.sent,e.abrupt("return",(a.trace("response",r),r));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"post",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={"X-Twilio-Token":this.config.token},"undefined"!=typeof FormData&&n instanceof FormData||!r||Object.assign(s,{"Content-Type":r}),a.trace("sending POST request to ",t," headers ",s),e.prev=2,e.next=5,this.transport.post(t,s,n);case 5:i=e.sent,e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(2),e.t0 instanceof TypeError?(a.trace("got error in post response",e.t0),new TypeError("Posting FormData supported only with browser engine's FormData")):e.t0;case 11:return e.abrupt("return",(a.trace("response",i),i));case 12:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(e,n,r){return t.apply(this,arguments)})}]),e}()},R6fH:function(e,t,n){var r=n("M25K"),i=n("eD9m")("iterator"),s=n("tReM");e.exports=n("rFq9").isIterable=function(e){var t=Object(e);return void 0!==t[i]||"@@iterator"in t||s.hasOwnProperty(r(t))}},Rhu4:function(e,t,n){e.exports={default:n("uBMx"),__esModule:!0}},Rk1W:function(e,t,n){n("dUHx"),n("/r3m"),n("Fk9O"),n("O95A"),n("cvX4"),n("MNq/"),n("Ff16"),e.exports=n("rFq9").Set},RtQP:function(e,t,n){"use strict";var r=a(n("aq5/")),i=a(n("4Mt5")),s=a(n("qCKU"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("PfNy");t.isDeepEqual=function(e,t){return 0===o.createPatch(e,t).length},t.deepClone=function(e){return JSON.parse((0,s.default)(e))},t.parseToNumber=function(e){return void 0===e||isNaN(Number(e))?null:Number(e)},t.parseTime=function(e){try{return new Date(e)}catch(t){return null}},t.parseAttributes=function(e,t,n){var r={};if(e)try{r=JSON.parse(e)}catch(i){n.warn(t)}return r};var u=function(){function e(t){(0,r.default)(this,e),this.base=t.replace(/\/$/,""),this.args=[],this.paths=[]}return(0,i.default)(e,[{key:"arg",value:function(e,t){return void 0!==t&&this.args.push(encodeURIComponent(e)+"="+encodeURIComponent(t)),this}},{key:"path",value:function(e){return this.paths.push(encodeURIComponent(e)),this}},{key:"build",value:function(){var e=this.base;return this.paths.length&&(e+="/"+this.paths.join("/")),this.args.length&&(e+="?"+this.args.join("&")),e}}]),e}();t.UriBuilder=u},S49y:function(e,t,n){"use strict";var r=n("UtsQ"),i=n("IFjL"),s=n("Eolq"),a=n("b95h"),o=n("tReM"),u=n("zjfI"),c=n("KnMe"),l=n("ax0Y"),d=n("eD9m")("iterator"),f=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,p,v,y,m){u(n,t,p);var g,b,k,_=function(e){if(!f&&e in S)return S[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",x="values"==v,C=!1,S=e.prototype,T=S[d]||S["@@iterator"]||v&&S[v],R=T||_(v),M=v?x?_("entries"):R:void 0,E="Array"==t&&S.entries||T;if(E&&(k=l(E.call(new e)))!==Object.prototype&&k.next&&(c(k,w,!0),r||"function"==typeof k[d]||a(k,d,h)),x&&T&&"values"!==T.name&&(C=!0,R=function(){return T.call(this)}),r&&!m||!f&&!C&&S[d]||a(S,d,R),o[t]=R,o[w]=h,v)if(g={values:x?R:_("values"),keys:y?R:_("keys"),entries:M},m)for(b in g)b in S||s(S,b,g[b]);else i(i.P+i.F*(f||C),t,g);return g}},S5Zg:function(e,t,n){var r=n("vbc5");e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},S7IX:function(e,t,n){var r=n("Jo0e"),i=n("rU52");e.exports=function(e){return function(t,n){var s,a,o=String(i(t)),u=r(n),c=o.length;return u<0||u>=c?e?"":void 0:(s=o.charCodeAt(u))<55296||s>56319||u+1===c||(a=o.charCodeAt(u+1))<56320||a>57343?e?o.charAt(u):s:e?o.slice(u,u+2):a-56320+(s-55296<<10)+65536}}},SZul:function(e,t,n){n("iaOj")("Map")},SbVi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return n}();t.TwilsockError=r},SmK6:function(e,t,n){var r=n("8fQz"),i=n("Vzpu"),s=n("eD9m")("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[s])?t:i(n)}},Sqfg:function(e,t,n){var r=n("uXIA"),i=n("KBpo"),s=i;s.v1=r,s.v4=i,e.exports=s},TQPF:function(e,t,n){e.exports={default:n("IkCb"),__esModule:!0}},TjkB:function(e,t,n){n("IgrD"),e.exports=n("rFq9").Object.assign},TkJz:function(e,t,n){var r=n("3UoP"),i=n("jJPU"),s=i;s.v1=r,s.v4=i,e.exports=s},TkXn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.prototype.hasOwnProperty;t.clone=function e(t){if(null==t||"object"!=typeof t)return t;if(t.constructor==Array){for(var n=t.length,i=new Array(n),s=0;s<n;s++)i[s]=e(t[s]);return i}var a={};for(var o in t)r.call(t,o)&&(a[o]=e(t[o]));return a}},TkcT:function(e,t,n){"use strict";function r(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;if(_classCallCheck(this,n),i=t.call(this),r((e=e||{}).initialDelay)&&e.initialDelay<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(r(e.maxDelay)&&e.maxDelay<=1)throw new Error("The maximal timeout must be greater than 1.");if(r(e.randomisationFactor)&&(e.randomisationFactor<0||e.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");if(r(e.factor)&&e.factor<=1)throw new Error("Exponential factor should be greater than 1.");if(i.initialDelay=e.initialDelay||100,i.maxDelay=e.maxDelay||1e4,i.maxDelay<=i.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");return i.randomisationFactor=e.randomisationFactor||0,i.factor=e.factor||2,i.maxNumberOfRetry=-1,i.reset(),_possibleConstructorReturn(i)}return _createClass(n,[{key:"backoff",value:function(e){null==this.timeoutID&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",e),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,e)))}},{key:"reset",value:function(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,clearTimeout(this.timeoutID),this.timeoutID=null}},{key:"failAfter",value:function(e){if(e<=0)throw new Error("Expected a maximum number of retry greater than 0 but got ".concat(e));this.maxNumberOfRetry=e}},{key:"next",value:function(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;var e=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*e))}},{key:"onBackoff",value:function(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}],[{key:"exponential",value:function(e){return new n(e)}}]),n}(n("r2q8").EventEmitter);t.Backoff=i,t.default=i},ToDU:function(e,t,n){"use strict";var r=o(n("XUND")),i=o(n("u2rs")),s=o(n("aq5/")),a=o(n("4Mt5"));function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n("CPx3"),c=n("yDbV"),l=u.Logger.scope("TypingIndicator"),d=function(){function e(t,n,r){(0,s.default)(this,e),this.config=t,this.services=n,this.getChannel=r,this.serviceTypingTimeout=null,this.sentUpdates=new i.default}return(0,a.default)(e,[{key:"initialize",value:function(){var e=this;this.services.notificationClient.subscribe(c.NotificationTypes.TYPING_INDICATOR,"twilsock"),this.services.notificationClient.on("message",(function(t,n){t===c.NotificationTypes.TYPING_INDICATOR&&e.handleRemoteTyping(n)}))}},{key:"handleRemoteTyping",value:function(e){var t=this;l.trace("Got new typing indicator ",e),this.getChannel(e.channel_sid).then((function(n){n&&n.members.forEach((function(n){n.identity===e.identity&&n._startTyping(t.typingTimeout)}))})).catch((function(e){throw l.error(e),e}))}},{key:"send",value:function(e){var t=this.sentUpdates.get(e);return t&&t>Date.now()-this.typingTimeout?r.default.resolve():(this.sentUpdates.set(e,Date.now()),this._send(e))}},{key:"_send",value:function(e){var t=this;return l.trace("Sending typing indicator"),this.services.transport.post(this.config.typingIndicatorUri,{"Content-Type":"application/x-www-form-urlencoded"},"ChannelSid="+e).then((function(e){e.body.hasOwnProperty("typing_timeout")&&(t.serviceTypingTimeout=1e3*e.body.typing_timeout)})).catch((function(e){throw l.error("Failed to send typing indicator:",e),e}))}},{key:"typingTimeout",get:function(){return this.config.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.config.typingIndicatorTimeoutDefault}}]),e}();t.TypingIndicator=d},TsN3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("N8HJ"),i=n("TkJz"),s=n("SbVi"),a=n("gSK9"),o=n("MmGm"),u=n("FukD"),c=n("Xs3C");t.PacketResponse=function(){return function e(){_classCallCheck(this,e)}}(),t.PacketInterface=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.config=n,this.activeRequests=new Map,this.channel=t,this.channel.on("reply",(function(e){return r.processReply(e)})),this.channel.on("disconnected",(function(){r.activeRequests.forEach((function(e){clearTimeout(e.timeout),e.reject(new s.TwilsockError("disconnected"))})),r.activeRequests.clear()}))}var t;return _createClass(e,[{key:"processReply",value:function(e){var t,n=this.activeRequests.get(e.id);n&&(clearTimeout(n.timeout),this.activeRequests.delete(e.id),(t=e.status.code)>=200&&t<300?n.resolve(e):(n.reject(new a.TwilsockReplyError("Transport failure: "+e.status.status,e)),r.log.trace("message rejected")))}},{key:"storeRequest",value:function(e,t,n){var i={resolve:t,reject:n,timeout:setTimeout((function(){r.log.trace("request",e,"is timed out"),n(new s.TwilsockError("Twilsock: request timeout: "+e))}),3e4)};this.activeRequests.set(e,i)}},{key:"shutdown",value:function(){this.activeRequests.forEach((function(e){clearTimeout(e.timeout),e.reject(new s.TwilsockError("Twilsock: request cancelled by user"))})),this.activeRequests.clear()}},{key:"sendInit",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.log.trace("sendInit"),t=c.Metadata.getMetadata(this.config),n=new u.Init(this.config.token,this.config.continuationToken,t,this.config.initRegistrations,this.config.tweaks),e.next=5,this.sendWithReply(n);case 5:return i=e.sent,e.abrupt("return",new u.InitReply(i.id,i.header.continuation_token,i.header.continuation_token_status,i.header.offline_storage,i.header.init_registrations,i.header.debug_info));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"sendClose",value:function(){var e=new u.Close;this.send(e)}},{key:"sendWithReply",value:function(e,t){var n=this;return new Promise((function(r,i){var s=n.send(e,t);n.storeRequest(s,r,i)}))}},{key:"send",value:function(e,t){e.id=e.id||"TM".concat(i.v4());var n=o.Parser.createPacket(e,function(e){switch(typeof e){case"undefined":return"";case"object":return JSON.stringify(e);default:return e}}(t));try{return this.channel.send(n),e.id}catch(s){throw r.log.debug("failed to send ",e,s),r.log.trace(s.stack),s}}},{key:"isConnected",get:function(){return this.channel.isConnected}}]),e}()},UtsQ:function(e,t){e.exports=!0},UuY1:function(e,t,n){"use strict";var r=o(n("tgXR")),i=o(n("IhEH")),s=o(n("aq5/")),a=o(n("4Mt5"));function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n("RtQP"),c=n("ZYEu"),l=n("Xfc8"),d=function(){function e(t,n,r){(0,s.default)(this,e),this.client=t,this.services=n,this.url=r}var t;return(0,a.default)(e,[{key:"getChannels",value:(t=(0,i.default)(r.default.mark((function e(){var t,n,i=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new u.UriBuilder(this.url).arg("PageToken",s.pageToken).build(),e.next=3,this.services.network.get(t);case 3:return e.abrupt("return",new c.RestPaginator((n=e.sent).body.channels.map((function(e){return new l.ChannelDescriptor(i.client,e)})),(function(e){return i.getChannels({pageToken:e})}),n.body.meta.previous_token,n.body.meta.next_token));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();t.UserChannels=d},UusA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("2CE9"),i=global.XMLHttpRequest||n(5).XMLHttpRequest,s=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(t,n){return e.request("GET",t,n)}},{key:"post",value:function(t,n,r){return e.request("POST",t,n,r)}}],[{key:"request",value:function(e,t,n,s){return new Promise((function(a,o){var u=new i;for(var c in u.open(e,t,!0),u.onreadystatechange=function(){if(4===u.readyState){var e,t=(e=u.getAllResponseHeaders())?e.split("\r\n").map((function(e){return e.split(": ")})).filter((function(e){return 2===e.length&&e[1].length>0})).reduce((function(e,t){return e[t[0]]=t[1],e}),{}):{},n=function(e){var t=e.getResponseHeader("Content-Type");if(!t||0!==t.indexOf("application/json")||0===e.responseText.length)return e.responseText;try{return JSON.parse(e.responseText)}catch(n){return e.responseText}}(u);if(200<=u.status&&u.status<300)a({status:u.status,headers:t,body:n});else{var i,s=u.statusText&&u.statusText.code?u.statusText.code:"NONE";i="string"==typeof n?n&&1===n.split("\n",2).length?n:"":JSON.stringify(n),o(new r.TransportError("".concat(u.status,": [").concat(s,"] ").concat(i),u.status,n,s,t))}}},n)u.setRequestHeader(c,n[c]),"Content-Type"===c&&"application/json"===n[c]&&(s=JSON.stringify(s));u.send(s)}))}}]),e}();t.Transport=s},UwCj:function(e,t,n){var r=n("8fQz"),i=n("LMaB"),s=n("Kc1g"),a=Object.defineProperty;t.f=n("ObEa")?Object.defineProperty:function(e,t,n){if(r(e),t=s(t,!0),r(n),i)try{return a(e,t,n)}catch(o){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},"V/GX":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("r2q8"),i=n("nzL3"),s=n("ypPR");t.Registrar=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,o){var u;_classCallCheck(this,n),(u=t.call(this)).config=o,u.connectors=new Map;var c=u.detectPlatform();return u.connectors.set("gcm",new i.RegistrarConnector("gcm",{protocolVersion:3,productId:e,platform:c},r,o)),u.connectors.set("fcm",new i.RegistrarConnector("fcm",{protocolVersion:3,productId:e,platform:c},r,o)),u.connectors.set("apn",new i.RegistrarConnector("apn",{protocolVersion:4,productId:e,platform:c},r,o)),u.connectors.set("twilsock",new s.TwilsockConnector({productId:e,platform:c},a,o)),u.connectors.get("twilsock").on("transportReady",(function(e){return u.emit("transportReady",e)})),u}return _createClass(n,[{key:"setNotificationId",value:function(e,t){this.connector(e).setNotificationId(t)}},{key:"subscribe",value:function(e,t){return this.connector(t).subscribe(e)}},{key:"unsubscribe",value:function(e,t){return this.connector(t).unsubscribe(e)}},{key:"updateToken",value:function(e){this.connectors.forEach((function(t){return t.updateToken(e)}))}},{key:"connector",value:function(e){var t=this.connectors.get(e);if(!t)throw new Error("Unknown channel type: ".concat(e));return t}},{key:"detectPlatform",value:function(){var e="";return"undefined"!=typeof navigator?(e="unknown",void 0!==navigator.product&&(e=navigator.product),void 0!==navigator.userAgent&&(e=navigator.userAgent)):e="web",e.substring(0,128)}}]),n}(r.EventEmitter)},VAi2:function(e,t,n){n("Fk9O"),n("/r3m"),e.exports=n("R6fH")},VeTy:function(e,t,n){var r=n("DIWJ"),i=n("jHgz"),s=n("Hs7Z"),a=n("Kc1g"),o=n("YVtA"),u=n("LMaB"),c=Object.getOwnPropertyDescriptor;t.f=n("ObEa")?c:function(e,t){if(e=s(e),t=a(t,!0),u)try{return c(e,t)}catch(n){}if(o(e,t))return i(!r.f.call(e,t),e[t])}},ViZE:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("BHqR");t.Reply=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).method="reply",r.payload_type="application/json",r.status={code:200,status:"OK"},r}return n}(r.AbstractMessage)},Vzpu:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},W27V:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("lKIr"),i=n("qlDM"),s=n("sc67"),a=n("LYxL"),o=n("yURk"),u=n("+fds"),c=n("L760"),l=n("QvZc"),d=n("wiho"),f=n("e/PS"),h=function(e){_inherits(T,e);var t,n,o,f,h,p,v,y,m,g,b,k,_,w,x,C,S=_createSuper(T);function T(e,t,n){var r;return _classCallCheck(this,T),(r=S.call(this,e,n)).updateMergingQueue=new d.NamespacedMergingQueue((function(e,t){return"number"==typeof t.ttl?{ttl:t.ttl}:e})),r.cache=new l.Cache,r.descriptor=t,r.descriptor.date_updated=new Date(r.descriptor.date_updated),r}return _createClass(T,[{key:"_addOrUpdateItemOnServer",value:(C=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,i){var s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={data:n},"number"==typeof i&&(s.ttl=i),e.next=4,this.services.network.post(t,s,r);case 4:return a=e.sent,e.abrupt("return",(a.body.data=n,a.body.date_updated=new Date(a.body.date_updated),a.body));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return C.apply(this,arguments)})},{key:"push",value:(x=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var i,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(n||{}).ttl,r.validateOptionalTtl(i),e.next=4,this._addOrUpdateItemOnServer(this.links.items,t,void 0,i);case 4:return s=e.sent,a=Number(s.index),e.abrupt("return",(this._handleItemMutated(a,s.url,s.last_event_id,s.revision,t,s.date_updated,s.date_expires,!0,!1),this.cache.get(a)));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"set",value:(w=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,i){var s,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i||{},e.abrupt("return",(r.validateOptionalTtl(s.ttl),this.updateMergingQueue.squashAndAdd(t,s,(function(e){return a._updateItemUnconditionally(t,n,e.ttl)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return w.apply(this,arguments)})},{key:"_updateItemUnconditionally",value:(_=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return i=e.sent,e.next=5,this._addOrUpdateItemOnServer(i.uri,n,void 0,r);case 5:return s=e.sent,e.abrupt("return",(this._handleItemMutated(t,s.url,s.last_event_id,s.revision,s.data,s.date_updated,s.date_expires,!1,!1),this.cache.get(t)));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return _.apply(this,arguments)})},{key:"_updateItemWithIfMatch",value:(k=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,i){var s,a,o,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:if(s=e.sent,a=n(r.deepClone(s.value))){e.next=6;break}return e.abrupt("return",s);case 6:return o=s.revision,e.prev=7,e.next=10,this._addOrUpdateItemOnServer(s.uri,a,o,i);case 10:return u=e.sent,e.abrupt("return",(this._handleItemMutated(t,u.url,u.last_event_id,u.revision,u.data,u.date_updated,u.date_expires,!1,!1),this.cache.get(t)));case 14:if(e.prev=14,e.t0=e.catch(7),412!==e.t0.status){e.next=20;break}return e.next=19,this._getItemFromServer(t);case 19:return e.abrupt("return",this._updateItemWithIfMatch(t,n,i));case 20:throw e.t0;case 21:case"end":return e.stop()}}),e,this,[[7,14]])}))),function(e,t,n){return k.apply(this,arguments)})},{key:"mutate",value:(b=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,i){var s,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i||{},e.abrupt("return",(r.validateOptionalTtl(s.ttl),this.updateMergingQueue.add(t,s,(function(e){return a._updateItemWithIfMatch(t,n,e.ttl)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return b.apply(this,arguments)})},{key:"update",value:(g=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mutate(t,(function(e){return Object.assign(e,n)}),r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return g.apply(this,arguments)})},{key:"remove",value:(m=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return n=e.sent,e.next=5,this.services.network.delete(n.uri);case 5:r=e.sent,this._handleItemRemoved(t,r.body.last_event_id,void 0,new Date(r.body.date_updated),!1);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"get",value:(y=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.cache.get(t)||this._getItemFromServer(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"_getItemFromServer",value:(v=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryItems({index:t});case 2:if(!((n=e.sent).items.length<1)){e.next=5;break}throw new s.SyncError("No item with index ".concat(t," found"),404,54151);case 5:return e.abrupt("return",n.items[0]);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"queryItems",value:(p=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,s,a,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},n=new i.UriBuilder(this.links.items).queryParam("From",t.from).queryParam("PageSize",t.limit).queryParam("Index",t.index).queryParam("PageToken",t.pageToken).queryParam("Order",t.order).build(),e.next=4,this.services.network.get(n);case 4:return r=e.sent,s=r.body.items.map((function(e){return e.date_updated=new Date(e.date_updated),o.cache.get(e.index)?o._handleItemMutated(e.index,e.url,e.last_event_id,e.revision,e.data,e.date_updated,e.date_expires,!1,!0):o.cache.store(Number(e.index),new u.ListItem({index:Number(e.index),uri:e.url,revision:e.revision,lastEventId:e.last_event_id,dateUpdated:e.date_updated,dateExpires:e.date_expires,value:e.data}),e.last_event_id),o.cache.get(e.index)})),a=r.body.meta,e.abrupt("return",new c.Paginator(s,(function(e){return o.queryItems({pageToken:e})}),a.previous_token,a.next_token));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getItems",value:(h=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(r.validatePageSize((t=t||{}).pageSize),t.limit=t.pageSize||t.limit||50,t.order=t.order||"asc",this.queryItems(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"getContext",value:(f=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.context){e.next=5;break}return e.next=3,this.services.network.get(this.links.context);case 3:t=e.sent,this._updateContextIfRequired(t.body.data,t.body.last_event_id);case 5:return e.abrupt("return",this.context);case 6:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"setTtl",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.validateMandatoryTtl(t),e.prev=1,n={ttl:t},e.next=5,this.services.network.post(this.uri,n);case 5:i=e.sent,this.descriptor.date_expires=i.body.date_expires,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(1),404===e.t0.status&&this.onRemoved(!1),e.t0;case 12:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return o.apply(this,arguments)})},{key:"setItemTtl",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var i,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.validateMandatoryTtl(n),e.next=3,this.get(t);case 3:return i=e.sent,s={ttl:n},e.next=7,this.services.network.post(i.uri,s);case 7:a=e.sent,i.updateDateExpires(a.body.date_expires);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeList",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onRemoved",value:function(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}},{key:"shouldIgnoreEvent",value:function(e,t){return this.cache.isKnown(e,t)}},{key:"_update",value:function(e,t){var n=Number(e.item_index);switch(e.date_created=new Date(e.date_created),e.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(n,e.item_url,e.id,e.item_revision,e.item_data,e.date_created,void 0,"list_item_added"===e.type,!0);break;case"list_item_removed":this._handleItemRemoved(n,e.id,e.item_data,e.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(e.context_data,e.id,e.date_created);break;case"list_removed":this.onRemoved(!1)}t&&this._advanceLastEventId(e.id,e.list_revision)}},{key:"_advanceLastEventId",value:function(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e,t&&(this.descriptor.revision=t))}},{key:"_updateRootDateUpdated",value:function(e){(!this.descriptor.date_updated||e.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=e,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:e}))}},{key:"_handleItemMutated",value:function(e,t,n,r,i,s,o,c,l){if(this.shouldIgnoreEvent(e,n))a.default.trace("Item ",e," update skipped, current:",this.lastEventId,", remote:",n);else{this._updateRootDateUpdated(s);var d=this.cache.get(e);if(d)d.update(n,r,i,s),this.cache.store(e,d,n),void 0!==o&&d.updateDateExpires(o),this.emitItemMutationEvent(d,l,!1);else{var f=new u.ListItem({index:e,uri:t,lastEventId:n,revision:r,value:i,dateUpdated:s,dateExpires:o});this.cache.store(e,f,n),this.emitItemMutationEvent(f,l,c)}}}},{key:"emitItemMutationEvent",value:function(e,t,n){this.broadcastEventToListeners(n?"itemAdded":"itemUpdated",{item:e,isLocal:!t})}},{key:"_handleItemRemoved",value:function(e,t,n,r,i){this._updateRootDateUpdated(r),this.cache.delete(e,t),this.broadcastEventToListeners("itemRemoved",{index:e,isLocal:!i,value:n})}},{key:"_handleContextUpdate",value:function(e,t,n){this._updateRootDateUpdated(n),this._updateContextIfRequired(e,t)&&this.broadcastEventToListeners("contextUpdated",{context:e,isLocal:!1})}},{key:"_updateContextIfRequired",value:function(e,t){return!this.contextEventId||t>this.contextEventId?(this.context=e,this.contextEventId=t,!0):(a.default.trace("Context update skipped, current:",this.lastEventId,", remote:",t),!1)}},{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"list"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}}],[{key:"type",get:function(){return"list"}}]),T}(o.SyncEntity);t.SyncListImpl=h;var p=function(e){_inherits(p,e);var t,n,r,i,s,a,o,u,c,l,d,f=_createSuper(p);function p(e){var t;return _classCallCheck(this,p),(t=f.call(this)).syncListImpl=e,t.syncListImpl.attach(_assertThisInitialized(t)),t}return _createClass(p,[{key:"push",value:(d=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.push(t,n)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"set",value:(l=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.set(t,n,r)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"mutate",value:(c=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.mutate(t,n,r)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"update",value:(u=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.update(t,n,r)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"remove",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.remove(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"get",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.get(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getContext",value:(s=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.getContext()));case 1:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"getItems",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.getItems(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setTtl",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.setTtl(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setItemTtl",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.setItemTtl(t,n)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeList",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncListImpl.removeList()));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){_get3(_getPrototypeOf(p.prototype),"close",this).call(this),this.syncListImpl.detach(this.listenerUuid)}},{key:"uri",get:function(){return this.syncListImpl.uri}},{key:"revision",get:function(){return this.syncListImpl.revision}},{key:"lastEventId",get:function(){return this.syncListImpl.lastEventId}},{key:"links",get:function(){return this.syncListImpl.links}},{key:"dateExpires",get:function(){return this.syncListImpl.dateExpires}},{key:"type",get:function(){return h.type}},{key:"sid",get:function(){return this.syncListImpl.sid}},{key:"uniqueName",get:function(){return this.syncListImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncListImpl.dateUpdated}}],[{key:"type",get:function(){return h.type}}]),p}(f.default);t.SyncList=p,t.default=p},WLcV:function(e,t,n){var r=n("nwbp"),i=n("KQtV");e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[s+o]=a[o];return t||i(a)}},WOjp:function(e,t,n){"use strict";var r=n("Vzpu");function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},Wnek:function(e,t,n){var r=n("wGyb");e.exports=function(e,t){return new(r(e))(t)}},XUND:function(e,t,n){e.exports={default:n("HoF5"),__esModule:!0}},XWhX:function(e,t,n){"use strict";var r=n("ObEa"),i=n("ApsS"),s=n("dptC"),a=n("DIWJ"),o=n("MrWc"),u=n("aAA+"),c=Object.assign;e.exports=!c||n("7S/a")((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=c({},e)[n]||Object.keys(c({},t)).join("")!=r}))?function(e,t){for(var n=o(e),c=arguments.length,l=1,d=s.f,f=a.f;c>l;)for(var h,p=u(arguments[l++]),v=d?i(p).concat(d(p)):i(p),y=v.length,m=0;y>m;)h=v[m++],r&&!f.call(p,h)||(n[h]=p[h]);return n}:c},XXPQ:function(e,t,n){"use strict";var r,i=(r=n("aq5/"))&&r.__esModule?r:{default:r};Object.defineProperty(t,"__esModule",{value:!0}),t.SyncListDescriptor=function e(t){(0,i.default)(this,e),this.descriptor=t,this.channel_sid=t.channel_sid,this.status=t.status,this.channel=t.channel,this.messages=t.messages,this.roster=t.roster,this.lastConsumedMessageIndex=t.last_consumed_message_index,this.notificationLevel=t.notification_level,this.status=t.status}},XaWT:function(e,t,n){e.exports={default:n("4iaB"),__esModule:!0}},XdyU:function(e,t,n){var r,i;!function(s,a){"use strict";void 0===(i="function"==typeof(r=function(){var e=function(){},t="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function r(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(r){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function i(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(n){return"debug"===n&&(n="log"),"undefined"!=typeof console&&("trace"===n&&t?i:void 0!==console[n]?r(console,n):void 0!==console.log?r(console,"log"):e)}function a(t,r){for(var i=0;i<n.length;i++){var s=n[i];this[s]=i<t?e:this.methodFactory(s,t,r)}this.log=this.debug}function o(e,t,n){return function(){"undefined"!=typeof console&&(a.call(this,t,n),this[e].apply(this,arguments))}}function u(e,t,n){return s(e)||o.apply(this,arguments)}function c(e,t,r){var i,s=this,o="loglevel";function c(){var e;if("undefined"!=typeof window){try{e=window.localStorage[o]}catch(r){}if(void 0===e)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(o)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(r){}return void 0===s.levels[e]&&(e=void 0),e}}e&&(o+=":"+e),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=r||u,s.getLevel=function(){return i},s.setLevel=function(t,r){if("string"==typeof t&&void 0!==s.levels[t.toUpperCase()]&&(t=s.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(i=t,!1!==r&&function(e){var t=(n[e]||"silent").toUpperCase();if("undefined"!=typeof window){try{return void(window.localStorage[o]=t)}catch(r){}try{window.document.cookie=encodeURIComponent(o)+"="+t+";"}catch(r){}}}(t),a.call(s,t,e),"undefined"==typeof console&&t<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){c()||s.setLevel(e,!1)},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var l=c();null==l&&(l=null==t?"WARN":t),s.setLevel(l,!1)}var l=new c,d={};l.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new c(e,l.getLevel(),l.methodFactory)),t};var f="undefined"!=typeof window?window.log:void 0;return l.noConflict=function(){return"undefined"!=typeof window&&window.log===l&&(window.log=f),l},l.getLoggers=function(){return d},l})?r.call(t,n,t,e):r)||(e.exports=i)}()},Xfc8:function(e,t,n){"use strict";var r=s(n("aq5/")),i=s(n("4Mt5"));function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n("CPx3"),o=n("cDQD"),u=a.Logger.scope("ChannelDescriptor");function c(e){try{return new Date(e)}catch(t){return null}}var l=function(){function e(t,n){(0,r.default)(this,e),this.client=t,this.descriptor=n,n.sid?(this.sid=n.sid,this.channel=n.sid+".channel"):(this.sid=n.channel_sid,this.channel=n.channel_sid+".channel"),this.uniqueName=n.unique_name,this.friendlyName=n.friendly_name,this.attributes=function(e){try{return JSON.parse(e)}catch(t){u.warn("Failed to parse channel attributes",t)}return{}}(n.attributes),this.createdBy=n.created_by,this.dateCreated=c(n.date_created),this.dateUpdated=c(n.date_updated),this.messagesCount=n.messages_count,this.membersCount=n.members_count,this.type=n.type,this.isPrivate="private"==n.type,this.lastConsumedMessageIndex=n.last_consumed_message_index,n.notification_level&&(this.notificationLevel=n.notification_level),this.status=n.status?o.filterStatus(n.status):"unknown"}return(0,i.default)(e,[{key:"getChannel",value:function(){return this.client.getChannelBySid(this.sid)}}]),e}();t.ChannelDescriptor=l},Xmnl:function(e,t,n){"use strict";var r=h(n("XUND")),i=h(n("qCKU")),s=h(n("tgXR")),a=h(n("IhEH")),o=h(n("u2rs")),u=h(n("Rhu4")),c=h(n("aq5/")),l=h(n("4Mt5")),d=h(n("7xyS")),f=h(n("k2Qk"));function h(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var p=n("r2q8"),v=n("CPx3"),y=n("Y5Gq"),m=v.Logger.scope("Messages"),g=function(e){function t(e,n){(0,c.default)(this,t);var r=(0,d.default)(this,(t.__proto__||(0,u.default)(t)).call(this));return r.channel=e,r.services=n,r.messagesByIndex=new o.default,r.messagesListPromise=null,r}var n,h,p;return(0,f.default)(t,e),(0,l.default)(t,[{key:"subscribe",value:function(e){var t=this;return this.messagesListPromise=this.messagesListPromise||this.services.syncClient.list({id:e,mode:"open_existing"}).then((function(e){return e.on("itemAdded",(function(e){m.debug(t.channel.sid+" itemAdded: "+e.item.index);var n=new y.Message(t.channel,t.services,e.item.index,e.item.value);t.messagesByIndex.has(n.index)?m.debug("Message arrived, but already known and ignored",t.channel.sid,n.index):(t.messagesByIndex.set(n.index,n),n.on("updated",(function(e){return t.emit("messageUpdated",e)})),t.emit("messageAdded",n))})),e.on("itemRemoved",(function(e){m.debug(t.channel.sid+" itemRemoved: "+e.index);var n=e.index;if(t.messagesByIndex.has(n)){var r=t.messagesByIndex.get(n);t.messagesByIndex.delete(r.index),r.removeAllListeners("updated"),t.emit("messageRemoved",r)}})),e.on("itemUpdated",(function(e){m.debug(t.channel.sid+" itemUpdated: "+e.item.index);var n=t.messagesByIndex.get(e.item.index);n&&n._update(e.item.value)})),e})).catch((function(e){throw t.messagesListPromise=null,"disconnected"!=t.services.syncClient.connectionState&&m.error("Failed to get messages object for channel",t.channel.sid,e),m.debug("ERROR: Failed to get messages object for channel",t.channel.sid,e),e}))}},{key:"unsubscribe",value:(p=(0,a.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.messagesListPromise){e.next=6;break}return e.next=3,this.messagesListPromise;case 3:e.sent.close(),this.messagesListPromise=null;case 6:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"send",value:(h=(0,a.default)(s.default.mark((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.debug("Sending text message",t,n),null!==n){e.next=3;break}throw new Error("Attributes can't be null");case 3:if(n.constructor===Object){e.next=5;break}throw new Error("Attributes must be a valid JSON object");case 5:return e.abrupt("return",this.services.session.addCommand("sendMessage",{channelSid:this.channel.sid,text:t,attributes:(0,i.default)(n)}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"sendMedia",value:(n=(0,a.default)(s.default.mark((function e(t){var n,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.debug("Sending media message",t,a),a.constructor===Object){e.next=3;break}throw new Error("Attributes must be a valid JSON object");case 3:if(n=void 0,!("undefined"!=typeof FormData&&t instanceof FormData)){e.next=11;break}return m.debug("Sending media message as FormData",t,a),e.next=8,this.services.mcsClient.postFormData(t);case 8:n=e.sent,e.next=18;break;case 11:if(m.debug("Sending media message as SendMediaOptions",t,a),(r=t).contentType&&r.media){e.next=15;break}throw new Error("Media content <Channel#SendMediaOptions> must contain non-empty contentType and media");case 15:return e.next=17,this.services.mcsClient.post(r.contentType,r.media);case 17:n=e.sent;case 18:return e.abrupt("return",this.services.session.addCommand("sendMediaMessage",{channelSid:this.channel.sid,mediaSid:n.sid,attributes:(0,i.default)(a)}));case 19:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getMessages",value:function(e,t,n){return this._getMessages(e,t=void 0!==t?t:"end",n=n||"backwards")}},{key:"wrapPaginator",value:function(e,t,n){var r=this,i="desc"===e,s=function(){return t.nextPage().then((function(t){return r.wrapPaginator(e,t,n)}))},a=function(){return t.prevPage().then((function(t){return r.wrapPaginator(e,t,n)}))};return n(t.items).then((function(e){return{items:e.sort((function(e,t){return e.index-t.index})),hasPrevPage:i?t.hasNextPage:t.hasPrevPage,hasNextPage:i?t.hasPrevPage:t.hasNextPage,prevPage:i?s:a,nextPage:i?a:s}}))}},{key:"_upsertMessage",value:function(e,t){var n=this,r=this.messagesByIndex.get(e);if(r)return r;var i=new y.Message(this.channel,this.services,e,t);return this.messagesByIndex.set(i.index,i),i.on("updated",(function(e){return n.emit("messageUpdated",e)})),i}},{key:"_getMessages",value:function(e,t,n){var i=this;t=void 0!==t?t:"end",e=e||30;var s="backwards"===n?"desc":"asc";return this.messagesListPromise.then((function(n){return n.getItems({from:"end"!==t?t:void 0,pageSize:e,order:s})})).then((function(e){return i.wrapPaginator(s,e,(function(e){return r.default.all(e.map((function(e){return i._upsertMessage(e.index,e.value)})))}))}))}}]),t}(p.EventEmitter);t.Messages=g},Xs3C:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("CmQt");t.Metadata=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getMetadata",value:function(e){"undefined"!=typeof navigator&&r.parse(navigator.userAgent);var t=e&&e.clientMetadata?e.clientMetadata:{},n={env:r.name,envv:r.version,os:r.os.family,osv:r.os.version,osa:r.os.architecture,sdk:"js-default"},i={};return["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"].filter((function(e){return e in t||e in n})).forEach((function(e){return i[e]=e in t?t[e]:n[e]})),i}}]),e}()},"Y+Rv":function(e,t,n){"use strict";var r,i,s,a,o=n("UtsQ"),u=n("hR4s"),c=n("dWRk"),l=n("M25K"),d=n("IFjL"),f=n("vbc5"),h=n("Vzpu"),p=n("s0lH"),v=n("9v8s"),y=n("SmK6"),m=n("CmYO").set,g=n("6YAS")(),b=n("WOjp"),k=n("y7sZ"),_=n("QwS4"),w=n("Y0Jp"),x=u.TypeError,C=u.process,S=C&&C.versions,T=S&&S.v8||"",R=u.Promise,M="process"==l(C),E=function(){},I=i=b.f,P=!!function(){try{var e=R.resolve(1),t=(e.constructor={})[n("eD9m")("species")]=function(e){e(E,E)};return(M||"function"==typeof PromiseRejectionEvent)&&e.then(E)instanceof t&&0!==T.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(r){}}(),O=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},N=function(e,t){if(!e._n){e._n=!0;var n=e._c;g((function(){for(var r=e._v,i=1==e._s,s=0,a=function(t){var n,s,a,o=i?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{o?(i||(2==e._h&&U(e),e._h=1),!0===o?n=r:(l&&l.enter(),n=o(r),l&&(l.exit(),a=!0)),n===t.promise?c(x("Promise-chain cycle")):(s=O(n))?s.call(n,u,c):u(n)):c(r)}catch(d){l&&!a&&l.exit(),c(d)}};n.length>s;)a(n[s++]);e._c=[],e._n=!1,t&&!e._h&&j(e)}))}},j=function(e){m.call(u,(function(){var t,n,r,i=e._v,s=L(e);if(s&&(t=k((function(){M?C.emit("unhandledRejection",i,e):(n=u.onunhandledrejection)?n({promise:e,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=M||L(e)?2:1),e._a=void 0,s&&t.e)throw t.v}))},L=function(e){return 1!==e._h&&0===(e._a||e._c).length},U=function(e){m.call(u,(function(){var t;M?C.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})}))},D=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),N(t,!0))},A=function e(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw x("Promise can't be resolved itself");(n=O(t))?g((function(){var i={_w:r,_d:!1};try{n.call(t,c(e,i,1),c(D,i,1))}catch(s){D.call(i,s)}})):(r._v=t,r._s=1,N(r,!1))}catch(i){D.call({_w:r,_d:!1},i)}}};P||(R=function(e){p(this,R,"Promise","_h"),h(e),r.call(this);try{e(c(A,this,1),c(D,this,1))}catch(t){D.call(this,t)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n("qa3O")(R.prototype,{then:function(e,t){var n=I(y(this,R));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=M?C.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&N(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),s=function(){var e=new r;this.promise=e,this.resolve=c(A,e,1),this.reject=c(D,e,1)},b.f=I=function(e){return e===R||e===a?new s(e):i(e)}),d(d.G+d.W+d.F*!P,{Promise:R}),n("KnMe")(R,"Promise"),n("Jn7W")("Promise"),a=n("rFq9").Promise,d(d.S+d.F*!P,"Promise",{reject:function(e){var t=I(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(o||!P),"Promise",{resolve:function(e){return w(o&&this===a?R:this,e)}}),d(d.S+d.F*!(P&&n("EWHn")((function(e){R.all(e).catch(E)}))),"Promise",{all:function(e){var t=this,n=I(t),r=n.resolve,i=n.reject,s=k((function(){var n=[],s=0,a=1;v(e,!1,(function(e){var o=s++,u=!1;n.push(void 0),a++,t.resolve(e).then((function(e){u||(u=!0,n[o]=e,--a||r(n))}),i)})),--a||r(n)}));return s.e&&i(s.v),n.promise},race:function(e){var t=this,n=I(t),r=n.reject,i=k((function(){v(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},Y0Jp:function(e,t,n){var r=n("8fQz"),i=n("vbc5"),s=n("WOjp");e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=s.f(e);return(0,n.resolve)(t),n.promise}},Y5Gq:function(e,t,n){"use strict";var r=d(n("qCKU")),i=d(n("tgXR")),s=d(n("IhEH")),a=d(n("Rhu4")),o=d(n("aq5/")),u=d(n("4Mt5")),c=d(n("7xyS")),l=d(n("k2Qk"));function d(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var f=n("r2q8"),h=n("RtQP"),p=n("CPx3"),v=n("qPgj"),y=p.Logger.scope("Message");function m(e,t){try{return t?JSON.parse(t):{}}catch(n){return y.warn("Got malformed attributes for the message",e),{}}}var g=function(e){function t(e,n,r,i){(0,o.default)(this,t);var s=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return s.channel=e,s.services=n,s.state={sid:i.sid,index:r,author:null==i.author?null:i.author,body:i.text,timestamp:i.timestamp?new Date(i.timestamp):null,dateUpdated:i.dateUpdated?new Date(i.dateUpdated):null,lastUpdatedBy:i.lastUpdatedBy?i.lastUpdatedBy:null,attributes:m(i.sid,i.attributes),type:i.type?i.type:"text",media:i.type&&"media"===i.type&&i.media?new v.Media(i.media,s.services):null,memberSid:null==i.memberSid?null:i.memberSid},s}var n,d,f,p;return(0,l.default)(t,e),(0,u.default)(t,[{key:"_update",value:function(e){var t=[];!e.text&&"string"!=typeof e.text||e.text===this.state.body||(this.state.body=e.text,t.push("body")),e.lastUpdatedBy&&e.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=e.lastUpdatedBy,t.push("lastUpdatedBy")),e.author&&e.author!==this.state.author&&(this.state.author=e.author,t.push("author")),e.dateUpdated&&new Date(e.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(e.dateUpdated),t.push("dateUpdated")),e.timestamp&&new Date(e.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(e.timestamp),t.push("timestamp"));var n=m(this.sid,e.attributes);h.isDeepEqual(this.state.attributes,n)||(this.state.attributes=n,t.push("attributes")),t.length>0&&this.emit("updated",{message:this,updateReasons:t})}},{key:"getMember",value:(p=(0,s.default)(i.default.mark((function e(){var t,n,r=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,!this.state.memberSid){e.next=5;break}return e.next=4,this.channel.getMemberBySid(this.memberSid).catch((function(){return y.debug('Member with sid "'+r.memberSid+'" not found for message '+r.sid),null}));case 4:t=e.sent;case 5:if(t||!this.state.author){e.next=9;break}return e.next=8,this.channel.getMemberByIdentity(this.state.author).catch((function(){return y.debug('Member with identity "'+r.author+'" not found for message '+r.sid),null}));case 8:t=e.sent;case 9:if(!t){e.next=11;break}return e.abrupt("return",t);case 11:throw n="Member with ",this.state.memberSid&&(n+="SID '"+this.state.memberSid+"' "),this.state.author&&(this.state.memberSid&&(n+="or "),n+="identity '"+this.state.author+"' "),"Member with "===n&&(n="Member "),n+="was not found",new Error(n);case 17:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"remove",value:(f=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("deleteMessage",{channelSid:this.channel.sid,messageIdx:this.index.toString()});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"updateBody",value:(d=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new Error("Body <String> is a required parameter for updateBody");case 2:return e.next=4,this.services.session.addCommand("editMessage",{channelSid:this.channel.sid,messageIdx:this.index.toString(),text:t});case 4:return e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"updateAttributes",value:(n=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=4;break}throw new Error("Attributes is required parameter");case 4:if(null!==t){e.next=8;break}throw new Error("Attributes can't be null");case 8:if(t.constructor===Object){e.next=10;break}throw new Error("Attributes must be a valid JSON object");case 10:return e.next=12,this.services.session.addCommand("editMessageAttributes",{channelSid:this.channel.sid,messageIdx:this.index,attributes:(0,r.default)(t)});case 12:return e.abrupt("return",this);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"body",get:function(){return"media"===this.type?null:this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"timestamp",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"memberSid",get:function(){return this.state.memberSid}}]),t}(f.EventEmitter);t.Message=g},"YR+c":function(e,t,n){"use strict";var r=n("IFjL"),i=n("WOjp"),s=n("y7sZ");r(r.S,"Promise",{try:function(e){var t=i.f(this),n=s(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},YVtA:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},Yquk:function(e,t,n){"use strict";var r=s(n("aq5/")),i=s(n("4Mt5"));function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n("CPx3").Logger.scope("UserDescriptor"),o=function(){function e(t,n){(0,r.default)(this,e),this.services=t,this.descriptor=n,this.identity=n.identity,this.friendlyName=n.friendly_name,this.attributes=function(e){try{return JSON.parse(e)}catch(t){a.warn("Failed to parse user attributes",t)}return{}}(n.attributes),this.online=n.is_online,this.notifiable=n.is_notifiable}return(0,i.default)(e,[{key:"subscribe",value:function(){return this.services.users.getUser(this.identity,this.descriptor.sync_unique_name)}},{key:"_getDescriptor",value:function(){return this.descriptor}}]),e}();t.UserDescriptor=o},ZYEu:function(e,t,n){"use strict";var r=a(n("XUND")),i=a(n("aq5/")),s=a(n("4Mt5"));function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(t,n,r,s){(0,i.default)(this,e),this.state={prevToken:r,nextToken:s,source:n,items:t}}return(0,s.default)(e,[{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):r.default.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):r.default.reject(new Error("No previous page"))}},{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}}]),e}();t.RestPaginator=o},ZvXT:function(e,t,n){"use strict";var r=f(n("tgXR")),i=f(n("IhEH")),s=f(n("XUND")),a=f(n("QDM+")),o=f(n("B3Ab")),u=f(n("CafK")),c=f(n("u2rs")),l=f(n("aq5/")),d=f(n("4Mt5"));function f(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var h=n("qXWz"),p=function(){function e(t,n){var r=this;(0,l.default)(this,e),this.config=t,this.services=n,this.cache=new c.default,this.cacheLifetime=0,this.services.session.getHttpCacheInterval().then((function(e){r.cacheLifetime=1e3*e,r.cleanupCache()}))}var t;return(0,d.default)(e,[{key:"backoffConfig",value:function(){return(0,u.default)(this.config.backoffConfigDefault,this.config.backoffConfigOverride)}},{key:"retryWhenThrottled",value:function(){return void 0!==this.config.retryWhenThrottledOverride?this.config.retryWhenThrottledOverride:void 0!==this.config.retryWhenThrottledDefault&&this.config.retryWhenThrottledDefault}},{key:"isExpired",value:function(e){return!this.cacheLifetime||Date.now()-e>this.cacheLifetime}},{key:"cleanupCache",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=(0,a.default)(this.cache);!(e=(r=i.next()).done);e=!0){var s=(0,o.default)(r.value,2),u=s[0];this.isExpired(s[1].timestamp)&&this.cache.delete(u)}}catch(c){t=!0,n=c}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}0===this.cache.size&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var e=this;this.timer=this.timer||setInterval((function(){return e.cleanupCache()}),2*this.cacheLifetime)}},{key:"executeWithRetry",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new s.default((function(r,i){var s=[502,503,504];n&&s.push(429);var a=new h.Retrier(t.backoffConfig());a.on("attempt",(function(){e().then((function(e){return a.succeeded(e)})).catch((function(e){s.indexOf(e.status)>-1||"Twilsock disconnected"===e.message?a.failed(e):(a.removeAllListeners(),a.cancel(),i(e))}))})),a.on("succeeded",(function(e){r(e)})),a.on("cancelled",(function(e){return i(e)})),a.on("failed",(function(e){return i(e)})),a.start()}))}},{key:"get",value:(t=(0,i.default)(r.default.mark((function e(t){var n,i,s,a=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.cache.get(t))||this.isExpired(n.timestamp)){e.next=3;break}return e.abrupt("return",n.response);case 3:return i={},e.next=6,this.executeWithRetry((function(){return a.services.transport.get(t,i)}),this.retryWhenThrottled());case 6:return this.cache.set(t,{response:s=e.sent,timestamp:Date.now()}),this.pokeTimer(),e.abrupt("return",s);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.Network=p},a4io:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Media=function(){function e(t,n,r){_classCallCheck(this,e),this.config=t,this.network=n,this._update(r)}var t;return _createClass(e,[{key:"getContentUrl",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.network.get("".concat(this.config.baseUrl,"/").concat(this.sid));case 2:return t=e.sent,e.abrupt("return",(this._update(t.body),Promise.resolve(this.state.contentDirectUrl)));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_update",value:function(e){this.state={sid:e.sid,serviceSid:e.service_sid,channelSid:e.channel_sid,messageSid:e.message_sid,dateCreated:e.date_created?new Date(e.date_created):null,dateUpdated:e.date_updated?new Date(e.date_updated):null,size:e.size,contentType:e.content_type,url:e.url,contentUrl:e.links.content,contentDirectUrl:e.links.content_direct_temporary,filename:e.filename?e.filename:null}}},{key:"sid",get:function(){return this.state.sid}},{key:"serviceSid",get:function(){return this.state.serviceSid}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"fileName",get:function(){return this.state.filename}}]),e}()},"aAA+":function(e,t,n){var r=n("e7fL");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},aMvW:function(e,t,n){var r=n("JId3"),i=n("n40k"),s=i;s.v1=r,s.v4=i,e.exports=s},aRFn:function(e,t,n){var r=n("b1KM")("meta"),i=n("vbc5"),s=n("YVtA"),a=n("UwCj").f,o=0,u=Object.isExtensible||function(){return!0},c=!n("7S/a")((function(){return u(Object.preventExtensions({}))})),l=function(e){a(e,r,{value:{i:"O"+ ++o,w:{}}})},d=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,r)){if(!u(e))return"F";if(!t)return"E";l(e)}return e[r].i},getWeak:function(e,t){if(!s(e,r)){if(!u(e))return!0;if(!t)return!1;l(e)}return e[r].w},onFreeze:function(e){return c&&d.NEED&&u(e)&&!s(e,r)&&l(e),e}}},aSQu:function(e,t,n){"use strict";var r=n("IFjL"),i=n("rFq9"),s=n("hR4s"),a=n("SmK6"),o=n("Y0Jp");r(r.P+r.R,"Promise",{finally:function(e){var t=a(this,i.Promise||s.Promise),n="function"==typeof e;return this.then(n?function(n){return o(t,e()).then((function(){return n}))}:e,n?function(n){return o(t,e()).then((function(){throw n}))}:e)}})},aYSr:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"aq5/":function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},ax0Y:function(e,t,n){var r=n("YVtA"),i=n("MrWc"),s=n("ubhL")("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},b1KM:function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},b95h:function(e,t,n){var r=n("UwCj"),i=n("jHgz");e.exports=n("ObEa")?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},bDMy:function(e,t,n){var r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i;for(n=1;n<arguments.length;n++)for(i in r=arguments[n])r.hasOwnProperty(i)&&(e[i]=r[i]);return e}},function(e,t,n){"use strict";var r=n(0);e.exports={build:function(e,t){var n,i,s,a=t.plugins;for(n=0,i=a.length;n<i;n++)(s=a[n]).methods&&r(e,s.methods),s.properties&&Object.defineProperties(e,s.properties)},hook:function(e,t,n){var r,i,s,a=e.config.plugins,o=[e.context];for(n&&(o=o.concat(n)),r=0,i=a.length;r<i;r++)(s=a[r][t])&&s.apply(a[r],o)}}},function(e,t,n){"use strict";function r(e){if(0===e.length)return e;var t,n,r=e.split(/[_-]/);if(1===r.length&&r[0][0].toLowerCase()===r[0][0])return e;for(n=r[0].toLowerCase(),t=1;t<r.length;t++)n=n+r[t].charAt(0).toUpperCase()+r[t].substring(1).toLowerCase();return n}r.prepended=function(e,t){return e+(t=r(t))[0].toUpperCase()+t.substring(1)},e.exports=r},function(e,t,n){"use strict";var r=n(0),i=n(2);function s(e,t){this.options=e=e||{},this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}r(s.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=i.prepended("onEnter",e),this.lifecycle.onLeave[e]=i.prepended("onLeave",e),this.lifecycle.on[e]=i.prepended("on",e)},addTransition:function(e){this.transitions.indexOf(e)<0&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=i.prepended("onBefore",e),this.lifecycle.onAfter[e]=i.prepended("onAfter",e),this.lifecycle.on[e]=i.prepended("on",e)},mapTransition:function(e){var t=e.name,n=e.from,r=e.to;return this.addState(n),"function"!=typeof r&&this.addState(r),this.addTransition(t),this.map[n][t]=e,e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"==typeof e?this.mapTransition(r({},this.defaults.init,{to:e,active:!0})):"object"==typeof e?this.mapTransition(r({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"==typeof e?e:"object"==typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var n,r,i;for(n=0,r=(e=e||[]).length;n<r;n++)"function"==typeof(i=e[n])&&(e[n]=i=i()),i.configure&&i.configure(this);return e},configureTransitions:function(e){var t,n,r,i,s,a=this.defaults.wildcard;for(n=0;n<e.length;n++)for(r=e[n],i=Array.isArray(r.from)?r.from:[r.from||a],s=r.to||a,t=0;t<i.length;t++)this.mapTransition({name:r.name,from:i[t],to:s})},transitionFor:function(e,t){return this.map[e][t]||this.map[this.defaults.wildcard][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=s},function(e,t,n){var r=n(0),i=n(6),s=n(1),a=[null,[]];function o(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}r(o.prototype,{init:function(e){if(r(this.context,this.config.data.apply(this.context,e)),s.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?e.indexOf(this.state)>=0:this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var n=this.config.defaults.wildcard,r=this.config.transitionFor(this.state,e),i=r&&r.to;return"function"==typeof i?i.apply(this.context,t):i===n?this.state:i},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,n,r){var i=this.config.lifecycle,s=this.config.options.observeUnchangedState||t!==n;return n?this.isPending()?this.context.onPendingTransition(e,t,n):(this.config.addState(n),this.beginTransit(),r.unshift({transition:e,from:t,to:n,fsm:this.context}),this.observeEvents([this.observersForEvent(i.onBefore.transition),this.observersForEvent(i.onBefore[e]),s?this.observersForEvent(i.onLeave.state):a,s?this.observersForEvent(i.onLeave[t]):a,this.observersForEvent(i.on.transition),s?["doTransit",[this]]:a,s?this.observersForEvent(i.onEnter.state):a,s?this.observersForEvent(i.onEnter[n]):a,s?this.observersForEvent(i.on[n]):a,this.observersForEvent(i.onAfter.transition),this.observersForEvent(i.onAfter[e]),this.observersForEvent(i.on[e])],r)):this.context.onInvalidTransition(e,t,n)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,n=0,r=this.observers.length,i=[];n<r;n++)(t=this.observers[n])[e]&&i.push(t);return[e,i,!0]},observeEvents:function(e,t,n,r){if(0===e.length)return this.endTransit(void 0===r||r);var i=e[0][0],a=e[0][1],o=e[0][2];if(t[0].event=i,i&&o&&i!==n&&s.hook(this,"lifecycle",t),0===a.length)return e.shift(),this.observeEvents(e,t,i,r);var u=a.shift(),c=u[i].apply(u,t);return c&&"function"==typeof c.then?c.then(this.observeEvents.bind(this,e,t,i)).catch(this.failTransit.bind(this)):!1===c?this.endTransit(!1):this.observeEvents(e,t,i,c)},onInvalidTransition:function(e,t,n){throw new i("transition is invalid in current state",e,t,n,this.state)},onPendingTransition:function(e,t,n){throw new i("transition is invalid while previous transition is still in progress",e,t,n,this.state)}}),e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(2),s=n(1),a=n(3),o=n(4),u={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,n){return this._fsm.onInvalidTransition(e,t,n)},onPendingTransition:function(e,t,n){return this._fsm.onPendingTransition(e,t,n)}},c={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};function l(e){return d(this||{},e)}function d(e,t){return f(e,new a(t,l)),e._fsm(),e}function f(e,t){if("object"!=typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");s.build(e,t),Object.defineProperties(e,c),r(e,u),r(e,t.methods),t.allTransitions().forEach((function(t){e[i(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}})),e._fsm=function(){this._fsm=new o(this,t),this._fsm.init(arguments)}}l.version="3.0.1",l.factory=function(){var e,t;"function"==typeof arguments[0]?(e=arguments[0],t=arguments[1]||{}):(e=function(){this._fsm.apply(this,arguments)},t=arguments[0]||{});var n=new a(t,l);return f(e.prototype,n),e.prototype._fsm.config=n,e},l.apply=d,l.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=l},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){this.message=e,this.transition=t,this.from=n,this.to=r,this.current=i}}])},e.exports=r()},"c/HT":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("SbVi");t.TransportUnavailableError=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return n}(r.TwilsockError)},cDQD:function(e,t,n){"use strict";var r=v(n("QDM+")),i=v(n("tgXR")),s=v(n("XUND")),a=v(n("IhEH")),o=v(n("u2rs")),u=v(n("qCKU")),c=v(n("hjYm")),l=v(n("Rhu4")),d=v(n("aq5/")),f=v(n("4Mt5")),h=v(n("7xyS")),p=v(n("k2Qk"));function v(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var y=n("r2q8"),m=n("CPx3"),g=n("qRjN"),b=n("s5eF"),k=n("Xmnl"),_=n("RtQP"),w=m.Logger.scope("Channel"),x={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",type:"type",uniqueName:"uniqueName"};function C(e){try{return new Date(e)}catch(t){return null}}function S(e){switch(e){case"notParticipating":return"known";default:return e}}t.filterStatus=S;var T=function(e){function t(e,n,r){(0,d.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,l.default)(t)).call(this)),s=n.attributes||{},a=n.createdBy,f=C(n.dateCreated),p=C(n.dateUpdated),v=n.friendlyName||null,y=(0,c.default)(n.lastConsumedMessageIndex)?n.lastConsumedMessageIndex:null,m=n.uniqueName||null;try{(0,u.default)(s)}catch(b){throw new Error("Attributes must be a valid JSON object.")}return i.services=e,i.sid=r,i.entityName=n.channel,i.state={uniqueName:m,status:"known",type:n.type,attributes:s,createdBy:a,dateCreated:f,dateUpdated:p,friendlyName:v,lastConsumedMessageIndex:y},n.notificationLevel&&(i.state.notificationLevel=n.notificationLevel),i.members=new o.default,i.membersEntity=new g.Members(i,i.services,i.members),i.membersEntity.on("memberJoined",i.emit.bind(i,"memberJoined")),i.membersEntity.on("memberLeft",i.emit.bind(i,"memberLeft")),i.membersEntity.on("memberUpdated",(function(e){return i.emit("memberUpdated",e)})),i.messagesEntity=new k.Messages(i,e),i.messagesEntity.on("messageAdded",(function(e){return i._onMessageAdded(e)})),i.messagesEntity.on("messageUpdated",(function(e){return i.emit("messageUpdated",e)})),i.messagesEntity.on("messageRemoved",i.emit.bind(i,"messageRemoved")),i}var n,v,y,m,T,R,M,E,I,P,O,N,j,L,U,D,A,q,F,B,G,W,z,H,Q,X,J;return(0,p.default)(t,e),(0,f.default)(t,[{key:"_subscribe",value:function(){var e=this;return this.entityPromise?this.entityPromise:this.entityPromise=this.entityPromise||this.services.syncClient.document({id:this.entityName,mode:"open_existing"}).then((function(t){return e.entity=t,e.entity.on("updated",(function(t){e._update(t.value)})),e.entity.on("removed",(function(){return e.emit("removed",e)})),e._update(e.entity.value),t})).catch((function(t){throw e.entity=null,e.entityPromise=null,"disconnected"!=e.services.syncClient.connectionState&&w.error("Failed to get channel object",t),w.debug("ERROR: Failed to get channel object",t),t}))}},{key:"_subscribeStreams",value:(J=(0,a.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._subscribe();case 3:return w.trace("_subscribeStreams, this.entity.value=",this.entity.value),t=this.entity.value.messages,n=this.entity.value.roster,e.next=8,s.default.all([this.messagesEntity.subscribe(t),this.membersEntity.subscribe(n)]);case 8:e.next=15;break;case 10:throw e.prev=10,e.t0=e.catch(0),"disconnected"!==this.services.syncClient.connectionState&&w.error("Failed to subscribe on channel objects",this.sid,e.t0),w.debug("ERROR: Failed to subscribe on channel objects",this.sid,e.t0),e.t0;case 15:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return J.apply(this,arguments)})},{key:"_unsubscribe",value:(X=(0,a.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrivate||!this.entity){e.next=5;break}return e.next=3,this.entity.close();case 3:this.entity=null,this.entityPromise=null;case 5:return e.abrupt("return",s.default.all([this.membersEntity.unsubscribe(),this.messagesEntity.unsubscribe()]));case 6:case"end":return e.stop()}}),e,this)}))),function(){return X.apply(this,arguments)})},{key:"_setStatus",value:function(e,t){var n=this;this.statusSource=t,this.state.status!==e&&(this.state.status=e,"joined"===e?this._subscribeStreams().catch((function(t){if(w.debug("ERROR while setting channel status "+e,t),"disconnected"!==n.services.syncClient.connectionState)throw t})):"invited"===e?this._subscribe().catch((function(t){if(w.debug("ERROR while setting channel status "+e,t),"disconnected"!==n.services.syncClient.connectionState)throw t})):this.entityPromise&&this._unsubscribe().catch((function(t){if(w.debug("ERROR while setting channel status "+e,t),"disconnected"!==n.services.syncClient.connectionState)throw t})))}},{key:"_statusSource",value:function(){return this.statusSource}},{key:"_update",value:function(e){w.trace("_update",e);var n=[];for(var r in t.preprocessUpdate(e,this.sid),e){var i=x[r];if(i)if(i===x.status)e.status&&"unknown"!=e.status&&this.state.status!==S(e.status)&&(this.state.status=S(e.status),n.push(i));else if(i===x.attributes)_.isDeepEqual(this.state.attributes,e.attributes)||(this.state.attributes=e.attributes,n.push(i));else if(i===x.lastConsumedMessageIndex)void 0!==e.lastConsumedMessageIndex&&e.lastConsumedMessageIndex!==this.state.lastConsumedMessageIndex&&(this.state.lastConsumedMessageIndex=e.lastConsumedMessageIndex,n.push(i));else if(i===x.lastMessage){var s=!1;this.state.lastMessage&&!e.lastMessage?(delete this.state.lastMessage,s=!0):(this.state.lastMessage||(this.state.lastMessage={}),e.lastMessage&&void 0!==e.lastMessage.index&&e.lastMessage.index!==this.state.lastMessage.index&&(this.state.lastMessage.index=e.lastMessage.index,s=!0),!e.lastMessage||!e.lastMessage.timestamp||this.state.lastMessage.timestamp&&this.state.lastMessage.timestamp.getTime()===e.lastMessage.timestamp.getTime()||(this.state.lastMessage.timestamp=e.lastMessage.timestamp,s=!0),_.isDeepEqual(this.state.lastMessage,{})&&delete this.state.lastMessage),s&&n.push(i)}else e[r]instanceof Date?this.state[i]&&this.state[i].getTime()===e[r].getTime()||(this.state[i]=e[r],n.push(i)):this[i]!==e[r]&&(this.state[i]=e[r],n.push(i))}n.length>0&&this.emit("updated",{channel:this,updateReasons:n})}},{key:"_onMessageAdded",value:function(e){var t=!0,n=!1,i=void 0;try{for(var s,a=(0,r.default)(this.members.values());!(t=(s=a.next()).done);t=!0){var o=s.value;if(o.identity===e.author){o._endTyping();break}}}catch(u){n=!0,i=u}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}this.emit("messageAdded",e)}},{key:"add",value:(Q=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"string"==typeof t){e.next=2;break}throw new Error("Channel.add requires an <String>identity parameter");case 2:return e.abrupt("return",this.membersEntity.add(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return Q.apply(this,arguments)})},{key:"advanceLastConsumedMessageIndex",value:(H=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,c.default)(t)){e.next=2;break}throw new Error("Channel.advanceLastConsumedMessageIndex requires an integral <Number>index parameter");case 2:return e.next=4,this._subscribeStreams();case 4:return e.abrupt("return",this.services.consumptionHorizon.advanceLastConsumedMessageIndexForChannel(this.sid,t,this.lastConsumedMessageIndex));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return H.apply(this,arguments)})},{key:"decline",value:(z=(0,a.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("declineInvitation",{channelSid:this.sid});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return z.apply(this,arguments)})},{key:"delete",value:(W=(0,a.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("destroyChannel",{channelSid:this.sid});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return W.apply(this,arguments)})},{key:"getAttributes",value:(G=(0,a.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribe();case 2:return e.abrupt("return",this.attributes);case 3:case"end":return e.stop()}}),e,this)}))),function(){return G.apply(this,arguments)})},{key:"getMessages",value:(B=(0,a.default)(i.default.mark((function e(t,n,r){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n||(0,c.default)(n)){e.next=2;break}throw new Error("Anchor should be a valid message index");case 2:return e.next=4,this._subscribeStreams();case 4:return e.abrupt("return",this.messagesEntity.getMessages(t,n,r));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return B.apply(this,arguments)})},{key:"getMembers",value:(F=(0,a.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.membersEntity.getMembers());case 3:case"end":return e.stop()}}),e,this)}))),function(){return F.apply(this,arguments)})},{key:"getMembersCount",value:(q=(0,a.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.getSessionLinks();case 2:return t=new _.UriBuilder(e.sent.publicChannelsUrl).path(this.sid).build(),e.next=6,this.services.network.get(t);case 6:return e.abrupt("return",e.sent.body.members_count);case 8:case"end":return e.stop()}}),e,this)}))),function(){return q.apply(this,arguments)})},{key:"getMemberBySid",value:(A=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"string"==typeof t){e.next=2;break}throw new Error("Channel.getMemberBySid requires a <String>memberSid parameter");case 2:return e.abrupt("return",this.membersEntity.getMemberBySid(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"getMemberByIdentity",value:(D=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"string"==typeof t){e.next=2;break}throw new Error("Channel.getMemberByIdentity requires a <String>identity parameter");case 2:return e.abrupt("return",this.membersEntity.getMemberByIdentity(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"getMessagesCount",value:(U=(0,a.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.getSessionLinks();case 2:return t=new _.UriBuilder(e.sent.publicChannelsUrl).path(this.sid).build(),e.next=6,this.services.network.get(t);case 6:return e.abrupt("return",e.sent.body.messages_count);case 8:case"end":return e.stop()}}),e,this)}))),function(){return U.apply(this,arguments)})},{key:"getUnconsumedMessagesCount",value:(L=(0,a.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.getSessionLinks();case 2:return t=new _.UriBuilder(e.sent.myChannelsUrl).arg("ChannelSid",this.sid).build(),e.next=6,this.services.network.get(t);case 6:if(!(n=e.sent).body.channels.length||n.body.channels[0].channel_sid!=this.sid){e.next=11;break}if(void 0===n.body.channels[0].unread_messages_count||null==n.body.channels[0].unread_messages_count){e.next=10;break}return e.abrupt("return",n.body.channels[0].unread_messages_count);case 10:return e.abrupt("return",null);case 11:throw new Error("Channel is not in user channels list");case 12:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"invite",value:(j=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t&&t.length){e.next=2;break}throw new Error("Channel.invite requires an <String>identity parameter");case 2:return e.next=4,this.membersEntity.invite(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"join",value:(N=(0,a.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.session.addCommand("joinChannelV2",{channelSid:this.sid});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return N.apply(this,arguments)})},{key:"leave",value:(O=(0,a.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("joined"!==this.state.status){e.next=3;break}return e.next=3,this.services.session.addCommand("leaveChannel",{channelSid:this.sid});case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)}))),function(){return O.apply(this,arguments)})},{key:"removeMember",value:(P=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&("string"==typeof t||t instanceof b.Member)){e.next=2;break}throw new Error("Channel.removeMember requires a <String|Member>member parameter.");case 2:if(!(t instanceof b.Member)){e.next=7;break}return e.next=5,this.membersEntity.removeBySid(t.sid);case 5:e.next=9;break;case 7:return e.next=9,this.membersEntity.removeByIdentity(t);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return P.apply(this,arguments)})},{key:"sendMessage",value:(I=(0,a.default)(i.default.mark((function e(t,n){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}throw new Error("Message is required parameter");case 2:if("string"!=typeof t&&null!==t){e.next=9;break}return e.next=5,this.messagesEntity.send(t,n);case 5:return e.abrupt("return",_.parseToNumber(e.sent.messageId));case 9:return e.next=11,this.messagesEntity.sendMedia(t,n);case 11:return e.abrupt("return",_.parseToNumber(e.sent.messageId));case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return I.apply(this,arguments)})},{key:"setAllMessagesConsumed",value:(E=(0,a.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.next=4,this.getMessages(1);case 4:if(!((t=e.sent).items.length>0)){e.next=7;break}return e.abrupt("return",this.advanceLastConsumedMessageIndex(t.items[0].index));case 7:return e.abrupt("return",s.default.resolve(0));case 8:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"setNoMessagesConsumed",value:(M=(0,a.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.services.consumptionHorizon.updateLastConsumedMessageIndexForChannel(this.sid,null));case 3:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})},{key:"setUserNotificationLevel",value:(R=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("notificationLevel can't be null");case 2:return e.next=4,this.services.session.addCommand("editNotificationLevel",{channelSid:this.sid,notificationLevel:t});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"typing",value:function(){return this.services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:(T=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=4;break}throw new Error("Attributes is required parameter");case 4:if(null!==t){e.next=8;break}throw new Error("Attributes can't be null");case 8:if(t.constructor===Object){e.next=10;break}throw new Error("Attributes must be a valid JSON object.");case 10:return e.next=12,this.services.session.addCommand("editAttributes",{channelSid:this.sid,attributes:(0,u.default)(t)});case 12:return e.abrupt("return",this);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"updateFriendlyName",value:(m=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.friendlyName===t){e.next=3;break}return e.next=3,this.services.session.addCommand("editFriendlyName",{channelSid:this.sid,friendlyName:t});case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"updateLastConsumedMessageIndex",value:(y=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,c.default)(t)||null===t){e.next=2;break}throw new Error('Incorrect argument "index": integer number or null expected');case 2:return e.next=4,this._subscribeStreams();case 4:return e.abrupt("return",this.services.consumptionHorizon.updateLastConsumedMessageIndexForChannel(this.sid,t));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"updateUniqueName",value:(v=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.uniqueName===t){e.next=4;break}return t||(t=""),e.next=4,this.services.session.addCommand("editUniqueName",{channelSid:this.sid,uniqueName:t});case 4:return e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"getUserDescriptors",value:(n=(0,a.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.users.getChannelUserDescriptors(this.sid));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"status",get:function(){return this.state.status}},{key:"type",get:function(){return this.state.type}},{key:"uniqueName",get:function(){return this.state.uniqueName}},{key:"isPrivate",get:function(){return"private"===this.state.type}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"createdBy",get:function(){return this.state.createdBy}},{key:"attributes",get:function(){return this.state.attributes}},{key:"lastConsumedMessageIndex",get:function(){return this.state.lastConsumedMessageIndex}},{key:"lastMessage",get:function(){return this.state.lastMessage}},{key:"notificationLevel",get:function(){return this.state.notificationLevel}}],[{key:"preprocessUpdate",value:function(e,t){try{"string"==typeof e.attributes?e.attributes=JSON.parse(e.attributes):e.attributes&&(0,u.default)(e.attributes)}catch(n){w.warn("Retrieved malformed attributes from the server for channel: "+t),e.attributes={}}try{e.dateCreated&&(e.dateCreated=new Date(e.dateCreated))}catch(n){w.warn("Retrieved malformed dateCreated from the server for channel: "+t),delete e.dateCreated}try{e.dateUpdated&&(e.dateUpdated=new Date(e.dateUpdated))}catch(n){w.warn("Retrieved malformed dateUpdated from the server for channel: "+t),delete e.dateUpdated}try{e.lastMessage&&e.lastMessage.timestamp&&(e.lastMessage.timestamp=new Date(e.lastMessage.timestamp))}catch(n){w.warn("Retrieved malformed lastMessage.timestamp from the server for channel: "+t),delete e.lastMessage.timestamp}}}]),t}(y.EventEmitter);t.Channel=T},cvX4:function(e,t,n){var r=n("IFjL");r(r.P+r.R,"Set",{toJSON:n("KIy9")("Set")})},d5Ah:function(e,t,n){n("/r3m"),n("qqHg"),e.exports=n("rFq9").Array.from},dSFd:function(e,t,n){"use strict";var r=o(n("XUND")),i=o(n("u2rs")),s=o(n("4Mt5")),a=o(n("aq5/"));function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n("dWBN"),c=function(){function e(t){(0,a.default)(this,e),this.services=t,this.consumptionHorizonRequests=new i.default,this.consumptionHorizonUpdateTimer=null}return(0,s.default)(e,[{key:"getReportInterval",value:function(){return this.services.session.getConsumptionReportInterval().then((function(e){return 1e3*e}))}},{key:"delayedSendConsumptionHorizon",value:function(e){var t=this;null===this.consumptionHorizonUpdateTimer&&(this.sendConsumptionReport(!0),this.consumptionHorizonUpdateTimer=setTimeout((function(){t.sendConsumptionReport(!1)}),e))}},{key:"sendConsumptionReport",value:function(e){var t=this,n=[],r=new i.default;this.consumptionHorizonRequests.forEach((function(e,t){n.push(e.entry),r.set(t,e.promises)})),n.length>0&&this.services.session.addCommand("consumptionReportV2",{report:n}).then((function(e){return t.processConsumptionReportResponse(e,r)})).catch((function(e){return t.processConsumptionReportError(e,r)})),e||(this.consumptionHorizonUpdateTimer=null),this.consumptionHorizonRequests.clear()}},{key:"processConsumptionReportResponse",value:function(e,t){e&&e.report&&Array.isArray(e.report)&&e.report.length>0&&e.report.forEach((function(e){var n=e;if(t.has(n.channelSid)){var r=null;void 0!==n.unreadMessagesCount&&null!=n.unreadMessagesCount&&(r=n.unreadMessagesCount),t.get(n.channelSid).forEach((function(e){return e.resolve(r)})),t.delete(n.channelSid)}})),this.processConsumptionReportError(new u.SessionError("Error while setting LastConsumedMessageIndex",null),t)}},{key:"processConsumptionReportError",value:function(e,t){t.forEach((function(t){return t.forEach((function(t){return t.reject(e)}))}))}},{key:"updateLastConsumedMessageIndexForChannel",value:function(e,t){var n=this;return new r.default((function(r,i){n.addPendingConsumptionHorizonRequest(e,{channelSid:e,messageIdx:t},{resolve:r,reject:i}),n.getReportInterval().then((function(e){return n.delayedSendConsumptionHorizon(e)}))}))}},{key:"advanceLastConsumedMessageIndexForChannel",value:function(e,t,n){var i=this,s=this.consumptionHorizonRequests.get(e);return new r.default((function(r,a){i.addPendingConsumptionHorizonRequest(e,s&&s.entry?s.entry.messageIdx>=t?s.entry:{channelSid:e,messageIdx:t}:null!==n&&t<n?{channelSid:e,messageIdx:n}:{channelSid:e,messageIdx:t},{resolve:r,reject:a}),i.getReportInterval().then((function(e){return i.delayedSendConsumptionHorizon(e)}))}))}},{key:"addPendingConsumptionHorizonRequest",value:function(e,t,n){if(this.consumptionHorizonRequests.has(e)){var r=this.consumptionHorizonRequests.get(e);r.entry=t,r.promises.push(n)}else this.consumptionHorizonRequests.set(e,{entry:t,promises:[n]})}}]),e}();t.ConsumptionHorizon=c},dUHx:function(e,t){},dWBN:function(e,t,n){"use strict";var r=d(n("XaWT")),i=d(n("p2b6")),s=d(n("oPEB")),a=d(n("5JVr")),o=d(n("Rhu4")),u=d(n("aq5/")),c=d(n("7xyS")),l=d(n("k2Qk"));function d(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){function t(e,n){(0,u.default)(this,t);var r=(0,c.default)(this,(t.__proto__||(0,o.default)(t)).call(this));return r.name=r.constructor.name,r.message=e,r.code=n,Error.captureStackTrace?Error.captureStackTrace(r,r.constructor):r.stack=(new Error).stack,r}return(0,l.default)(t,e),t}(function(e){function t(){var t=(0,a.default)(e,(0,s.default)(arguments));return(0,i.default)(t,(0,o.default)(this)),t}return t.prototype=(0,r.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i.default?(0,i.default)(t,e):t.__proto__=e,t}(Error));t.SessionError=f},dWRk:function(e,t,n){var r=n("Vzpu");e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},dWcX:function(e,t,n){t.f=n("eD9m")},dptC:function(e,t){t.f=Object.getOwnPropertySymbols},"e/PS":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("r2q8"),i=n("Sqfg"),s=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this)).closed=!1,e.uuid=i(),e}return _createClass(n,[{key:"close",value:function(){this.removeAllListeners(),this.closed=!0}},{key:"ensureNotClosed",value:function(){if(this.closed)throw new Error("Invalid operation on closed object")}},{key:"listenerUuid",get:function(){return this.uuid}}]),n}(r.EventEmitter);t.Closeable=s,t.default=s},e5bQ:function(e,t,n){e.exports={default:n("CHRr"),__esModule:!0}},e7fL:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},eD9m:function(e,t,n){var r=n("kz3d")("wks"),i=n("b1KM"),s=n("hR4s").Symbol,a="function"==typeof s;(e.exports=function(e){return r[e]||(r[e]=a&&s[e]||(a?s:i)("Symbol."+e))}).store=r},fawX:function(e,t,n){var r=n("tReM"),i=n("eD9m")("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||s[i]===e)}},fquK:function(e,t,n){"use strict";var r=n("Vzpu"),i=n("vbc5"),s=n("IAQa"),a=[].slice,o={},u=function(e,t,n){if(!(t in o)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";o[t]=Function("F,a","return new F("+r.join(",")+")")}return o[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),o=function r(){var i=n.concat(a.call(arguments));return this instanceof r?u(t,i.length,i):s(t,i,e)};return i(t.prototype)&&(o.prototype=t.prototype),o}},"gNE/":function(e,t,n){var r=n("e7fL");e.exports=Array.isArray||function(e){return"Array"==r(e)}},gSK9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("SbVi");t.TwilsockReplyError=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this,e)).reply=r,i}return n}(r.TwilsockError)},"gm/K":function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},grU3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e);var r=n.notifications||{};this.registrarUrl=r.ersUrl||"https://ers.".concat(r.region||n.region||"us1",".twilio.com/v1/registrations"),this._token=t}return _createClass(e,[{key:"updateToken",value:function(e){this._token=e}},{key:"token",get:function(){return this._token}}]),e}()},guEv:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},hR4s:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},hjYm:function(e,t,n){e.exports={default:n("P0Gn"),__esModule:!0}},hoXw:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},hsRX:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("BHqR");t.Message=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var s;return _classCallCheck(this,n),(s=t.call(this)).method="message",s.active_grant=e,s.payload_type=r,s.http_request=i,s}return n}(r.AbstractMessage)},iBdP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("r2q8"),i=n("N8HJ");t.WebSocketChannel=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var i;return _classCallCheck(this,r),(i=t.call(this)).url=e,i.WebSocket=global.WebSocket||global.MozWebSocket||n(4),i}return _createClass(r,[{key:"connect",value:function(){var e=this;i.log.trace("connecting to socket");var t=new this.WebSocket(this.url);t.binaryType="arraybuffer",t.onopen=function(){i.log.debug("socket opened ".concat(e.url)),e.emit("connected")},t.onclose=function(t){i.log.debug("socket closed",t),e.emit("disconnected",t)},t.onerror=function(t){i.log.debug("error:",t),e.emit("socketError",t)},t.onmessage=function(t){e.emit("message",t.data)},this.socket=t}},{key:"send",value:function(e){this.socket.send(e)}},{key:"close",value:function(){if(i.log.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}},{key:"isConnected",get:function(){return this.socket&&1===this.socket.readyState}}]),r}(r.EventEmitter)},iaOj:function(e,t,n){"use strict";var r=n("IFjL");e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},ihyG:function(e,t,n){"use strict";function r(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function i(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){void 0===e&&(e=[""]),this.tokens=e}return e.fromJSON=function(t){var n=t.split("/").map(r);if(""!==n[0])throw new Error("Invalid JSON Pointer: "+t);return new e(n)},e.prototype.toString=function(){return this.tokens.map(i).join("/")},e.prototype.evaluate=function(e){for(var t=null,n="",r=e,i=1,s=this.tokens.length;i<s;i++)r=((t=r)||{})[n=this.tokens[i]];return{parent:t,key:n,value:r}},e.prototype.get=function(e){return this.evaluate(e).value},e.prototype.set=function(e,t){for(var n=e,r=1,i=this.tokens.length-1,s=this.tokens[r];r<i;r++)n=(n||{})[s];n&&(n[this.tokens[this.tokens.length-1]]=t)},e.prototype.push=function(e){this.tokens.push(e)},e.prototype.add=function(t){return new e(this.tokens.concat(String(t)))},e}();t.Pointer=s},"j/aJ":function(e,t,n){"use strict";var r=n("wOJj"),i=n("MIMp"),s=n("tReM"),a=n("Hs7Z");e.exports=n("S49y")(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),s.Arguments=s.Array,r("keys"),r("values"),r("entries")},jHgz:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},jIkG:function(e,t,n){var r,i,s=n("nwbp"),a=n("KQtV"),o=0,u=0;e.exports=function(e,t,n){var c=t&&n||0,l=t||[],d=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==f){var h=s();null==d&&(d=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==f&&(f=i=16383&(h[6]<<8|h[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:u+1,y=p-o+(v-u)/1e4;if(y<0&&void 0===e.clockseq&&(f=f+1&16383),(y<0||p>o)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=p,u=v,i=f;var m=(1e4*(268435455&(p+=122192928e5))+v)%4294967296;l[c++]=m>>>24&255,l[c++]=m>>>16&255,l[c++]=m>>>8&255,l[c++]=255&m;var g=p/4294967296*1e4&268435455;l[c++]=g>>>8&255,l[c++]=255&g,l[c++]=g>>>24&15|16,l[c++]=g>>>16&255,l[c++]=f>>>8|128,l[c++]=255&f;for(var b=0;b<6;++b)l[c+b]=d[b];return t||a(l)}},jJPU:function(e,t,n){var r=n("hoXw"),i=n("5YqI");e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[s+o]=a[o];return t||i(a)}},k2Qk:function(e,t,n){"use strict";t.__esModule=!0;var r=a(n("p2b6")),i=a(n("XaWT")),s=a(n("2tcU"));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,s.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}},kGNy:function(e,t,n){e.exports={default:n("Rk1W"),__esModule:!0}},kcEc:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("BHqR");t.Update=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).method="update",r.token=e,r}return n}(r.AbstractMessage)},kz3d:function(e,t,n){var r=n("rFq9"),i=n("hR4s"),s=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n("UtsQ")?"pure":"global",copyright:"\xa9 2019 Denis Pushkarev (zloirock.ru)"})},l9m5:function(e,t,n){"use strict";var r=c(n("tgXR")),i=c(n("IhEH")),s=c(n("XUND")),a=c(n("u2rs")),o=c(n("4Mt5")),u=c(n("aq5/"));function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=n("aMvW"),d=n("CmQt"),f=n("3eIt"),h=n("CPx3"),p=n("dWBN"),v=n("9F0I"),y=n("7ae9"),m=n("G1hA").version,g=h.Logger.scope("Session"),b=function e(){(0,u.default)(this,e)},k=function(){function e(t,n){(0,u.default)(this,e);var r="undefined"!=typeof navigator?d.parse(navigator.userAgent):d;this.services=t,this.config=n,this.sessionInfo=new v.Deferred,this.currentContext={},this.pendingCommands=new a.default,this.sessionStreamPromise=null,this.endpointPlatform=["js",m,r.os,r.name,r.version].join("|")}var t,n,c,h,k,_;return(0,o.default)(e,[{key:"handleContextUpdate",value:function(e){var t;g.info("Session context updated"),g.debug("new session context:",e),this.currentContext=e,t=e,["identity","userInfo","links","myChannels","channels"].some((function(e){return!t.hasOwnProperty(e)}))||(g.info("new session context accepted"),this.sessionInfo.set(e))}},{key:"initialize",value:function(){var e=this;return this.sessionStreamPromise=this.services.syncClient.list({purpose:"com.twilio.rtd.ipmsg",context:{type:"IpMsgSession",apiVersion:"3",endpointPlatform:this.endpointPlatform}}).then((function(t){return g.info("Session created",t.sid),t.on("itemAdded",(function(t){return e.processCommandResponse(t.item)})),t.on("itemUpdated",(function(t){return e.processCommandResponse(t.item)})),t.on("contextUpdated",(function(t){return e.handleContextUpdate(t.context)})),t})).catch((function(e){throw g.error("Failed to create session",e),e})),this.sessionStreamPromise}},{key:"addCommand",value:function(e,t){return this.processCommand(e,t)}},{key:"processCommand",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=new b;return i.request=t,i.request.action=e,i.commandId=l.v4(),g.info("Adding command: ",e,i.commandId),g.debug("command arguments:",t,r),new s.default((function(s,a){n.sessionStreamPromise.then((function(e){return n.pendingCommands.set(i.commandId,{resolve:s,reject:a,commandId:i.commandId,request:i.request}),e.push(i)})).then((function(){return g.debug("Command accepted by server",i.commandId)})).catch((function(o){n.pendingCommands.delete(i.commandId),g.error("Failed to add a command to the session",o),o.code!=f.ResponseCodes.ACCESS_FORBIDDEN_FOR_IDENTITY&&o.code!==f.ResponseCodes.LIST_NOT_FOUND||!r?a(new Error("Can't add command: "+o.message)):(g.info("recreating session..."),n.initialize(),s(n.processCommand(e,t,!1)))}))}))}},{key:"processCommandResponse",value:function(e){if(e.value.hasOwnProperty("response")&&e.value.hasOwnProperty("commandId")&&this.pendingCommands.has(e.value.commandId)){var t=e.value,n=e.value.commandId;if(t.response.status===f.ResponseCodes.HTTP_200_OK){g.debug("Command succeeded: ",t);var r=this.pendingCommands.get(n).resolve;this.pendingCommands.delete(n),r(t.response)}else{g.error("Command failed: ",t);var i=this.pendingCommands.get(n).reject;this.pendingCommands.delete(n),i(new p.SessionError(t.response.statusText,t.response.status))}}}},{key:"getSessionContext",value:function(){return this.sessionStreamPromise.then((function(e){return e.getContext()}))}},{key:"getSessionLinks",value:(_=(0,i.default)(r.default.mark((function e(){var t;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionInfo.promise;case 2:return e.abrupt("return",{publicChannelsUrl:this.config.baseUrl+(t=e.sent).links.publicChannelsUrl,myChannelsUrl:this.config.baseUrl+t.links.myChannelsUrl,typingUrl:this.config.baseUrl+t.links.typingUrl,syncListUrl:this.config.baseUrl+t.links.syncListUrl,usersUrl:this.config.baseUrl+t.links.usersUrl,mediaServiceUrl:t.links.mediaServiceUrl});case 4:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"getChannelsId",value:(k=(0,i.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionInfo.promise;case 2:return e.abrupt("return",e.sent.channels);case 4:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"getMyChannelsId",value:(h=(0,i.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionInfo.promise;case 2:return e.abrupt("return",e.sent.myChannels);case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"getMaxUserInfosToSubscribe",value:(c=(0,i.default)(r.default.mark((function e(){var t;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionInfo.promise;case 2:return t=e.sent,e.abrupt("return",this.config.userInfosToSubscribeOverride||t.userInfosToSubscribe||this.config.userInfosToSubscribeDefault);case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"getUsersData",value:function(){return this.sessionInfo.promise.then((function(e){return{user:e.userInfo,identity:e.identity}}))}},{key:"getConsumptionReportInterval",value:(n=(0,i.default)(r.default.mark((function e(){var t,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSessionContext();case 2:return t=e.sent,n=this.config.consumptionReportIntervalOverride||t.consumptionReportInterval||this.config.consumptionReportIntervalDefault,e.prev=4,e.abrupt("return",y.toSeconds(y.parse(n)));case 8:return e.prev=8,e.t0=e.catch(4),g.error("Failed to parse consumption report interval",n,"using default value",this.config.consumptionReportIntervalDefault),e.abrupt("return",y.toSeconds(y.parse(this.config.consumptionReportIntervalDefault)));case 12:case"end":return e.stop()}}),e,this,[[4,8]])}))),function(){return n.apply(this,arguments)})},{key:"getHttpCacheInterval",value:(t=(0,i.default)(r.default.mark((function e(){var t,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSessionContext();case 2:return t=e.sent,n=this.config.httpCacheIntervalOverride||t.httpCacheInterval||this.config.httpCacheIntervalDefault,e.prev=4,e.abrupt("return",y.toSeconds(y.parse(n)));case 8:return e.prev=8,e.t0=e.catch(4),g.error("Failed to parse cache interval",n,"using default value",this.config.httpCacheIntervalDefault),e.abrupt("return",y.toSeconds(y.parse(this.config.httpCacheIntervalDefault)));case 12:case"end":return e.stop()}}),e,this,[[4,8]])}))),function(){return t.apply(this,arguments)})},{key:"identity",get:function(){return this.sessionInfo.current.identity}},{key:"reachabilityEnabled",get:function(){return this.currentContext.reachabilityEnabled}}]),e}();t.Session=k},lKIr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("sc67");function i(e){return!isNaN(parseInt(e))&&isFinite(e)}function s(e){return i(e)&&e>=0}t.deepClone=function(e){return JSON.parse(JSON.stringify(e))},t.validateOptionalTtl=function(e){if(void 0!==e&&!s(e))throw new r.default("Invalid TTL value, expected a positive integer, was '".concat(e,"'"),400,54011)},t.validateMandatoryTtl=function(e){if(!s(e))throw new r.default("Invalid TTL value, expected a positive integer, was '".concat(e,"'"),400,54011)},t.validatePageSize=function(e){var t;if(!(void 0===e||i(t=e)&&t>0))throw new r.default("Invalid pageSize parameter. Expected a positive integer, was '".concat(e,"'."),400,54455)}},lPsM:function(e,t,n){var r=n("jIkG"),i=n("WLcV"),s=i;s.v1=r,s.v4=i,e.exports=s},lgJq:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e);var n,r,i=t.cdsUri||"https://cds.".concat(t.region||"us1",".twilio.com");this.settings={subscriptionsUri:i+"/v4/Subscriptions",documentsUri:i+"/v3/Documents",listsUri:i+"/v3/Lists",mapsUri:i+"/v3/Maps",streamsUri:i+"/v3/Streams",insightsUri:i+"/v3/Insights",sessionStorageEnabled:(n=t.Sync,r="enableSessionStorage",!n||void 0===n[r]||n[r])}}return _createClass(e,[{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"streamsUri",get:function(){return this.settings.streamsUri}},{key:"insightsUri",get:function(){return this.settings.insightsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}}]),e}()},lkbt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("s23o"),i=n("zaPo"),s=n("a4io");t.Media=s.Media,t.McsMedia=s.Media;var a=n("UusA"),o=n("QyXE"),u=r.Logger.scope(""),c=n("qPqR").version,l="A valid Twilio token should be provided",d=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(_classCallCheck(this,e),this.options=r,this.options.logLevel=this.options.logLevel||"silent",this.config=new i.Configuration(t,n,this.options),!t)throw new Error(l);u.setLevel(this.options.logLevel),this.options.transport=this.options.transport||new a.Transport,this.transport=this.options.transport,this.network=new o.Network(this.config,this.transport)}var t,n,r;return _createClass(e,[{key:"updateToken",value:function(e){if(u.info("updateToken"),!e)throw new Error(l);this.config.updateToken(e)}},{key:"get",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.network.get("".concat(this.config.baseUrl,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",new s.Media(this.config,this.network,n.body));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"post",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.network.post(this.config.baseUrl,n,t);case 2:return r=e.sent,e.abrupt("return",new s.Media(this.config,this.network,r.body));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"postFormData",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.network.post(this.config.baseUrl,t);case 2:return n=e.sent,e.abrupt("return",new s.Media(this.config,this.network,n.body));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.Client=d,t.McsClient=d,d.version=c,t.default=d},llpV:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(t,n){_classCallCheck(this,e),this.balanceFactor=0,this.key=t,this.value=n,this.parent=null,this.left=null,this.right=null}return _createClass(e,[{key:"update",value:function(e){this.value=e}},{key:"replace",value:function(e,t){e&&(this.left===t?this.left=t:this.right===t&&(this.right=t))}},{key:"isRoot",get:function(){return null===this.parent}},{key:"isLeaf",get:function(){return null===this.left&&null===this.right}},{key:"isLeftChild",get:function(){return this.parent.left===this}}]),e}();t.TreeMap=function(){function e(t,n){_classCallCheck(this,e),this.isLessThan=t||function(e,t){return e<t},this.isEqual=n||function(e,t){return e===t},this.root=null,this.count=null}return _createClass(e,[{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(e,t){var n=this.getNode(e);n?n.update(t):this.insert(e,t)}},{key:"insert",value:function(e,t){var n=new r(e,t);if(this.count++,this.root){for(var i=this.root;;)if(this.isLessThan(e,i.key)){if(!i.left){i.left=n;break}i=i.left}else{if(!i.right){i.right=n;break}i=i.right}for(n.parent=i,i=n;i.parent;){var s=i.parent,a=s.balanceFactor;if(i.isLeftChild?s.balanceFactor++:s.balanceFactor--,Math.abs(s.balanceFactor)<Math.abs(a))break;if(s.balanceFactor<-1||s.balanceFactor>1){this.rebalance(s);break}i=s}}else this.root=n}},{key:"get",value:function(e){for(var t=this.root;t;){if(this.isEqual(e,t.key))return t.value;t=this.isLessThan(e,t.key)?t.left:t.right}return null}},{key:"delete",value:function(e){var t=this.getNode(e);if(!t||t.key!==e)return null;var n=t.parent,r=t.left,i=t.right;if(!!r!=!!i){var s=r||i;n||s?n&&!s?this.root=s:(n.replace(t,null),this.rebalance(n)):this.root=null}else{for(var a=t.left;a.right;)a=a.right;if(t.left===a)t.isRoot?(this.root=a,a.parent=null):(t.isLeftChild?t.parent.left=a:t.parent.right=a,a.parent=t.parent),a.right=t.right,a.right.parent=a,a.balanceFactor=t.balanceFactor,t={parent:a,isLeftChild:!0};else{var o=a.parent,u=a.left;o.right=u,u&&(u.parent=o),t.isRoot?(this.root=a,a.parent=null):(t.isLeftChild?t.parent.left=a:t.parent.right=a,a.parent=t.parent),a.right=t.right,a.right.parent=a,a.left=t.left,a.left.parent=a,a.balanceFactor=t.balanceFactor,t={parent:o,isLeftChild:!1}}}for(this.count--;t.parent;){var c=t.parent,l=c.balanceFactor;if(t.isLeftChild?c.balanceFactor-=1:c.balanceFactor+=1,Math.abs(c.balanceFactor)>Math.abs(l)){if(!(c.balanceFactor<-1||c.balanceFactor>1))break;if(this.rebalance(c),0!==c.parent.balanceFactor)break;t=c.parent}else t=c}return null}},{key:"getNode",value:function(e){for(var t=this.root;t;){if(this.isEqual(e,t.key))return t;t=this.isLessThan(e,t.key)?t.left:t.right}return null}},{key:"rebalance",value:function(e){e.balanceFactor<0?e.right.balanceFactor>0?(this.rotateRight(e.right),this.rotateLeft(e)):this.rotateLeft(e):e.balanceFactor>0&&(e.left.balanceFactor<0?(this.rotateLeft(e.left),this.rotateRight(e)):this.rotateRight(e))}},{key:"rotateLeft",value:function(e){var t=e.right;e.right=t.left,null!==t.left&&(t.left.parent=e),t.parent=e.parent,null===t.parent?this.root=t:e.isLeftChild?t.parent.left=t:t.parent.right=t,t.left=e,e.parent=t,e.balanceFactor=e.balanceFactor+1-Math.min(t.balanceFactor,0),t.balanceFactor=t.balanceFactor+1-Math.max(e.balanceFactor,0)}},{key:"rotateRight",value:function(e){var t=e.left;e.left=t.right,null!==t.right&&(t.right.parent=e),t.parent=e.parent,null===t.parent?this.root=t:e.isLeftChild?t.parent.left=t:t.parent.right=t,t.right=e,e.parent=t,e.balanceFactor=e.balanceFactor-1-Math.min(t.balanceFactor,0),t.balanceFactor=t.balanceFactor-1-Math.max(e.balanceFactor,0)}},{key:Symbol.iterator,value:regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(this.getIterator()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,r;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"getIterator",value:regeneratorRuntime.mark((function e(){var t,n,r,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=i.length>0&&void 0!==i[0]?i[0]:null,n=this.root;n&&!this.isEqual(t,n.key)&&(null!==t||n.left);)n=this.isLessThan(t,n.key)||null===t?n.left:n.right;if(n){e.next=5;break}return e.abrupt("return",null);case 5:r=!0;case 6:if(!r){e.next=20;break}return e.next=9,[n.key,n.value];case 9:if(r=!1,!n.right){e.next=15;break}for(n=n.right;n.left;)n=n.left;r=!0,e.next=18;break;case 15:if(n.parent){e.next=17;break}return e.abrupt("break",25);case 17:r=n.parent.left===n,n=n.parent;case 18:e.next=23;break;case 20:if(n.parent){e.next=22;break}return e.abrupt("break",25);case 22:r=n.parent.left===n,n=n.parent;case 23:e.next=6;break;case 25:return e.abrupt("return",null);case 26:case"end":return e.stop()}}),e,this)}))},{key:"getReverseIterator",value:regeneratorRuntime.mark((function e(){var t,n,r,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=i.length>0&&void 0!==i[0]?i[0]:null,n=this.root;n&&!this.isEqual(t,n.key)&&(null!==t||n.right);)n=this.isLessThan(t,n.key)&&null!==t?n.left:n.right;if(n){e.next=5;break}return e.abrupt("return",null);case 5:r=!0;case 6:if(!r){e.next=20;break}return e.next=9,[n.key,n.value];case 9:if(r=!1,!n.left){e.next=15;break}for(n=n.left;n.right;)n=n.right;r=!0,e.next=18;break;case 15:if(n.parent){e.next=17;break}return e.abrupt("break",25);case 17:r=n.parent.right===n,n=n.parent;case 18:e.next=23;break;case 20:if(n.parent){e.next=22;break}return e.abrupt("break",25);case 22:r=n.parent.right===n,n=n.parent;case 23:e.next=6;break;case 25:return e.abrupt("return",null);case 26:case"end":return e.stop()}}),e,this)}))},{key:"size",get:function(){return this.count}}]),e}()},"m+l7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.prototype.hasOwnProperty;function i(e){return void 0===e?"undefined":null===e?"null":Array.isArray(e)?"array":typeof e}t.objectType=i,t.compare=function e(t,n){if(t===n)return!0;var s=i(t),a=i(n);return"array"==s&&"array"==a?function(t,n){var r=t.length;if(r!==n.length)return!1;for(var i=0;i<r;i++)if(!e(t[i],n[i]))return!1;return!0}(t,n):"object"==s&&"object"==a&&function(t,n){var i=Object.keys(t),s=Object.keys(n),a=i.length;if(a!==s.length)return!1;for(var o=0;o<a;o++){var u=i[o];if(!r.call(n,u)||!e(t[u],n[u]))return!1}return!0}(t,n)}},mFO2:function(e,t){!function(t){"use strict";var n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag",u="object"==typeof e,c=t.regeneratorRuntime;if(c)u&&(e.exports=c);else{(c=t.regeneratorRuntime=u?e.exports:{}).wrap=v;var l={},d={};d[s]=function(){return this};var f=Object.getPrototypeOf,h=f&&f(f(T([])));h&&h!==n&&r.call(h,s)&&(d=h);var p=b.prototype=m.prototype=Object.create(d);g.prototype=p.constructor=b,b.constructor=g,b[o]=g.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(p),e},c.awrap=function(e){return{__await:e}},k(_.prototype),_.prototype[a]=function(){return this},c.AsyncIterator=_,c.async=function(e,t,n,r){var i=new _(v(e,t,n,r));return c.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(p),p[o]="Generator",p[s]=function(){return this},p.toString=function(){return"[object Generator]"},c.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},c.values=T,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(o&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}}}function v(e,t,n,r){var i=Object.create((t&&t.prototype instanceof m?t:m).prototype),s=new S(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(i,s){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw s;return{value:void 0,done:!0}}for(n.method=i,n.arg=s;;){var a=n.delegate;if(a){var o=w(a,n);if(o){if(o===l)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=y(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,s),i}function y(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}function m(){}function g(){}function b(){}function k(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function _(e){var t;this._invoke=function(n,i){function s(){return new Promise((function(t,s){!function t(n,i,s,a){var o=y(e[n],e,i);if("throw"!==o.type){var u=o.arg,c=u.value;return c&&"object"==typeof c&&r.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,s,a)}),(function(e){t("throw",e,s,a)})):Promise.resolve(c).then((function(e){u.value=e,s(u)}),a)}a(o.arg)}(n,i,t,s)}))}return t=t?t.then(s,s):s()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=y(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function T(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}}(function(){return this}()||Function("return this")())},mrFV:function(e,t,n){var r=n("vbc5"),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},n40k:function(e,t,n){var r=n("gm/K"),i=n("1ppQ");e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[s+o]=a[o];return t||i(a)}},nNrO:function(e,t,n){var r=n("IFjL"),i=n("yew7"),s=n("Vzpu"),a=n("8fQz"),o=n("vbc5"),u=n("7S/a"),c=n("fquK"),l=(n("hR4s").Reflect||{}).construct,d=u((function(){function e(){}return!(l((function(){}),[],e)instanceof e)})),f=!u((function(){l((function(){}))}));r(r.S+r.F*(d||f),"Reflect",{construct:function(e,t){s(e),a(t);var n=arguments.length<3?e:s(arguments[2]);if(f&&!d)return l(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(c.apply(e,r))}var u=n.prototype,h=i(o(u)?u:Object.prototype),p=Function.apply.call(e,h,t);return o(p)?p:h}})},nX7j:function(e,t,n){var r=n("IFjL");r(r.S,"Object",{create:n("yew7")})},nwbp:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},nzL3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("qXWz"),i=n("5ZaL"),s=n("EtEV");t.Connector=s.Connector;var a={min:2e3,max:12e4,randomness:.2};t.RegistrarConnector=function(e){_inherits(u,e);var t,n,s,o=_createSuper(u);function u(e,t,n,r){var i;return _classCallCheck(this,u),(i=o.call(this,r)).channelType=e,i.context=t,i.transport=n,i}return _createClass(u,[{key:"updateRegistration",value:(s=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.has("notificationId"),!e.t0){e.next=4;break}return e.next=4,this.removeRegistration();case 4:if(!t.notificationId||!t.notificationId.length){e.next=10;break}return e.next=7,this.register(t);case 7:e.t1=t,e.next=11;break;case 10:e.t1=t;case 11:return e.abrupt("return",e.t1);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"removeRegistration",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.registrationId){e.next=2;break}return e.abrupt("return");case 2:return t="".concat(this.config.registrarUrl,"/").concat(this.registrationId,"?productId=").concat(this.context.productId),n={"Content-Type":"application/json","X-Twilio-Token":this.config.token},e.prev=3,i.log.trace("Removing registration for ",this.channelType),e.next=7,new r.Retrier(Object.assign(a,{maxAttemptsCount:3})).run((function(){return s.transport.delete(t,n)}));case 7:i.log.debug("Registration removed for",this.channelType),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(3),i.log.error("Failed to remove of registration ",this.channelType,e.t0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(){return n.apply(this,arguments)})},{key:"register",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,s,o,u,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.log.trace("Registering",this.channelType,t),n={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(t.messageTypes),data:{registration_id:t.notificationId},ttl:"PT24H"},s="".concat(this.config.registrarUrl,"?productId=").concat(this.context.productId),o={"Content-Type":"application/json","X-Twilio-Token":t.token},i.log.trace("Creating registration for channel ",this.channelType),e.prev=4,e.next=7,new r.Retrier(a).run((function(){return c.transport.post(s,o,n)}));case 7:u=e.sent,this.registrationId=u.body.id,i.log.debug("Registration created: ",u),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(4),i.log.error("Registration failed: ",e.t0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(e){return t.apply(this,arguments)})}]),u}(s.Connector)},oPEB:function(e,t,n){e.exports={default:n("d5Ah"),__esModule:!0}},oi0w:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("SbVi");t.TwilsockUpstreamError=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var s;return _classCallCheck(this,n),(s=t.call(this,r)).status=e,s.description=r,s.body=i,s}return n}(r.TwilsockError)},p2b6:function(e,t,n){e.exports={default:n("OoA2"),__esModule:!0}},p87M:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("+t7B");t.SyncClient=r.SyncClient;var i=n("tcGR");t.SyncDocument=i.SyncDocument;var s=n("W27V");t.SyncList=s.SyncList;var a=n("+fds");t.SyncListItem=a.ListItem;var o=n("B3fw");t.SyncMap=o.SyncMap;var u=n("tTO9");t.SyncMapItem=u.MapItem,t.default=r.SyncClient,e.exports=r.SyncClient,e.exports.SyncClient=r.SyncClient},pagH:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("BHqR");t.Close=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this)).method="close",e}return n}(r.AbstractMessage)},qCKU:function(e,t,n){e.exports={default:n("2YE3"),__esModule:!0}},qPgj:function(e,t,n){"use strict";var r=o(n("tgXR")),i=o(n("IhEH")),s=o(n("aq5/")),a=o(n("4Mt5"));function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(t,n){(0,s.default)(this,e),this.mcsMedia=null,this.services=n,this.state={sid:t.sid,filename:t.filename,contentType:t.contentType,size:t.size}}var t;return(0,a.default)(e,[{key:"getContentUrl",value:(t=(0,i.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mcsMedia){e.next=8;break}if(!this.services.mcsClient){e.next=7;break}return e.next=4,this.services.mcsClient.get(this.state.sid);case 4:this.mcsMedia=e.sent,e.next=8;break;case 7:throw new Error("Media Content Service is unavailable");case 8:return e.abrupt("return",this.mcsMedia.getContentUrl());case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}}]),e}();t.Media=u},qPqR:function(e){e.exports=JSON.parse('{"_from":"twilio-mcs-client@^0.3.3","_id":"twilio-mcs-client@0.3.3","_inBundle":false,"_integrity":"sha512-lNnVITgLg14HBG2oshnwjAeyBxhuqJeAIQE/KUDCGLHwtA6moE49SE1RRtUr5hhziyDSCTjm5X8YeP0m/lL7QA==","_location":"/twilio-mcs-client","_phantomChildren":{},"_requested":{"type":"range","registry":true,"raw":"twilio-mcs-client@^0.3.3","name":"twilio-mcs-client","escapedName":"twilio-mcs-client","rawSpec":"^0.3.3","saveSpec":null,"fetchSpec":"^0.3.3"},"_requiredBy":["/twilio-chat"],"_resolved":"https://registry.npmjs.org/twilio-mcs-client/-/twilio-mcs-client-0.3.3.tgz","_shasum":"6d4c6ae56af77c0d7631131dac2ce28a33652efc","_spec":"twilio-mcs-client@^0.3.3","_where":"D:\\\\Gabrielle2\\\\Development\\\\Web\\\\cooper-pantry\\\\cooper\\\\node_modules\\\\twilio-chat","author":{"name":"Twilio"},"browser":{"xmlhttprequest":false},"browserify":{"transform":["babelify"]},"bundleDependencies":false,"dependencies":{"loglevel":"^1.6.4","operation-retrier":"^3.0.1","xmlhttprequest":"^1.8.0"},"deprecated":false,"description":"Twilio Media Content Service client library","devDependencies":{"@types/chai":"^4.2.2","@types/chai-as-promised":"^7.1.2","@types/chai-datetime":"0.0.33","@types/chai-string":"^1.4.2","@types/core-js":"^2.5.2","@types/mocha":"^5.2.7","@types/node":"^12.7.4","@types/sinon":"^7.0.13","@types/sinon-chai":"^3.2.3","async":"^3.1.0","async-test-tools":"^1.0.7","babel-core":"^6.26.0","babel-plugin-transform-builtin-extend":"^1.1.2","babel-plugin-transform-runtime":"^6.23.0","babel-preset-env":"^1.6.1","babel-runtime":"^6.26.0","babelify":"^8.0.0","browserify":"^16.0.0","chai":"^4.2.0","chai-as-promised":"^7.1.1","chai-datetime":"^1.5.0","chai-string":"^1.5.0","cheerio":"^1.0.0-rc.2","cross-env":"^5.2.1","del":"^5.1.0","dotenv":"^8.1.0","express":"^4.17.1","gulp":"^4.0.2","gulp-babel":"^7.0.1","gulp-derequire":"^2.1.0","gulp-if":"^3.0.0","gulp-insert":"^0.5.0","gulp-mocha":"^7.0.1","gulp-rename":"^1.4.0","gulp-sourcemaps":"^2.6.5","gulp-tap":"^2.0.0","gulp-tslint":"^8.1.4","gulp-typescript":"^5.0.1","gulp-uglify-es":"^1.0.0","ink-docstrap":"^1.3.2","isomorphic-form-data":"^2.0.0","jsdoc":"~3.5.5","jsdoc-strip-async-await":"^0.1.0","mocha":"^6.2.0","ngrok":"^3.2.5","nyc":"^14.1.1","sinon":"^7.4.2","sinon-chai":"^3.3.0","source-map-explorer":"^2.0.1","ts-node":"^8.3.0","tslint":"^5.19.0","twilio":"^3.34.0","typescript":"^3.6.2","uglify-save-license":"^0.4.1","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},"engines":{"node":">=6"},"license":"MIT","main":"lib/index.js","name":"twilio-mcs-client","scripts":{},"types":"./lib/client.d.ts","version":"0.3.3"}')},qRjN:function(e,t,n){"use strict";var r=d(n("XUND")),i=d(n("tgXR")),s=d(n("IhEH")),a=d(n("Rhu4")),o=d(n("aq5/")),u=d(n("4Mt5")),c=d(n("7xyS")),l=d(n("k2Qk"));function d(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var f=n("r2q8"),h=n("s5eF"),p=n("CPx3").Logger.scope("Members"),v=function(e){function t(e,n,r){(0,o.default)(this,t);var i=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return i.services=n,i.channel=e,i.members=r,i}var n,d,f,v;return(0,l.default)(t,e),(0,u.default)(t,[{key:"unsubscribe",value:(v=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.rosterEntityPromise){e.next=6;break}return e.next=3,this.rosterEntityPromise;case 3:e.sent.close(),this.rosterEntityPromise=null;case 6:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"subscribe",value:function(e){var t=this;return this.rosterEntityPromise=this.rosterEntityPromise||this.services.syncClient.map({id:e,mode:"open_existing"}).then((function(e){e.on("itemAdded",(function(e){p.debug(t.channel.sid+" itemAdded: "+e.item.key),t.upsertMember(e.item.key,e.item.value).then((function(e){t.emit("memberJoined",e)}))})),e.on("itemRemoved",(function(e){p.debug(t.channel.sid+" itemRemoved: "+e.key);var n=e.key;if(t.members.has(n)){var r=t.members.get(n);t.members.delete(n),t.emit("memberLeft",r)}})),e.on("itemUpdated",(function(e){p.debug(t.channel.sid+" itemUpdated: "+e.item.key),t.upsertMember(e.item.key,e.item.value)}));var n=[],i=t;return e.getItems().then((function e(t){return t.items.forEach((function(e){n.push(i.upsertMember(e.key,e.value))})),t.hasNextPage?t.nextPage().then(e):null})).then((function(){return r.default.all(n)})).then((function(){return e}))})).catch((function(e){throw t.rosterEntityPromise=null,"disconnected"!=t.services.syncClient.connectionState&&p.error("Failed to get roster object for channel",t.channel.sid,e),p.debug("ERROR: Failed to get roster object for channel",t.channel.sid,e),e}))}},{key:"upsertMember",value:(f=(0,s.default)(i.default.mark((function e(t,n){var r,s=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.members.get(t))){e.next=3;break}return e.abrupt("return",r._update(n));case 3:return r=new h.Member(this.services,this.channel,n,t),this.members.set(t,r),r.on("updated",(function(e){return s.emit("memberUpdated",e)})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"getMembers",value:function(){var e=this;return this.rosterEntityPromise.then((function(){var t=[];return e.members.forEach((function(e){return t.push(e)})),t}))}},{key:"getMemberBySid",value:(d=(0,s.default)(i.default.mark((function e(t){var n=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rosterEntityPromise.then((function(){var e=n.members.get(t);if(!e)throw new Error("Member with SID "+t+" was not found");return e})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getMemberByIdentity",value:(n=(0,s.default)(i.default.mark((function e(t){var n,r=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.abrupt("return",this.rosterEntityPromise.then((function(){if(r.members.forEach((function(e){e.identity===t&&(n=e)})),!n)throw new Error("Member with identity "+t+" was not found");return n})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"add",value:function(e){return this.services.session.addCommand("addMemberV2",{channelSid:this.channel.sid,username:e})}},{key:"invite",value:function(e){return this.services.session.addCommand("inviteMember",{channelSid:this.channel.sid,username:e})}},{key:"removeByIdentity",value:function(e){return this.services.session.addCommand("removeMember",{channelSid:this.channel.sid,username:e})}},{key:"removeBySid",value:function(e){return this.services.session.addCommand("removeMember",{channelSid:this.channel.sid,memberSid:e})}}]),t}(f.EventEmitter);t.Members=v},qXWz:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("AKzx");t.Retrier=r.Retrier;var i=n("TkcT");t.Backoff=i.Backoff,t.default=r.Retrier},qa3O:function(e,t,n){var r=n("b95h");e.exports=function(e,t,n){for(var i in t)n&&e[i]?e[i]=t[i]:r(e,i,t[i]);return e}},"qiY+":function(e,t,n){var r=n("9v8s");e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},qlDM:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UriBuilder=function(){function e(t){_classCallCheck(this,e),this.base=t,this.args=new Array,this.paths=new Array}return _createClass(e,[{key:"pathSegment",value:function(e){return this.paths.push(encodeURIComponent(e)),this}},{key:"queryParam",value:function(e,t){return void 0!==t&&this.args.push(encodeURIComponent(e)+"="+encodeURIComponent(t)),this}},{key:"build",value:function(){var e=this.base;return this.paths.length&&(e+="/"+this.paths.join("/")),this.args.length&&(e+="?"+this.args.join("&")),e}}]),e}()},qqHg:function(e,t,n){"use strict";var r=n("dWRk"),i=n("IFjL"),s=n("MrWc"),a=n("9vFK"),o=n("fawX"),u=n("MPuG"),c=n("9bSt"),l=n("1sfF");i(i.S+i.F*!n("EWHn")((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,d,f=s(e),h="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,y=void 0!==v,m=0,g=l(f);if(y&&(v=r(v,p>2?arguments[2]:void 0,2)),null==g||h==Array&&o(g))for(n=new h(t=u(f.length));t>m;m++)c(n,m,y?v(f[m],m):f[m]);else for(d=g.call(f),n=new h;!(i=d.next()).done;m++)c(n,m,y?a(d,v,[i.value,m],!0):i.value);return n.length=m,n}})},r2q8:function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,s=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var u=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var i,s,a;if(c(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),a=s[t]),void 0===a)a=s[t]=n,++e._eventsCount;else if("function"==typeof a?a=s[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(e))>0&&a.length>i&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=a.length,console&&console.warn&&console.warn(o)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):y(i,i.length)}function v(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)s(u,this,t);else{var c=u.length,l=y(u,c);for(n=0;n<c;++n)s(l[n],this,t)}return!0},o.prototype.on=o.prototype.addListener=function(e,t){return d(this,e,t,!1)},o.prototype.prependListener=function(e,t){return d(this,e,t,!0)},o.prototype.once=function(e,t){return c(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,h(this,e,t)),this},o.prototype.off=o.prototype.removeListener=function(e,t){var n,r,i,s,a;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},o.prototype.listenerCount=v,o.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},rFq9:function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},rU52:function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},rtEw:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=function(){function e(){var t=this;_classCallCheck(this,e),this._promise=new Promise((function(e,n){t._resolve=e,t._reject=n}))}return _createClass(e,[{key:"update",value:function(e){this._resolve(e)}},{key:"set",value:function(e){this.current=e,this._resolve(e)}},{key:"fail",value:function(e){this._reject(e)}},{key:"promise",get:function(){return this._promise}}]),e}()},s0lH:function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},s0uK:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("N8HJ"),i=n("r2q8"),s=n("TkJz"),a=n("SbVi");t.Registrations=function(e){_inherits(c,e);var t,n,i,o,u=_createSuper(c);function c(e){var t;return _classCallCheck(this,c),(t=u.call(this)).transport=e,t.registrations=new Map,t.registrationsInProgress=new Map,t}return _createClass(c,[{key:"putNotificationContext",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"put_notification_ctx",notification_ctx_id:t},e.next=3,this.transport.sendWithReply(r,n);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"deleteNotificationContext",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"delete_notification_ctx",notification_ctx_id:t},e.next=3,this.transport.sendWithReply(n);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"updateRegistration",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.log.debug("update registration for context",t),(i=this.registrationsInProgress.get(t))||(i=new Set,this.registrationsInProgress.set(t,i)),a=s.v4(),i.add(a),e.prev=5,e.next=8,this.putNotificationContext(t,n);case 8:r.log.debug("registration attempt succeeded for context",n),i.delete(a),0===i.size&&(this.registrationsInProgress.delete(t),this.emit("registered",t)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),r.log.warn("registration attempt failed for context",n),r.log.debug(e.t0),i.delete(a),0===i.size&&(this.registrationsInProgress.delete(t),this.emit("registrationFailed",t,e.t0));case 16:case"end":return e.stop()}}),e,this,[[5,13]])}))),function(e,t){return n.apply(this,arguments)})},{key:"updateRegistrations",value:function(){var e=this;r.log.trace("refreshing ".concat(this.registrations.size," registrations")),this.registrations.forEach((function(t,n){e.updateRegistration(n,t)}))}},{key:"setNotificationsContext",value:function(e,t){if(!e||!t)throw new a.TwilsockError("Invalid arguments provided");this.registrations.set(e,t),this.transport.isConnected&&this.updateRegistration(e,t)}},{key:"removeNotificationsContext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.registrations.has(t),!e.t0){e.next=5;break}return e.next=4,this.deleteNotificationContext(t);case 4:this.transport.isConnected&&this.registrations.delete(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),c}(i.EventEmitter)},s23o:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("XdyU");function i(e,t){return["".concat((new Date).toISOString()," MCS Client ").concat(e,":")].concat(Array.from(t))}var s=function(){function e(t){_classCallCheck(this,e),this.prefix="",this.prefix=null!=t&&t.length>0?t+" ":""}return _createClass(e,[{key:"setLevel",value:function(e){r.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.trace.apply(null,i(this.prefix+"T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.debug.apply(null,i(this.prefix+"D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.info.apply(null,i(this.prefix+"I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.warn.apply(null,i(this.prefix+"W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.error.apply(null,i(this.prefix+"E",t))}}],[{key:"scope",value:function(t){return new e(t)}},{key:"setLevel",value:function(e){r.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.trace.apply(null,i("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.debug.apply(null,i("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.info.apply(null,i("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.warn.apply(null,i("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.error.apply(null,i("E",t))}}]),e}();t.Logger=s},s5eF:function(e,t,n){"use strict";var r=f(n("qCKU")),i=f(n("tgXR")),s=f(n("IhEH")),a=f(n("hjYm")),o=f(n("Rhu4")),u=f(n("aq5/")),c=f(n("4Mt5")),l=f(n("7xyS")),d=f(n("k2Qk"));function f(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var h=n("r2q8"),p=n("RtQP"),v=n("CPx3").Logger.scope("Member"),y=function(e){function t(e,n,r,i){(0,u.default)(this,t);var s=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this));if(s.channel=n,s.services=e,s.state={attributes:p.parseAttributes(r.attributes,"Retrieved malformed attributes from the server for member: "+i,v),dateCreated:r.dateCreated?p.parseTime(r.dateCreated):null,dateUpdated:r.dateCreated?p.parseTime(r.dateUpdated):null,sid:i,typingTimeout:null,isTyping:!1,identity:r.identity||null,roleSid:r.roleSid||null,lastConsumedMessageIndex:(0,a.default)(r.lastConsumedMessageIndex)?r.lastConsumedMessageIndex:null,lastConsumptionTimestamp:r.lastConsumptionTimestamp?p.parseTime(r.lastConsumptionTimestamp):null,type:r.type||"chat",userInfo:r.userInfo},!r.identity&&!r.type)throw new Error("Received invalid Member object from server: Missing identity or type of Member.");return s}var n,f,h,y;return(0,d.default)(t,e),(0,c.default)(t,[{key:"_startTyping",value:function(e){var t=this;return clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.channel.emit("typingStarted",this),this.state.typingTimeout=setTimeout((function(){return t._endTyping()}),e),this}},{key:"_endTyping",value:function(){this.state.typingTimeout&&(this.state.isTyping=!1,this.emit("typingEnded",this),this.channel.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(e){var t=[],n=p.parseAttributes(e.attributes,"Retrieved malformed attributes from the server for member: "+this.state.sid,v);e.attributes&&!p.isDeepEqual(this.state.attributes,n)&&(this.state.attributes=n,t.push("attributes"));var r=p.parseTime(e.dateUpdated);e.dateUpdated&&r.getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=r,t.push("dateUpdated"));var i=p.parseTime(e.dateCreated);if(e.dateCreated&&i.getTime()!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=i,t.push("dateCreated")),e.roleSid&&this.state.roleSid!==e.roleSid&&(this.state.roleSid=e.roleSid,t.push("roleSid")),!(0,a.default)(e.lastConsumedMessageIndex)&&null!==e.lastConsumedMessageIndex||this.state.lastConsumedMessageIndex===e.lastConsumedMessageIndex||(this.state.lastConsumedMessageIndex=e.lastConsumedMessageIndex,t.push("lastConsumedMessageIndex")),e.lastConsumptionTimestamp){var s=new Date(e.lastConsumptionTimestamp);this.state.lastConsumptionTimestamp&&this.state.lastConsumptionTimestamp.getTime()===s.getTime()||(this.state.lastConsumptionTimestamp=s,t.push("lastConsumptionTimestamp"))}return t.length>0&&this.emit("updated",{member:this,updateReasons:t}),this}},{key:"getUserDescriptor",value:(y=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("chat"==this.type){e.next=2;break}throw new Error("Getting User Descriptor is not supported for this Member type: "+this.type);case 2:return e.abrupt("return",this.services.users.getUserDescriptor(this.state.identity));case 3:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"getUser",value:(h=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("chat"==this.type){e.next=2;break}throw new Error("Getting User is not supported for this Member type: "+this.type);case 2:return e.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"remove",value:(f=(0,s.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.channel.removeMember(this));case 1:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"updateAttributes",value:(n=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=4;break}throw new Error("Attributes is required parameter");case 4:if(null!==t){e.next=8;break}throw new Error("Attributes can't be null");case 8:if(t.constructor===Object){e.next=10;break}throw new Error("Attributes must be a valid JSON object");case 10:return e.next=12,this.services.session.addCommand("editMemberAttributes",{channelSid:this.channel.sid,memberSid:this.sid,attributes:(0,r.default)(t)});case 12:return e.abrupt("return",this);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastConsumedMessageIndex",get:function(){return this.state.lastConsumedMessageIndex}},{key:"lastConsumptionTimestamp",get:function(){return this.state.lastConsumptionTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}}]),t}(h.EventEmitter);t.Member=y},sRV3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("qXWz"),i=n("sc67"),s=n("LYxL"),a=n("F8DB"),o=function(){function e(t){_classCallCheck(this,e),this.localObject=t,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}return _createClass(e,[{key:"update",value:function(e,t){this.localObject._update(e,t)}},{key:"updatePending",value:function(e,t){this.pendingAction=e,this.pendingCorrelationId=t}},{key:"reset",value:function(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}},{key:"markAsFailed",value:function(e){this.rejectedWithError=e.error,this.updatePending(null,null),this.localObject.reportFailure(new i.SyncError("Failed to subscribe on service events: ".concat(e.error.message),e.error.status,e.error.code))}},{key:"complete",value:function(e){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(e)}},{key:"setSubscriptionState",value:function(e){this.localObject._setSubscriptionState(e)}},{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"indexName",get:function(){return this.localObject.indexName}},{key:"queryString",get:function(){return this.localObject.queryString}},{key:"isEstablished",get:function(){return this.established}}]),e}();t.Subscriptions=function(){function e(t){var n=this;_classCallCheck(this,e),this.isConnected=!1,this.maxBatchSize=100,this.subscriptionTtlTimer=null,this.pendingPokeReason=null,this.services=t,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map,this.backoff=r.Backoff.exponential(Object.assign({randomisationFactor:.2,initialDelay:100,maxDelay:12e4},this.services.config.backoffConfig)),this.backoff.on("ready",(function(){var e=n.getSubscriptionUpdateBatch(),t=e.action,r=e.subscriptions;t?n.applyNewSubscriptionUpdateBatch(t,r):(n.backoff.reset(),s.default.debug("All subscriptions resolved."))}))}var t;return _createClass(e,[{key:"getSubscriptionUpdateBatch",value:function(){function e(e,t,n,r){var i,s=[],a=_createForOfIteratorHelper(e);try{for(a.s();!(i=a.n()).done;){var o=_slicedToArray(i.value,2),u=o[0],c=o[1];if(!t.get(u)&&n!==c.pendingAction&&!c.rejectedWithError&&(s.push(c),r&&s.length>=r))break}}catch(l){a.e(l)}finally{a.f()}return s}var t=e(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(t.length>0)return{action:"establish",subscriptions:t};var n=e(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return n.length>0?{action:"cancel",subscriptions:n}:{action:null,subscriptions:null}}},{key:"persist",value:function(){this.backoff.backoff()}},{key:"applyNewSubscriptionUpdateBatch",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,o,u,c,l,d,f,h,p,v,y,m=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isConnected){e.next=2;break}return e.abrupt("return",(s.default.debug("Twilsock connection (required for subscription) not ready; waiting\u2026"),void this.backoff.reset()));case 2:n=this.processLocalActions(t,n),r=(new Date).getTime(),i=_createForOfIteratorHelper(n);try{for(i.s();!(o=i.n()).done;)u=o.value,this.recordActionAttemptOn(u,t,r)}catch(g){i.e(g)}finally{i.f()}return c=this.pendingPokeReason,this.pendingPokeReason=null,e.prev=8,e.next=11,this.request(t,r,c,n);case 11:l=e.sent,d=l.body.max_batch_size,!isNaN(parseInt(d))&&isFinite(d)&&d>0&&(this.maxBatchSize=d),this.subscriptionTtlTimer||(f=l.body.ttl_in_s,!isNaN(parseFloat(f))&&isFinite(f)&&f>0&&(this.subscriptionTtlTimer=setTimeout((function(){return m.onSubscriptionTtlElapsed()}),1e3*f))),"establish"===t&&(h=l.body.estimated_delivery_in_ms,!isNaN(parseFloat(h))&&isFinite(h)&&h>0?setTimeout((function(){return m.verifyPokeDelivery(r,h,n)}),h):s.default.error("Invalid timeout: ".concat(h)),n.filter((function(e){return e.pendingCorrelationId===r})).forEach((function(e){return e.setSubscriptionState("response_in_flight")}))),this.backoff.reset(),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(8),p=_createForOfIteratorHelper(n);try{for(p.s();!(v=p.n()).done;)y=v.value,this.recordActionFailureOn(y,t)}catch(g){p.e(g)}finally{p.f()}e.t0 instanceof a.TransportUnavailableError?(s.default.debug("Twilsock connection (required for subscription) not ready (c:".concat(r,"); waiting\u2026")),this.backoff.reset()):(s.default.debug("Failed an attempt to ".concat(t," subscriptions (c:").concat(r,"); retrying"),e.t0),this.persist());case 23:case"end":return e.stop()}}),e,this,[[8,18]])}))),function(e,n){return t.apply(this,arguments)})},{key:"verifyPokeDelivery",value:function(e,t,n){var r=this,i=this.latestPokeResponseArrivalTimestampByCorrelationId.get(e),s=i?(new Date).getTime()-i:t;s>=t?(n.filter((function(t){return t.pendingCorrelationId===e})).forEach((function(e){e.updatePending(null,null),e.retryCount++,r.persisted.delete(e.sid)})),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(e)):setTimeout((function(){return r.verifyPokeDelivery(e,t,n)}),t-s)}},{key:"processLocalActions",value:function(e,t){return"cancel"===e?t.filter((function(e){return!e.rejectedWithError})):t}},{key:"recordActionAttemptOn",value:function(e,t,n){if(e.setSubscriptionState("request_in_flight"),"establish"===t)this.persisted.set(e.sid,e),e.updatePending(t,n);else{var r=this.persisted.get(e.sid);r&&r.updatePending(t,n)}}},{key:"recordActionFailureOn",value:function(e,t){e.setSubscriptionState("none"),e.updatePending(null,null),"establish"===t&&this.persisted.delete(e.sid)}},{key:"request",value:function(e,t,n,r){var i=r.map((function(t){return{object_sid:t.sid,object_type:t.type,last_event_id:"establish"===e?t.lastEventId:void 0,index_name:"establish"===e?t.indexName:void 0,query_string:"establish"===e?t.queryString:void 0}})),a=r.filter((function(e){return e.retryCount>0})).length;s.default.debug("Attempting '".concat(e,"' request (c:").concat(t,"):"),i);var o={event_protocol_version:3,action:e,correlation_id:t,retried_requests:a,ttl_in_s:-1,requests:i};return"ttl"===n&&(o.reason=n),this.services.network.post(this.services.config.subscriptionsUri,o)}},{key:"add",value:function(e,t){s.default.debug("Establishing intent to subscribe to ".concat(e));var n=this.subscriptions.get(e);n&&t&&n.lastEventId===t.lastEventId||(this.persisted.delete(e),this.subscriptions.set(e,new o(t)),this.persist())}},{key:"remove",value:function(e){s.default.debug("Establishing intent to unsubscribe from ".concat(e)),this.subscriptions.delete(e)&&this.persist()}},{key:"acceptMessage",value:function(e,t){switch(s.default.trace("Subscriptions received",e),e.correlation_id&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(e.correlation_id,(new Date).getTime()),e.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(e.event,e.correlation_id);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(e.event,e.correlation_id);break;case"subscription_failed":this.applySubscriptionFailedMessage(e.event,e.correlation_id);break;case(e.event_type.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:this.applyEventToSubscribedEntity(e.event_type.match(/^map_/)?e.event.map_sid:e.event_type.match(/^list_/)?e.event.list_sid:e.event_type.match(/^document_/)?e.event.document_sid:e.event_type.match(/^stream_/)?e.event.stream_sid:e.event_type.match(/^live_query/)?e.event.query_id:void 0,e,t);break;default:s.default.debug("Dropping unknown message type ".concat(e.event_type))}}},{key:"applySubscriptionEstablishedMessage",value:function(e,t){var n=e.object_sid,r=this.persisted.get(e.object_sid);r&&r.pendingCorrelationId===t?"interrupted"===e.replay_status?(s.default.debug("Event Replay for subscription to ".concat(n," (c:").concat(t,") interrupted; continuing eagerly.")),r.updatePending(null,null),this.persisted.delete(r.sid),this.backoff.reset()):"completed"===e.replay_status&&(s.default.debug("Event Replay for subscription to ".concat(n," (c:").concat(t,") completed. Subscription is ready.")),r.complete(e.last_event_id),this.persisted.set(e.object_sid,r),r.setSubscriptionState("established"),this.backoff.reset()):s.default.debug("Late message for ".concat(e.object_sid," (c:").concat(t,") dropped.")),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(e,t){var n=this.persisted.get(e.object_sid);n&&n.pendingCorrelationId===t?(n.updatePending(null,null),n.setSubscriptionState("none"),this.persisted.delete(e.object_sid)):s.default.debug("Late message for ".concat(e.object_sid," (c:").concat(t,") dropped.")),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(e,t){var n=e.object_sid,r=this.subscriptions.get(n),i=this.persisted.get(n);r&&i?i.pendingCorrelationId===t&&(s.default.error("Failed to subscribe on ".concat(i.sid),e.error),i.markAsFailed(e),i.setSubscriptionState("none")):!r&&i&&(this.persisted.delete(n),i.setSubscriptionState("none")),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(e,t,n){if(e){var r;n=n||(r=this.persisted.get(e))&&r.isEstablished;var i=this.subscriptions.get(e);i?(t.event.type=t.event_type,i.update(t.event,n)):s.default.debug("Message dropped for SID '".concat(e,"', for which there is no subscription."))}}},{key:"onConnectionStateChanged",value:function(e){this.isConnected=e,e&&this.poke("reconnect")}},{key:"onSubscriptionTtlElapsed",value:function(){this.isConnected&&this.poke("ttl")}},{key:"poke",value:function(e){s.default.debug("Triggering event replay for all subscriptions, reason=".concat(e)),this.pendingPokeReason=e,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);var t,n=[],r=_createForOfIteratorHelper(this.persisted.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.reset(),i.rejectedWithError&&n.push(i)}}catch(c){r.e(c)}finally{r.f()}this.persisted.clear();for(var a=0,o=n;a<o.length;a++){var u=o[a];this.persisted.set(u.sid,u)}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),e}()},sc67:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return _classCallCheck(this,n),(r=t.call(this)).name=r.constructor.name,r.message="".concat(e," (status: ").concat(i,", code: ").concat(s,")"),r.status=i,r.code=s,r}return n}();t.SyncError=r,t.SyncNetworkError=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0;return _classCallCheck(this,n),(r=t.call(this,e,i,s)).body=a,r}return n}(r),t.default=r},sqYj:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n("ihyG"),a=n("TkXn"),o=n("m+l7"),u=function(e){function t(t){var n=e.call(this,"Value required at path: "+t)||this;return n.path=t,n.name="MissingError",n}return i(t,e),t}(Error);t.MissingError=u;var c=function(e){function t(t,n){var r=e.call(this,"Test failed: "+t+" != "+n)||this;return r.actual=t,r.expected=n,r.name="TestError",r.actual=t,r.expected=n,r}return i(t,e),t}(Error);function l(e,t,n){if(Array.isArray(e))if("-"==t)e.push(n);else{var r=parseInt(t,10);e.splice(r,0,n)}else e[t]=n}function d(e,t){if(Array.isArray(e)){var n=parseInt(t,10);e.splice(n,1)}else delete e[t]}function f(e,t){var n=s.Pointer.fromJSON(t.path).evaluate(e);return void 0===n.parent?new u(t.path):(l(n.parent,n.key,a.clone(t.value)),null)}function h(e,t){var n=s.Pointer.fromJSON(t.path).evaluate(e);return void 0===n.value?new u(t.path):(d(n.parent,n.key),null)}function p(e,t){var n=s.Pointer.fromJSON(t.path).evaluate(e);if(null===n.parent)return new u(t.path);if(Array.isArray(n.parent)){if(parseInt(n.key,10)>=n.parent.length)return new u(t.path)}else if(void 0===n.value)return new u(t.path);return n.parent[n.key]=t.value,null}function v(e,t){var n=s.Pointer.fromJSON(t.from).evaluate(e);if(void 0===n.value)return new u(t.from);var r=s.Pointer.fromJSON(t.path).evaluate(e);return void 0===r.parent?new u(t.path):(d(n.parent,n.key),l(r.parent,r.key,n.value),null)}function y(e,t){var n=s.Pointer.fromJSON(t.from).evaluate(e);if(void 0===n.value)return new u(t.from);var r=s.Pointer.fromJSON(t.path).evaluate(e);return void 0===r.parent?new u(t.path):(l(r.parent,r.key,a.clone(n.value)),null)}function m(e,t){var n=s.Pointer.fromJSON(t.path).evaluate(e);return o.compare(n.value,t.value)?null:new c(n.value,t.value)}t.TestError=c,t.add=f,t.remove=h,t.replace=p,t.move=v,t.copy=y,t.test=m;var g=function(e){function t(t){var n=e.call(this,"Invalid operation: "+t.op)||this;return n.operation=t,n.name="InvalidOperationError",n}return i(t,e),t}(Error);t.InvalidOperationError=g,t.apply=function(e,t){switch(t.op){case"add":return f(e,t);case"remove":return h(e,t);case"replace":return p(e,t);case"move":return v(e,t);case"copy":return y(e,t);case"test":return m(e,t)}return new g(t)}},tReM:function(e,t){e.exports={}},tTO9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapItem=function(){function e(t){_classCallCheck(this,e),this.descriptor=t}return _createClass(e,[{key:"update",value:function(e,t,n,r){return this.descriptor.last_event_id=e,this.descriptor.revision=t,this.descriptor.data=n,this.descriptor.date_updated=r,this}},{key:"updateDateExpires",value:function(e){this.descriptor.date_expires=e}},{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"key",get:function(){return this.descriptor.key}},{key:"value",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}}]),e}()},tcGR:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("sc67"),i=n("lKIr"),s=n("LYxL"),a=n("yURk"),o=n("wiho"),u=n("e/PS"),c=function(e){_inherits(v,e);var t,n,a,u,c,l,d,f,h,p=_createSuper(v);function v(e,t,n){var r;return _classCallCheck(this,v),(r=p.call(this,e,n)).isDeleted=!1,r.updateMergingQueue=new o.MergingQueue((function(e,t){return"number"==typeof t.ttl?{ttl:t.ttl}:e})),r.descriptor=t,r.descriptor.data=r.descriptor.data||{},r.descriptor.date_updated=new Date(r.descriptor.date_updated),r}return _createClass(v,[{key:"_update",value:function(e){switch(e.date_created=new Date(e.date_created),e.type){case"document_updated":e.id>this.lastEventId?(this.descriptor.last_event_id=e.id,this.descriptor.revision=e.document_revision,this.descriptor.date_updated=e.date_created,this.descriptor.data=e.document_data,this.broadcastEventToListeners("updated",{value:e.document_data,isLocal:!1}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:e.id,revision:e.document_revision,date_updated:e.date_created,data:e.document_data})):s.default.trace("Document update skipped, current:",this.lastEventId,", remote:",e.id);break;case"document_removed":this.onRemoved(!1)}}},{key:"set",value:(h=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n||{},e.abrupt("return",(i.validateOptionalTtl(r.ttl),this.updateMergingQueue.squashAndAdd(r,(function(e){return s._setUnconditionally(t,e.ttl)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"mutate",value:(f=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n||{},e.abrupt("return",(i.validateOptionalTtl(r.ttl),this.updateMergingQueue.add(r,(function(e){return s._setWithIfMatch(t,e.ttl)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"update",value:(d=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mutate((function(e){return Object.assign(e,t)}),n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"setTtl",value:(l=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.validateMandatoryTtl(t),e.next=3,this._postUpdateToServer({ttl:t});case 3:n=e.sent,this.descriptor.date_expires=n.date_expires;case 5:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"_setUnconditionally",value:(c=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postUpdateToServer({data:t,revision:void 0,ttl:n});case 2:return r=e.sent,e.abrupt("return",(this._handleSuccessfulUpdateResult(r),this.value));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"_setWithIfMatch",value:(u=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t(i.deepClone(this.value))){e.next=3;break}return e.abrupt("return",this.value);case 3:return s=this.revision,e.prev=4,e.next=7,this._postUpdateToServer({data:r,revision:s,ttl:n});case 7:return a=e.sent,e.abrupt("return",(this._handleSuccessfulUpdateResult(a),this.value));case 11:if(e.prev=11,e.t0=e.catch(4),412!==e.t0.status){e.next=17;break}return e.next=16,this._softSync();case 16:return e.abrupt("return",this._setWithIfMatch(t));case 17:throw e.t0;case 18:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(e,t){return u.apply(this,arguments)})},{key:"_handleSuccessfulUpdateResult",value:function(e){e.last_event_id>this.descriptor.last_event_id&&(this.descriptor.revision=e.revision,this.descriptor.data=e.data,this.descriptor.last_event_id=e.last_event_id,this.descriptor.date_expires=e.date_expires,this.descriptor.date_updated=new Date(e.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:e.last_event_id,revision:e.revision,date_updated:e.date_updated,data:e.data}),this.broadcastEventToListeners("updated",{value:this.value,isLocal:!0}))}},{key:"_postUpdateToServer",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDeleted){e.next=2;break}return e.abrupt("return",Promise.reject(new r.SyncError("The Document has been removed",404,54100)));case 2:return n={data:t.data},"number"==typeof t.ttl&&(n.ttl=t.ttl),i=t.revision,e.prev=5,e.next=8,this.services.network.post(this.uri,n,i);case 8:return s=e.sent,e.abrupt("return",{revision:s.body.revision,data:t.data,last_event_id:s.body.last_event_id,date_updated:s.body.date_updated,date_expires:s.body.date_expires});case 12:throw e.prev=12,e.t0=e.catch(5),404===e.t0.status&&this.onRemoved(!1),e.t0;case 15:case"end":return e.stop()}}),e,this,[[5,12]])}))),function(e){return a.apply(this,arguments)})},{key:"_softSync",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.network.get(this.uri).then((function(e){return t._update({type:"document_updated",id:e.body.last_event_id,document_revision:e.body.revision,document_data:e.body.data,date_created:e.body.date_updated}),t})).catch((function(e){404===e.status?t.onRemoved(!1):s.default.error("Can't get updates for ".concat(t.sid,":"),e)})));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onRemoved",value:function(e){this.isDeleted||(this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e}))}},{key:"removeDocument",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDeleted){e.next=2;break}return e.abrupt("return",Promise.reject(new r.SyncError("The Document has been removed",404,54100)));case 2:return e.next=4,this.services.network.delete(this.uri);case 4:this.onRemoved(!0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"document"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"value",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}}],[{key:"type",get:function(){return"document"}}]),v}(a.SyncEntity);t.SyncDocumentImpl=c;var l=function(e){_inherits(o,e);var t,n,r,i,s,a=_createSuper(o);function o(e){var t;return _classCallCheck(this,o),(t=a.call(this)).syncDocumentImpl=e,t.syncDocumentImpl.attach(_assertThisInitialized(t)),t}return _createClass(o,[{key:"set",value:(s=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncDocumentImpl.set(t,n)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"mutate",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncDocumentImpl.mutate(t,n)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"update",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncDocumentImpl.update(t,n)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"setTtl",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncDocumentImpl.setTtl(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"removeDocument",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncDocumentImpl.removeDocument()));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){_get3(_getPrototypeOf(o.prototype),"close",this).call(this),this.syncDocumentImpl.detach(this.listenerUuid)}},{key:"uri",get:function(){return this.syncDocumentImpl.uri}},{key:"revision",get:function(){return this.syncDocumentImpl.revision}},{key:"lastEventId",get:function(){return this.syncDocumentImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncDocumentImpl.dateExpires}},{key:"type",get:function(){return c.type}},{key:"sid",get:function(){return this.syncDocumentImpl.sid}},{key:"value",get:function(){return this.syncDocumentImpl.value}},{key:"dateUpdated",get:function(){return this.syncDocumentImpl.dateUpdated}},{key:"uniqueName",get:function(){return this.syncDocumentImpl.uniqueName}}],[{key:"type",get:function(){return c.type}}]),o}(u.default);t.SyncDocument=l,t.default=l},tgXR:function(e,t,n){e.exports=n("G+rG")},tqb5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("r2q8"),i=n("N8HJ"),s=n("Cf4i"),a=n("MC8q"),o=n("TsN3"),u=n("iBdP"),c=n("s0uK"),l=n("O3kU"),d=n("rtEw"),f=n("F8DB"),h=n("2NA7"),p=n("uthQ"),v=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e,t){var h,v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,r),(h=n.call(this)).offlineStorageDeferred=new d.Deferred,v.continuationToken=v.continuationToken?v.continuationToken:p.TokenStorage.getStoredToken(t);var y=h.config=new s.Configuration(e,t,v);i.log.setLevel(y.logLevel);var m=new u.WebSocketChannel(y.url),g=v.transport?v.transport:new o.PacketInterface(m,y);return h.channel=v.channel?v.channel:new a.TwilsockImpl(m,g,y),h.registrations=v.registrations?v.registrations:new c.Registrations(g),h.upstream=new l.Upstream(g,h.channel,y),h.registrations.on("registered",(function(e){return h.emit("registered",e)})),h.channel.on("message",(function(e,t){return setTimeout((function(){return h.emit("message",e,t)}),0)})),h.channel.on("stateChanged",(function(e){return setTimeout((function(){return h.emit("stateChanged",e)}),0)})),h.channel.on("connectionError",(function(e){return setTimeout((function(){return h.emit("connectionError",e)}),0)})),h.channel.on("tokenAboutToExpire",(function(){return setTimeout((function(){return h.emit("tokenAboutToExpire")}),0)})),h.channel.on("tokenExpired",(function(){return setTimeout((function(){return h.emit("tokenExpired")}),0)})),h.channel.on("connected",(function(){return h.registrations.updateRegistrations()})),h.channel.on("connected",(function(){return h.upstream.sendPendingMessages()})),h.channel.on("connected",(function(){return setTimeout((function(){return h.emit("connected")}),0)})),h.channel.on("initialized",(function(e){h.handleStorageId(t,e),p.TokenStorage.storeToken(e.continuationToken,t),setTimeout((function(){return h.emit("initialized",e)}),0)})),h.channel.on("disconnected",(function(){return setTimeout((function(){return h.emit("disconnected")}),0)})),h.channel.on("disconnected",(function(){return h.upstream.rejectPendingMessages()})),h.channel.on("disconnected",(function(){return h.offlineStorageDeferred.fail(new f.TwilsockError("Client disconnected"))})),h.offlineStorageDeferred.promise.catch((function(){})),h}return _createClass(r,[{key:"emit",value:function(e){for(var t,n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return i.log.debug("Emitting ".concat(e.toString(),"(").concat(s.map((function(e){return JSON.stringify(e)})).join(", "),")")),(t=_get3(_getPrototypeOf(r.prototype),"emit",this)).call.apply(t,[this,e].concat(s))}},{key:"handleStorageId",value:function(e,t){if(t.offlineStorage)if(t.offlineStorage.hasOwnProperty(e))try{this.offlineStorageDeferred.set(h.OfflineProductStorage.create(t.offlineStorage[e])),i.log.debug("Offline storage for '".concat(e,"' product: ").concat(JSON.stringify(t.offlineStorage[e]),"."))}catch(n){this.offlineStorageDeferred.fail(new f.TwilsockError("Failed to parse offline storage for ".concat(e," ").concat(JSON.stringify(t.offlineStorage[e]),". ").concat(n,".")))}else this.offlineStorageDeferred.fail(new f.TwilsockError("No offline storage id for '".concat(e,"' product: ").concat(JSON.stringify(t.offlineStorage))));else this.offlineStorageDeferred.fail(new f.TwilsockError("No offline storage id"))}},{key:"storageId",value:function(){return this.offlineStorageDeferred.promise}},{key:"updateToken",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.log.trace("updating token '".concat(t,"'")),this.config.token===t){e.next=2;break}return e.abrupt("return",(this.config.updateToken(t),this.channel.updateToken(t)));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"setNotificationsContext",value:function(e,t){this.registrations.setNotificationsContext(e,t)}},{key:"removeNotificationsContext",value:function(e){this.registrations.removeNotificationsContext(e)}},{key:"connect",value:function(){return this.channel.connect()}},{key:"disconnect",value:function(){return this.channel.disconnect()}},{key:"get",value:function(e,t){return this.upstream.send("GET",e,t)}},{key:"post",value:function(e,t,n){return this.upstream.send("POST",e,t,n)}},{key:"put",value:function(e,t,n){return this.upstream.send("PUT",e,t,n)}},{key:"delete",value:function(e,t){return this.upstream.send("DELETE",e,t)}},{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"state",get:function(){return this.channel.state}}]),r}(r.EventEmitter);t.TwilsockClient=v,t.Twilsock=v},u2rs:function(e,t,n){e.exports={default:n("F//K"),__esModule:!0}},uBMx:function(e,t,n){n("zJWi"),e.exports=n("rFq9").Object.getPrototypeOf},uXIA:function(e,t,n){var r,i,s=n("6XaB"),a=n("NkxH"),o=0,u=0;e.exports=function(e,t,n){var c=t&&n||0,l=t||[],d=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==f){var h=s();null==d&&(d=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==f&&(f=i=16383&(h[6]<<8|h[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:u+1,y=p-o+(v-u)/1e4;if(y<0&&void 0===e.clockseq&&(f=f+1&16383),(y<0||p>o)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=p,u=v,i=f;var m=(1e4*(268435455&(p+=122192928e5))+v)%4294967296;l[c++]=m>>>24&255,l[c++]=m>>>16&255,l[c++]=m>>>8&255,l[c++]=255&m;var g=p/4294967296*1e4&268435455;l[c++]=g>>>8&255,l[c++]=255&g,l[c++]=g>>>24&15|16,l[c++]=g>>>16&255,l[c++]=f>>>8|128,l[c++]=255&f;for(var b=0;b<6;++b)l[c+b]=d[b];return t||a(l)}},ubhL:function(e,t,n){var r=n("kz3d")("keys"),i=n("b1KM");e.exports=function(e){return r[e]||(r[e]=i(e))}},"upa/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("yURk"),i=n("lKIr"),s=n("e/PS"),a=function(e){_inherits(a,e);var t,n,r,s=_createSuper(a);function a(e,t,n){var r;return _classCallCheck(this,a),(r=s.call(this,e,n)).descriptor=t,r}return _createClass(a,[{key:"publishMessage",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={data:t},e.next=3,this.services.network.post(this.links.messages,n);case 3:return r=e.sent,e.abrupt("return",this._handleMessagePublished(r.body.sid,t,!1));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setTtl",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.validateMandatoryTtl(t),e.prev=1,n={ttl:t},e.next=5,this.services.network.post(this.uri,n);case 5:r=e.sent,this.descriptor.date_expires=r.body.date_expires,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(1),404===e.t0.status&&this.onRemoved(!1),e.t0;case 12:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return n.apply(this,arguments)})},{key:"removeStream",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_update",value:function(e){switch(e.type){case"stream_message_published":this._handleMessagePublished(e.message_sid,e.message_data,!0);break;case"stream_removed":this.onRemoved(!1)}}},{key:"_handleMessagePublished",value:function(e,t,n){var r={sid:e,value:t};return this.broadcastEventToListeners("messagePublished",{message:r,isLocal:!n}),r}},{key:"onRemoved",value:function(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}},{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"stream"}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}}],[{key:"type",get:function(){return"stream"}}]),a}(r.SyncEntity);t.SyncStreamImpl=a;var o=function(e){_inherits(s,e);var t,n,r,i=_createSuper(s);function s(e){var t;return _classCallCheck(this,s),(t=i.call(this)).syncStreamImpl=e,t.syncStreamImpl.attach(_assertThisInitialized(t)),t}return _createClass(s,[{key:"publishMessage",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncStreamImpl.publishMessage(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setTtl",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncStreamImpl.setTtl(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"removeStream",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.ensureNotClosed(),this.syncStreamImpl.removeStream()));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){_get3(_getPrototypeOf(s.prototype),"close",this).call(this),this.syncStreamImpl.detach(this.listenerUuid)}},{key:"uri",get:function(){return this.syncStreamImpl.uri}},{key:"links",get:function(){return this.syncStreamImpl.links}},{key:"dateExpires",get:function(){return this.syncStreamImpl.dateExpires}},{key:"type",get:function(){return a.type}},{key:"lastEventId",get:function(){return null}},{key:"sid",get:function(){return this.syncStreamImpl.sid}},{key:"uniqueName",get:function(){return this.syncStreamImpl.uniqueName}}],[{key:"type",get:function(){return a.type}}]),s}(s.default);t.SyncStream=o,t.default=o},uthQ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"storeToken",value:function(t,n){e.canStore&&e.sessionStorage.setItem(e.getKeyName(n),t)}},{key:"getStoredToken",value:function(t){return e.canStore?e.sessionStorage.getItem(e.getKeyName(t)):null}},{key:"initialize",value:function(){e.canStore&&(e.sessionStorage.getItem(e.initializedFlag)&&this.clear(),e.sessionStorage.setItem(e.initializedFlag,"true"),e.window.addEventListener("unload",(function(){e.sessionStorage.removeItem(e.initializedFlag)})))}},{key:"clear",value:function(){if(e.canStore){for(var t=[],n=0;n<e.sessionStorage.length;n++){var r=e.sessionStorage.key(n);r.startsWith(e.tokenStoragePrefix)&&t.push(r)}t.forEach((function(t){return e.sessionStorage.removeItem(t)})),e.sessionStorage.removeItem(e.initializedFlag)}}},{key:"getKeyName",value:function(t){return"".concat(e.tokenStoragePrefix).concat(t)}},{key:"sessionStorage",get:function(){try{return global.sessionStorage}catch(e){return null}}},{key:"window",get:function(){try{return global.window}catch(e){return null}}},{key:"canStore",get:function(){return e.sessionStorage&&e.window}}]),e}();r.initializedFlag="twilio_twilsock_token_storage",r.tokenStoragePrefix="twilio_continuation_token_",t.TokenStorage=r,r.initialize()},v9mA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("8lcS");t.Notifications=r.Client},vOBy:function(e,t,n){"use strict";var r=n("lkbt");e.exports=r},vZMe:function(e,t,n){"use strict";var r,i=(r=n("aq5/"))&&r.__esModule?r:{default:r};Object.defineProperty(t,"__esModule",{value:!0}),t.PushNotification=function e(t){(0,i.default)(this,e),this.title=t.title||null,this.body=t.body||null,this.sound=t.sound||null,this.badge=t.badge||null,this.action=t.action||null,this.type=t.type||null,this.data=t.data||{}}},vbc5:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},"vsn+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("BHqR");t.ContinuationTokenStatus=function(){return function e(){_classCallCheck(this,e)}}(),t.InitReply=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,s,a,o){var u;return _classCallCheck(this,n),(u=t.call(this,e)).continuationToken=r,u.continuationTokenStatus=i,u.offlineStorage=s,u.initRegistrations=a,u.debugInfo=o,u}return n}(r.AbstractMessage)},wGyb:function(e,t,n){var r=n("vbc5"),i=n("gNE/"),s=n("eD9m")("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[s])&&(t=void 0)),void 0===t?Array:t}},wHU4:function(e,t,n){var r=n("hR4s").document;e.exports=r&&r.documentElement},wOJj:function(e,t){e.exports=function(){}},wiho:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(t){_classCallCheck(this,e),this.queuedRequests=[],this.isRequestInFlight=!1,this.inputMergingFunction=t}return _createClass(e,[{key:"add",value:function(e,t){var n=this,r=new Promise((function(r,i){return n.queuedRequests.push({input:e,requestFunction:t,resolve:r,reject:i})}));return this.wakeupQueue(),r}},{key:"squashAndAdd",value:function(e,t){var n,r=this.queuedRequests;this.queuedRequests=[],r.length>0?(n=r.map((function(e){return e.input})).reduce(this.inputMergingFunction),n=this.inputMergingFunction(n,e)):n=e;var i=this.add(n,t);return r.forEach((function(e){return i.then(e.resolve,e.reject)})),i}},{key:"isEmpty",value:function(){return 0===this.queuedRequests.length&&!this.isRequestInFlight}},{key:"wakeupQueue",value:function(){var e=this;if(0!==this.queuedRequests.length&&!this.isRequestInFlight){var t=this.queuedRequests.shift();this.isRequestInFlight=!0,t.requestFunction(t.input).then(t.resolve,t.reject).then((function(t){e.isRequestInFlight=!1,e.wakeupQueue()}))}}}]),e}();t.MergingQueue=r,t.NamespacedMergingQueue=function(){function e(t){_classCallCheck(this,e),this.queueByNamespaceKey=new Map,this.inputReducer=t}var t,n,i;return _createClass(e,[{key:"add",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.invokeQueueMethod(t,(function(e){return e.add(n,r)})));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"squashAndAdd",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.invokeQueueMethod(t,(function(e){return e.squashAndAdd(n,r)})));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"invokeQueueMethod",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.queueByNamespaceKey.has(t)||this.queueByNamespaceKey.set(t,new r(this.inputReducer)),i=n(this.queueByNamespaceKey.get(t)),e.abrupt("return",(this.queueByNamespaceKey.get(t).isEmpty()&&this.queueByNamespaceKey.delete(t),i));case 3:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}()},wlIO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntitiesCache=function(){function e(){_classCallCheck(this,e),this.names=new Map,this.entities=new Map}return _createClass(e,[{key:"store",value:function(e){return this.entities.get(e.sid)||(this.entities.set(e.sid,e),e.uniqueName&&this.names.set(e.type+"::"+e.uniqueName,e.sid),e)}},{key:"getResolved",value:function(e,t){var n=this.names.get(t+"::"+e);return n?this.entities.get(n):null}},{key:"get",value:function(e,t){return this.entities.get(e)||this.getResolved(e,t)||null}},{key:"remove",value:function(e){var t=this.entities.get(e);t&&(this.entities.delete(e),t.uniqueName&&this.names.delete(t.type+"::"+t.uniqueName))}}]),e}()},xLJM:function(e,t,n){n("Fk9O"),n("/r3m"),e.exports=n("Bkdt")},y51I:function(e,t,n){"use strict";var r=n("/hF+");e.exports=r},y7sZ:function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(t){return{e:!0,v:t}}}},yDbV:function(e,t,n){"use strict";var r,i=(r=n("aq5/"))&&r.__esModule?r:{default:r};Object.defineProperty(t,"__esModule",{value:!0});var s=function e(){(0,i.default)(this,e)};t.NotificationTypes=s,s.TYPING_INDICATOR="twilio.ipmsg.typing_indicator",s.NEW_MESSAGE="twilio.channel.new_message",s.ADDED_TO_CHANNEL="twilio.channel.added_to_channel",s.INVITED_TO_CHANNEL="twilio.channel.invited_to_channel",s.REMOVED_FROM_CHANNEL="twilio.channel.removed_from_channel",s.CONSUMPTION_UPDATE="twilio.channel.consumption_update"},yURk:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(t,n){_classCallCheck(this,e),this.services=t,this.removalHandler=n,this.subscriptionState="none",this._attachedListeners=new Map}return _createClass(e,[{key:"_advanceLastEventId",value:function(e,t){}},{key:"reportFailure",value:function(e){404===e.status?this.onRemoved(!1):this.broadcastEventToListeners("failure",e)}},{key:"_subscribe",value:function(){this.services.router.subscribe(this.sid,this)}},{key:"_unsubscribe",value:function(){this.services.router.unsubscribe(this.sid)}},{key:"_setSubscriptionState",value:function(e){this.subscriptionState=e,this.broadcastEventToListeners("_subscriptionStateChanged",e)}},{key:"close",value:function(){this._unsubscribe(),null!=this.removalHandler&&this.removalHandler(this.type,this.sid,this.uniqueName)}},{key:"attach",value:function(e){var t=e.listenerUuid;this._attachedListeners.get(t)||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(t,e))}},{key:"detach",value:function(e){this._attachedListeners.delete(e),this._attachedListeners.size||this.close()}},{key:"broadcastEventToListeners",value:function(e,t){var n,r=_createForOfIteratorHelper(this._attachedListeners.values());try{for(r.s();!(n=r.n()).done;){n.value.emit(e,t)}}catch(i){r.e(i)}finally{r.f()}}}]),e}();t.SyncEntity=r,t.default=r},yWtm:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("r2q8"),i=n("qXWz");t.BackoffRetrier=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).options=e?Object.assign({},e):{},r}return _createClass(n,[{key:"inProgress",get:function(){return!!this.retrier}}]),_createClass(n,[{key:"start",value:function(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}},{key:"stop",value:function(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}},{key:"modifyBackoff",value:function(e){this.newBackoff=e}},{key:"attemptFailed",value:function(){if(!this.inProgress)throw new Error("No attempt is in progress");this.newBackoff&&(!this.usedBackoff||this.usedBackoff<this.newBackoff)?this.createRetrier():this.retrier.failed(new Error)}},{key:"cancel",value:function(){this.retrier&&this.retrier.cancel()}},{key:"cleanRetrier",value:function(){this.retrier&&(this.retrier.removeAllListeners(),this.retrier.cancel(),this.retrier=null)}},{key:"getRetryPolicy",value:function(){var e=Object.assign({},this.options);return this.newBackoff&&(e.min=this.newBackoff,e.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),e.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,e}},{key:"createRetrier",value:function(){var e=this;this.cleanRetrier();var t=this.getRetryPolicy();this.retrier=new i.Retrier(t),this.retrier.once("attempt",(function(){e.retrier.on("attempt",(function(){return e.emit("attempt")})),e.retrier.failed(new Error("Skipping first attempt"))})),this.retrier.on("failed",(function(t){return e.emit("failed",t)})),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start().catch((function(e){}))}}]),n}(r.EventEmitter)},yew7:function(e,t,n){var r=n("8fQz"),i=n("3555"),s=n("guEv"),a=n("ubhL")("IE_PROTO"),o=function(){},u=function(){var e,t=n("1bLK")("iframe"),r=s.length;for(t.style.display="none",n("wHU4").appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[s[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(o.prototype=r(e),n=new o,o.prototype=null,n[a]=e):n=u(),void 0===t?n:i(n,t)}},ypPR:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("lPsM"),i=n("EtEV");t.TwilsockConnector=function(e){_inherits(s,e);var t,n,i=_createSuper(s);function s(e,t,n){var a;return _classCallCheck(this,s),(a=i.call(this,n)).twilsock=t,a.context=e,e.id=r.v4(),a.twilsock.on("stateChanged",(function(e){"connected"!==e&&a.emit("transportReady",!1)})),a.twilsock.on("registered",(function(n){e&&n===e.id&&"connected"===t.state&&a.emit("transportReady",!0)})),a}return _createClass(s,[{key:"setNotificationId",value:function(){}},{key:"updateToken",value:function(e){}},{key:"updateContextRequest",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={product_id:this.context.productId,notification_protocol_version:4,endpoint_platform:this.context.platform,message_types:t},this.emit("transportReady",!1),e.next=4,this.twilsock.setNotificationsContext(this.context.id,n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateRegistration",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.has("messageType")){e.next=4;break}return e.next=3,this.updateContextRequest(Array.from(t.messageTypes));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"removeRegistration",value:function(){return this.twilsock.removeNotificationsContext(this.context.id)}}]),s}(i.Connector)},z7HR:function(e,t,n){var r=n("J0XI"),i=n("guEv").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},zCrM:function(e,t,n){"use strict";var r=n("UwCj").f,i=n("yew7"),s=n("qa3O"),a=n("dWRk"),o=n("s0lH"),u=n("9v8s"),c=n("S49y"),l=n("MIMp"),d=n("Jn7W"),f=n("ObEa"),h=n("aRFn").fastKey,p=n("S5Zg"),v=f?"_s":"size",y=function(e,t){var n,r=h(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var l=e((function(e,r){o(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[v]=0,null!=r&&u(r,n,e[c],e)}));return s(l.prototype,{clear:function(){for(var e=p(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var n=p(this,t),r=y(n,e);if(r){var i=r.n,s=r.p;delete n._i[r.i],r.r=!0,s&&(s.n=i),i&&(i.p=s),n._f==r&&(n._f=i),n._l==r&&(n._l=s),n[v]--}return!!r},forEach:function(e){p(this,t);for(var n,r=a(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!y(p(this,t),e)}}),f&&r(l.prototype,"size",{get:function(){return p(this,t)[v]}}),l},def:function(e,t,n){var r,i,s=y(e,t);return s?s.v=n:(e._l=s={i:i=h(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=s),r&&(r.n=s),e[v]++,"F"!==i&&(e._i[i]=s)),e},getEntry:y,setStrong:function(e,t,n){c(e,t,(function(e,n){this._t=p(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?l(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,l(1))}),n?"entries":"values",!n,!0),d(t)}}},zJWi:function(e,t,n){var r=n("MrWc"),i=n("ax0Y");n("2qJG")("getPrototypeOf",(function(){return function(e){return i(r(e))}}))},zZTv:function(e,t,n){n("9YHp")("observable")},zaPo:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=function(){function e(t,n,r){_classCallCheck(this,e);var i=r.MCS||r||{};this.region=i.region||r.region,this.baseUrl=(void 0===this.region?"https://mcs.us1.twilio.com":"https://mcs.".concat(this.region,".twilio.com"))+n,this.token=t,this.retryWhenThrottledOverride=i.retryWhenThrottledOverride,this.backoffConfigOverride=i.backoffConfigOverride}return _createClass(e,[{key:"updateToken",value:function(e){this.token=e}}],[{key:"backoffConfigDefault",get:function(){return{min:1e3,max:4e3,maxAttemptsCount:3}}},{key:"retryWhenThrottledDefault",get:function(){return!0}}]),e}()},zjfI:function(e,t,n){"use strict";var r=n("yew7"),i=n("jHgz"),s=n("KnMe"),a={};n("b95h")(a,n("eD9m")("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),s(e,t+" Iterator")}},zjhQ:function(e,t,n){"use strict";var r=n("IFjL"),i=n("Vzpu"),s=n("dWRk"),a=n("9v8s");e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,o,u=arguments[1];return i(this),(t=void 0!==u)&&i(u),null==e?new this:(n=[],t?(r=0,o=s(u,arguments[2],2),a(e,!1,(function(e){n.push(o(e,r++))}))):a(e,!1,n.push,n),new this(n))}})}}}]);